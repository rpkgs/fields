<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Useful plots for visualizing irregular spatial data. — quilt.plot • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Useful plots for visualizing irregular spatial data. — quilt.plot"><meta property="og:description" content="Given a vector of z values associated with 2-d locations this 
function produces an 
image-like plot where the locations are discretized to a grid  and the z 
values are coded as a color level from a color scale."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/fastTps.html">fastTps</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Useful plots for visualizing irregular spatial data.</h1>
    
    <div class="hidden name"><code>quilt.plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a vector of z values associated with 2-d locations this 
function produces an 
image-like plot where the locations are discretized to a grid  and the z 
values are coded as a color level from a color scale.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">quilt.plot</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span>, nx <span class="op">=</span> <span class="fl">64</span>, ny <span class="op">=</span> <span class="fl">64</span>,  grid <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>           add.legend<span class="op">=</span><span class="cn">TRUE</span>,add<span class="op">=</span><span class="cn">FALSE</span>, nlevel<span class="op">=</span><span class="fl">64</span>, </span>
<span>           col <span class="op">=</span> <span class="fu"><a href="tim.colors.html">tim.colors</a></span><span class="op">(</span><span class="va">nlevel</span><span class="op">)</span>,</span>
<span>           nrow<span class="op">=</span><span class="cn">NULL</span>, ncol<span class="op">=</span><span class="cn">NULL</span>,FUN <span class="op">=</span></span>
<span>                 <span class="cn">NULL</span>, plot<span class="op">=</span><span class="cn">TRUE</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                 boundary.grid <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span>                 </span>
<span><span class="fu">bubblePlot</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span>, col <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, </span>
<span>       zlim<span class="op">=</span><span class="cn">NULL</span>, horizontal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 legend.cex <span class="op">=</span> <span class="fl">1</span>, legend.lab <span class="op">=</span> <span class="cn">NULL</span>, legend.line <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 legend.shrink <span class="op">=</span> <span class="fl">0.9</span>, legend.width <span class="op">=</span> <span class="fl">1.2</span>, legend.mar <span class="op">=</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">horizontal</span>, <span class="fl">3.1</span>, <span class="fl">5.1</span><span class="op">)</span>, axis.args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 legend.args <span class="op">=</span> <span class="cn">NULL</span>, size <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 legendLayout <span class="op">=</span> <span class="cn">NULL</span>, highlight <span class="op">=</span> <span class="cn">TRUE</span>, highlight.color</span>
<span>                 <span class="op">=</span> <span class="st">"grey30"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A vector of the x coordinates of the locations -or- a
     a 2 column matrix of the x-y coordinates.</p></dd>

  <dt>y</dt>
<dd><p>A vector of the y coordinates -or- if the locations are passed 
in x the z vector</p></dd>

  <dt>z</dt>
<dd><p>Values of the variable to be plotted. For bubblePlot if a character or factor will be assigned colors based on the order of appearance.</p></dd>

  <dt>nlevel</dt>
<dd><p>Number of color levels.</p></dd>

  <dt>nx</dt>
<dd><p>Number of grid boxes in x if a grid is not specified.</p></dd>

  <dt>ny</dt>
<dd><p>Number of grid boxes in y.</p></dd>

  <dt>nrow</dt>
<dd><p>Depreciated, same as nx.</p></dd>

  <dt>ncol</dt>
<dd><p>Depreciated same as ny.</p></dd>

  <dt>grid</dt>
<dd><p>A grid in the form of a <code>grid list</code>.</p></dd>

  <dt>add.legend</dt>
<dd><p>If TRUE a legend color strip is added</p></dd>

  <dt>add</dt>
<dd><p>If FALSE add to existing plot.</p></dd>

  <dt>col</dt>
<dd><p>Color function or the color scale for the image, the   default is the tim.colors  function --
    a pleasing spectrum for quilt.plot and the  modern and versitle
     viridis for bubblePlot</p></dd>

  <dt>boundary.grid</dt>
<dd><p>If FALSE the passed grid is considered to be the  midpoints of the grid cells. 
  If TRUE then these are assumed to define corners and the number of boxes is one less in each dimension.</p></dd>

     
    <dt>plot</dt>
<dd><p>If FALSE just returns the image object instead of plotting it.</p></dd>

    <dt>FUN</dt>
<dd><p>The function to apply to values that are common to a grid
    box. The default is to find the mean. (see <code>as.image</code>).</p></dd>

    <dt>na.rm</dt>
<dd><p>If FALSE NAs are not removed from zand so a grid box
    even one of these values may be an NA. (See details below.)</p></dd>

  <dt>size</dt>
<dd><p>Size of bubble dots in cex units. Can be a vector to procduce different size points in the scatterplot.</p></dd>

  <dt>zlim</dt>
<dd><p>Numerical range to determine the colorscale. If omitted the range of z is used.</p></dd>

  <dt>...</dt>
<dd><p>for quilt.plot  arguments to be passed to the <code>image.plot</code>
  function. For bubblePlot arguments to be passed to the <code>plot</code>
  function if <code>add=FALSE</code>, the default and to the <code>points</code>
  function if <code>add=TRUE</code>.</p></dd>

  
<dt>horizontal</dt>
<dd><p>If false (default) legend will be a vertical strip on the right side. If
true the legend strip will be along the bottom.</p></dd>


<dt>highlight</dt>
<dd><p>If TRUE will add a circle around the "bubble" in the color
<code>highlight.color</code>.</p></dd>



<dt>highlight.color</dt>
<dd><p>Color of circle, default is a darker grey.</p></dd>


<dt>legend.cex</dt>
<dd><p>Character expansion to change size of the legend
label.</p></dd>


<dt>legend.lab</dt>
<dd><p>Label for the axis of the color legend. Default is no
label as this is usual evident from the plot title.</p></dd>


<dt>legend.line</dt>
<dd><p>Distance in units of character height 
(same as in <code>mtext</code>)
 of the legend label from the 
color bar. Make this larger if the label collides with the color axis labels.</p></dd>


<dt>legend.mar</dt>
<dd><p>Width in characters of legend margin that has the axis. Default is 5.1 
for a vertical legend and 3.1 for a horizontal legend.</p></dd>


<dt>legend.shrink</dt>
<dd><p>Amount to shrink the size of legend relative to the full height or width
of the plot.</p></dd>


<dt>legend.width</dt>
<dd><p>Width in characters of the legend strip. Default is 1.2, a little bigger
that the width of a character.</p></dd>


<dt>axis.args</dt>
<dd><p>A list giving additional arguments for the <code>axis</code> function used to 
create the legend axis. (See examples in <code><a href="image.plot.html">image.plot</a></code>.)</p></dd>


<dt>legend.args</dt>
<dd><p>The nuclear option: arguments for a complete specification of the 
legend label, e.g. if you need to the rotate text or other details.  This is in the form of a list and is just passed to the 
mtext function and you will need to give both the side and line arguments for positioning.  This usually will not be needed. 
(See examples in <code><a href="image.plot.html">image.plot</a></code> .)</p></dd>

<dt>legendLayout</dt>
<dd><p>The list returned by <code>setupLegend</code> that has the legend information about positioning.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p><strong>quilt.plot</strong> 
This function combines the discretization to an image by the function 
<code>as.image</code> and is then graphed by <code>image.plot</code>.
By default, locations that fall into the same grid box will have their
z values averaged. This also means that observations that are NA will
result in the grid box average also being NA and can produce unexpected
results because the NA patterns can dominate the figure. If you are
unsure of the effect  try <code>na.rm = TRUE</code> for a comparison.</p>
<p>A similar function exists in the lattice package and produces spiffy
looking plots. The advantage of this fields version is that it uses
the
standard R graphics functions and is written in R code. Also, the
aggregation to average values for z values in the same grid box allows
for different choices of grids. If two locations are very close,
separating them could result in very small boxes.</p>
<p>Legend placement is never completely automatic. Place the 
legend independently for more control, perhaps using <code>image.plot</code>
in tandem with <code>split.screen</code> or enlarging the plot margin 
See <code><a href="image.plot.html">help(image.plot)</a></code> for examples of this function and these 
strategies.</p>
<p><strong>bubblePlot</strong> Why was this function was written for fields?
Certainly ggplot has many options for this kind of figure. 
To quote Tim Hoar a gifted data scientist and software engineer at NCAR:
"because we could".   It is a crisp
implementation of this type of plot using lower level fields functions.
The user may choose  simply to use the source code as the basis for
a more
detailed function. However, this is also a quick plot to introduce in teaching.</p>
<p>This function is experimental in the sense it explores setting
out a plotting region in advance of the actual plotting using R base graphics.
See the functions  <code><a href="imagePlot.html">setupLegend</a></code> and  <code><a href="imagePlot.html">addLegend</a></code>
for more details. Other graphics approaches in R such as ggplot determine
the plotting regions and layout based on having the entire figure
specification at hand. Although this a comprehensive solution it also seems
overkill to just add a lone color bar to annotate a plot. Moreover, and the graphics lower level functions
to add the color bar legend are already available from the image.plot functio.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>D.Nychka</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>as.image, discretize.image, image.plot, lattice, persp, drape.plot,</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot 16 day of ozone data set</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">quilt.plot</span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span>, <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="US.html">US</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"grey"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="quilt.plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">bubblePlot</span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span>, <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="US.html">US</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"magenta"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="quilt.plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># colors based on a factor or character vector</span></span></span>
<span class="r-in"><span><span class="va">O3Levels</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">80</span>,<span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"bckgrd"</span>,<span class="st">"med"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span> <span class="va">O3Levels</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O3Levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    low bckgrd    med   high </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4     16     40     86 </span>
<span class="r-in"><span><span class="fu">bubblePlot</span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span>, <span class="va">O3Levels</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="US.html">US</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"magenta"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="quilt.plot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### adding a common legend strip "by hand"</span></span></span>
<span class="r-in"><span><span class="co">## to a panel of plots </span></span></span>
<span class="r-in"><span><span class="co">## and a custom color table</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">coltab</span><span class="op">&lt;-</span> <span class="fu"><a href="tim.colors.html">two.colors</a></span><span class="op">(</span> <span class="fl">256</span>, middle<span class="op">=</span><span class="st">"grey50"</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span> oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="co"># save some room for the legend</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 2 by 2 matrix </span>
<span class="r-in"><span><span class="va">zr</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">quilt.plot</span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span>, <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">15</span><span class="op">+</span><span class="va">k</span>,<span class="op">]</span>, add.legend<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> zlim<span class="op">=</span><span class="va">zr</span>, col<span class="op">=</span><span class="va">coltab</span>, nx<span class="op">=</span><span class="fl">40</span>, ny<span class="op">=</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="US.html">US</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span> oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="image.plot.html">image.plot</a></span><span class="op">(</span>zlim<span class="op">=</span><span class="va">zr</span>,legend.only<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="va">coltab</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="quilt.plot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># may have to adjust number of spaces in oma to make this work.</span></span></span>
<span class="r-in"><span><span class="co">#  adding some grid lines  and using the boundary.grid option</span></span></span>
<span class="r-in"><span><span class="co"># note that in this case grid boxes drawn to match lon/lats</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lon</span><span class="op">&lt;-</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">lat</span><span class="op">&lt;-</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">z</span><span class="op">&lt;-</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gridList</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span><span class="op">-</span><span class="fl">94</span> <span class="op">:</span><span class="op">-</span><span class="fl">81</span>, </span></span>
<span class="r-in"><span>                 y<span class="op">=</span> <span class="fl">36</span><span class="op">:</span><span class="fl">45</span> <span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">quilt.plot</span><span class="op">(</span> <span class="va">lon</span>, <span class="va">lat</span>, <span class="va">z</span>, grid<span class="op">=</span> <span class="va">gridList</span>, boundary.grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>             col<span class="op">=</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># add some gird lines</span></span></span>
<span class="r-in"><span><span class="fu"><a href="xline.html">xline</a></span><span class="op">(</span> <span class="va">gridList</span><span class="op">$</span><span class="va">x</span> , col<span class="op">=</span><span class="st">"grey"</span>, lwd<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="yline.html">yline</a></span><span class="op">(</span> <span class="va">gridList</span><span class="op">$</span><span class="va">y</span>, col<span class="op">=</span><span class="st">"grey"</span>, lwd<span class="op">=</span><span class="fl">1</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="quilt.plot-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

