<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Euclidean distance matrix or vector — rdist • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Euclidean distance matrix or vector — rdist"><meta property="og:description" content="Given two sets of locations rdist and fields.rdist.near computes the full 
Euclidean distance matrix among all pairings or a sparse version for points within a 
fixed threshhold distance.  rdist.vec computes a vector of pairwise distances 
between corresponding elements of the input locations and is used in empirical 
variogram calculations."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Euclidean distance matrix or vector</h1>
    
    <div class="hidden name"><code>rdist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given two sets of locations <code>rdist</code> and <code>fields.rdist.near</code> computes the full 
Euclidean distance matrix among all pairings or a sparse version for points within a 
fixed threshhold distance.  <code>rdist.vec</code> computes a vector of pairwise distances 
between corresponding elements of the input locations and is used in empirical 
variogram calculations.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rdist</span><span class="op">(</span><span class="va">x1</span>, x2 <span class="op">=</span> <span class="cn">NULL</span>, compact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fields.rdist.near</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>, <span class="va">delta</span>, max.points<span class="op">=</span> <span class="cn">NULL</span>, mean.neighbor <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rdist.vec</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x1</dt>
<dd><p>Matrix of first set of locations where each row gives the coordinates of a
particular
point.</p></dd>

<dt>x2</dt>
<dd><p>Matrix of second set of locations where each row gives the coordinates of
a particular point. If this is not passed or given as NULL x1 is used.</p></dd>

<dt>compact</dt>
<dd><p>Whether or not to return a distance matrix in compact form inheriting class ``dist'' (as returned by the <code>dist</code> function in base R).  Only values for one triangle of the symmetric distance matrix are returned. This saves time evaluating the returned matrix and the covariance.  Note that this option is ignored when <code>x2</code> is not NULL.</p></dd>

<dt>delta</dt>
<dd><p>Threshhold distance. All pairs of points that separated by more than 
delta in distance are ignored.</p></dd>


<dt>max.points</dt>
<dd><p>Size of the expected number of pairs less than or equal to 
delta. The default is set to the nrow(x1)*mean.neighbor.</p></dd>


<dt>mean.neighbor</dt>
<dd><p>Sets the temp space for max.points</p></dd>

 
</dl></div>
    <div id="returned-values">
    <h2>Returned values</h2>
    <p>Let D be the mXn distance matrix, 
with m= nrow(x1) and n=nrow( x2). The elements are 
the Euclidean distances between the all locations x1[i,] and x2[j,].
That is,</p>
<p>D.ij = sqrt( sum.k (( x1[i,k] - x2[j,k]) **2 ).</p>
<p><code>rdist</code>
The distance matrix D is returned.</p>
<p><code>fields.rdist.near</code>
The elements of D that are less than or equal to delta are returned in 
the form of a list.</p>
<p>List components:</p><dl><dt>ind</dt>
<dd><p>Row  and column indices of elements</p></dd>

<dt>ra</dt>
<dd><p>(Distances ( D.ij)</p></dd>

<dt>da</dt>
<dd><p>Dimensions of full distance matrix.</p></dd>


</dl><p>This is a simple sparse format that can be manipulated by several fields
functions. E.g. ind2spam will convert this list to the format used by
the spam sparse matrix package. ind2full will convert this to an
ordinary matrix with zeroes.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    

<p>More about fields.rdist.near:</p>
<p>The sparse version is designed to work with the sparse covariance
functions in fields and anticipates that the full matrix, D is too large
to store. The argument max.points is set as a default to nrow( x1)*100
and allocates the space to hold the sparse elements. In case that there
are more points that are within delta the function stops with an error
but lists the offending rows. Just rerun the function with a larger
choice for max.points</p>
<p>It possible that for certain x1 points there are no x2 points within a distance 
delta. This situation will cause an error if the list is converted to spam format.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Doug Nychka, John Paige</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="exp.cov.html">stationary.cov</a>, <a href="exp.cov.html">Exp.cov</a>, <a href="rdist.earth.html">rdist.earth</a>, <a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a>, ind2spam, ind2full</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">&lt;-</span> <span class="fu">rdist</span><span class="op">(</span> <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># out is a 20X20 matrix.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out2</span><span class="op">&lt;-</span> <span class="fu">rdist</span><span class="op">(</span> <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span>, <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#out2 is a 5X10 matrix</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="fl">20</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">20</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="fl">15</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">15</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out3</span><span class="op">&lt;-</span> <span class="fu">fields.rdist.near</span><span class="op">(</span> <span class="va">x1</span>,<span class="va">x2</span>, delta<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># out3 is a sparse structure in list format</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or to "save"  work space decrease size of temp array</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">out3</span><span class="op">&lt;-</span> <span class="fu">fields.rdist.near</span><span class="op">(</span> <span class="va">x1</span>,<span class="va">x2</span>, delta<span class="op">=</span><span class="fl">.5</span>,max.points<span class="op">=</span><span class="fl">20</span><span class="op">*</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># explicitly reforming as a full matrix </span></span></span>
<span class="r-in"><span><span class="va">temp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="cn">NA</span>, nrow<span class="op">=</span><span class="va">out3</span><span class="op">$</span><span class="va">da</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ncol<span class="op">=</span> <span class="va">out3</span><span class="op">$</span><span class="va">da</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">temp</span><span class="op">[</span> <span class="va">out3</span><span class="op">$</span><span class="va">ind</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">out3</span><span class="op">$</span><span class="va">ra</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#       or justuse </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">temp</span><span class="op">&lt;-</span> <span class="fu"><a href="spam2lz.html">spind2full</a></span><span class="op">(</span> <span class="va">out3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="va">temp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rdist-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this is  identical to </span></span></span>
<span class="r-in"><span> <span class="va">temp2</span><span class="op">&lt;-</span> <span class="fu">rdist</span><span class="op">(</span> <span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">temp2</span><span class="op">[</span> <span class="va">temp2</span><span class="op">&lt;=</span> <span class="fl">.5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#compute pairwise distance vector</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">10</span>, to<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rdist.vec</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 9 7 5 3 1 1 3 5 7 9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#calculate output matrix in compact form:</span></span></span>
<span class="r-in"><span><span class="va">distOut</span> <span class="op">=</span> <span class="fu">rdist</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, compact<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">distOut</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 2 3 4 5 6 7 8 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2 1              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  3 2 1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  4 3 2 1          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  5 4 3 2 1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  6 5 4 3 2 1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  7 6 5 4 3 2 1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  8 7 6 5 4 3 2 1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 9 8 7 6 5 4 3 2 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">distOut</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 1 2 3 4 5 6 7 1 2 3 4 5 6 1 2 3 4 5 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] 4 1 2 3 1 2 1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

