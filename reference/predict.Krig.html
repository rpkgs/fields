<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Evaluation of Krig spatial process estimate. — predict.Krig • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluation of Krig spatial process estimate. — predict.Krig"><meta property="og:description" content="Provides predictions from the Krig spatial process estimate at arbitrary
points, new data (Y) or other values of the smoothing parameter (lambda)
including a GCV estimate."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluation of Krig spatial process estimate.</h1>
    
    <div class="hidden name"><code>predict.Krig.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides predictions from the Krig spatial process estimate at arbitrary
points, new data (Y) or other values of the smoothing parameter (lambda)
including a GCV estimate.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for Krig</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span><span class="va">object</span>, x <span class="op">=</span> <span class="cn">NULL</span>, Z <span class="op">=</span> <span class="cn">NULL</span>, drop.Z <span class="op">=</span> <span class="cn">FALSE</span>, just.fixed</span>
<span>                 <span class="op">=</span> <span class="cn">FALSE</span>, lambda <span class="op">=</span> <span class="cn">NA</span>, df <span class="op">=</span> <span class="cn">NA</span>, model <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                 eval.correlation.model <span class="op">=</span> <span class="cn">TRUE</span>, y <span class="op">=</span> <span class="cn">NULL</span>, yM <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">predictDerivative.Krig</span><span class="op">(</span><span class="va">object</span>, x <span class="op">=</span> <span class="cn">NULL</span>,  verbose <span class="op">=</span> <span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Tps</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fastTps</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, xnew <span class="op">=</span> <span class="cn">NULL</span>, grid.list <span class="op">=</span> <span class="cn">NULL</span>, ynew <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 derivative <span class="op">=</span> <span class="fl">0</span>, Z <span class="op">=</span> <span class="cn">NULL</span>, drop.Z <span class="op">=</span> <span class="cn">FALSE</span>, just.fixed <span class="op">=</span></span>
<span>                 <span class="cn">FALSE</span>, xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>derivative</dt>
<dd><p>The degree of the derivative to be evauated. Default is
0 (evaluate the function itself), 1 is supported by some covariance functions,
Higher derivatives are not supported in this version and for mKrig.</p></dd>


<dt>df</dt>
<dd><p>Effective degrees of freedom for the predicted surface. This can be used
in place of lambda ( see the function Krig.df.to.lambda)</p></dd>


<dt>eval.correlation.model</dt>
<dd><p>If true ( the default) will multiply the predicted function by marginal
sd's
and add the mean function. This usually what one wants. If false will
return predicted surface in the standardized scale. The main use of this
option is a call from Krig to find MLE's of sigma and tau2</p></dd>


<dt>grid.list</dt>
<dd><p>A <code>grid.list</code> specfiying a grid of locations to
evaluate the fitted surface.</p></dd>



<dt>just.fixed</dt>
<dd><p>Only fixed part of model is evaluated</p></dd>



<dt>lambda</dt>
<dd><p>Smoothing parameter. If omitted,  the value in the <code>lambda</code> of the object  will be
used.  (See also df and gcv arguments)</p></dd>
 <dt>model</dt>
<dd><p>Generic
argument that may be used to pass a different lambda.</p></dd>

<dt>object</dt>
<dd><p>Fit object from the Krig, Tps, mKrig, or fastTps
functions.</p></dd>


 <dt>verbose</dt>
<dd><p>Print out all kinds of intermediate stuff for
debugging</p></dd>


<dt>xy</dt>
<dd><p>The column positions that locate the x and y variables for
evaluating on a grid.  This is mainly useful if the surface has more
than 2 dimensions.</p></dd>


<dt>y</dt>
<dd><p>Evaluate the estimate using the new data vector y (in the
same order as the old data). This is equivalent to recomputing the
Krig object with this new data but is more efficient because many
pieces can be reused. Note that the x values are assumed to be the
same.</p></dd>
 <dt>x</dt>
<dd><p>Matrix of x values on which to evaluate the kriging
surface.  If omitted, the data x values will be used.</p></dd>


<dt>xnew</dt>
<dd><p>Same as x above.</p></dd>


<dt>ynew</dt>
<dd><p>Same as y above.</p></dd>
  

<dt>yM</dt>
<dd><p>If not NULL evaluate the
estimate using this vector as the replicate mean data. That is, assume
the full data has been collapsed into replicate means in the same
order as xM. The replicate weights are assumed to be the same as the
original data. (weightsM)</p></dd>



<dt>Z</dt>
<dd><p>Vector/Matrix of additional covariates to be included in
fixed part of spatial model</p></dd>
 <dt>drop.Z</dt>
<dd><p>If TRUE only spatial fixed
part of model is evaluated.  i.e. Z covariates are not used.</p></dd>


<dt>...</dt>
<dd><p>Other arguments passed to covariance function. In the case of
<code>fastTps</code> these are the same arguments as <code>predict.mKrig</code>.
This argument is usually not needed.</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Vector of predicted responses or a matrix of the partial derivatives.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The main goal in this function is to reuse the Krig object to rapidly 
evaluate different estimates. Thus there is flexibility in changing the 
value of lambda and also the independent data without having to 
recompute the matrices associated with the Krig object. The reason this 
is possible is that most on the calculations depend on the observed 
locations not on lambda or the observed data. Note the version for 
evaluating partial derivatives does not provide the same flexibility as 
<code>predict.Krig</code> and makes some assumptions about the null model 
(as a low order polynomial) and can not handle the correlation model form.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Krig, predictSurface gcv.Krig</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="fu"><a href="Krig.html">Krig</a></span><span class="op">(</span><span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span>,<span class="va">ChicagoO3</span><span class="op">$</span><span class="va">y</span>, aRange<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">-&gt;</span><span class="va">fit</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span> <span class="va">fit</span><span class="op">)</span> <span class="co"># gives predicted values at data points should agree with fitted.values</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 38.19526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 38.68851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 38.04500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 38.73050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 38.90710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 39.89087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 38.38276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 39.45331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 39.73383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 39.65974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 40.90296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 40.16104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 41.00987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 40.66807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 41.22062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 40.50951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 39.72912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 39.32462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 41.29463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 41.10218</span>
<span class="r-in"><span>                <span class="co">#  in fit object </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict at the coordinate (-5,10)</span></span></span>
<span class="r-in"><span>  <span class="va">x0</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span> <span class="co"># has to be a  1X2 matrix</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span> <span class="va">fit</span>,x<span class="op">=</span> <span class="va">x0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 39.30373</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># redoing predictions at data locations:</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span> <span class="va">fit</span>, x<span class="op">=</span><span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 38.19526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 38.68851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 38.04500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 38.73050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 38.90710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 39.89087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 38.38276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 39.45331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 39.73383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 39.65974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 40.90296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 40.16104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 41.00987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 40.66807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 41.22062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 40.50951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 39.72912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 39.32462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 41.29463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 41.10218</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># only the fixed part of the model</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span> <span class="va">fit</span>, just.fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 40.83480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 40.96135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 40.80576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 40.75224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 40.96245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 40.77402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 40.88791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 40.99245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 41.01029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 40.85702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 40.99142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 41.07368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 41.19898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 41.13733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 41.09190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 40.72847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 40.74733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 40.76694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 40.77036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 40.75996</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># evaluating estimate at a grid of points </span></span></span>
<span class="r-in"><span>  <span class="va">grid</span><span class="op">&lt;-</span> <span class="fu"><a href="grid.list.html">make.surface.grid</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">40</span>,<span class="fl">40</span>,,<span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">40</span>,<span class="fl">40</span>,,<span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">look</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">grid</span><span class="op">)</span> <span class="co"># evaluate on a grid of points</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># some useful graphing functions for these gridded predicted values</span></span></span>
<span class="r-in"><span>  <span class="va">out.p</span><span class="op">&lt;-</span> <span class="fu"><a href="as.surface.html">as.surface</a></span><span class="op">(</span> <span class="va">grid</span>, <span class="va">look</span><span class="op">)</span> <span class="co"># reformat into $x $y $z image-type object</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span> <span class="va">out.p</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="predict.Krig-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see also the functions predictSurface and surface </span></span></span>
<span class="r-in"><span><span class="co"># for functions that combine these steps </span></span></span>
<span class="r-in"><span>   </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># refit with 10 degrees of freedom in surface</span></span></span>
<span class="r-in"><span>  <span class="va">look</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>,<span class="va">grid</span>, df<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># refit with random data </span></span></span>
<span class="r-in"><span>  <span class="va">look</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="va">grid</span>, y<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># finding partial derivatives of the estimate</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># find the partial derivatives at observation locations</span></span></span>
<span class="r-in"><span><span class="co"># returned object is a two column matrix. </span></span></span>
<span class="r-in"><span><span class="co"># this does not make sense for the exponential covariance</span></span></span>
<span class="r-in"><span><span class="co"># but can illustrate this with a thin plate spline with</span></span></span>
<span class="r-in"><span><span class="co"># a high enough order ( i.e. need m=3 or greater)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ozone2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the 16th day of this ozone spatial dataset</span></span></span>
<span class="r-in"><span>  <span class="va">fit0</span><span class="op">&lt;-</span> <span class="fu"><a href="Tps.html">Tps</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span>, <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span>, m<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">look1</span><span class="op">&lt;-</span> <span class="fu">predictDerivative.Krig</span><span class="op">(</span> <span class="va">fit0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># for extra credit compare this to</span></span></span>
<span class="r-in"><span>  <span class="va">look2</span><span class="op">&lt;-</span> <span class="fu">predictDerivative.Krig</span><span class="op">(</span> <span class="va">fit0</span>, x<span class="op">=</span><span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="co"># (why are there more values in look2) </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

