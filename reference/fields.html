<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>fields - tools for spatial data — fields • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="fields - tools for spatial data — fields"><meta property="og:description" content='fields is a collection of functions for curve and function
 fitting with an emphasis on spatial data and spatial statistics. It was developed over 20+ years to provide easy to use but sophisticated tools for analyzing
 spatial data, particularly that encountered in the environmental sciences. For the impatient users, jump to the examples below to see how easy this is use. 
 Please send bugs and questions to Doug Nychka, nychka@mines.edu. Positive
 comments are also welcome!
The
 major methods implemented include cubic and thin plate splines, 
 universal
 Kriging and Kriging for large data sets. A more modern framework  for Kriging is 
 spatial process estimation with covariance parameters determined by maximum likelihood and the uncertainty derived from assumptions of a Gaussian process. 
 Throughout we try to include reasonable defaults in functions that reflect
 our experience with analyzing spatial data. For example, the Matern covariance function is the default choice for the main spatial method. 
A key feature of this package is any
 covariance function implemented in R code can be used for spatial prediction through the spatial functions.  
 Another important feature is that fields will take advantage of compactly
 supported covariance functions in a seamless way through 
the spam package. 
See library( help=fields) for a listing of all the
fields contents. We also  recommend the thoughtful vignette created by Ashton Weins, Mitchell Krock, and Emma Lilly (fieldsVignette.pdf) in the 
fields github repository.
fields strives to have readable and tutorial code. Take a look at the 
source code for  mKrig to see how things work 
"under the hood". E.g. how a linear algebra computation is
overloaded to handle sparse matrices and how an output  object is built up sequentially throughout a computation.
The fields source code is liberally commented. Unfortunately on loading
this package,  R will
strip comments from the source for efficiency.   You can go to 
 CRAN fields page to download
 the latest  "tarball" ( aka Package Source) and unzip to get code with comments.
 We also keep the most recent version of this package  at the 
fields github repository.
and for commented source go to the 
the subdirectory fields/src. This may be a more recent version than what is posted to CRAN.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>fields - tools for spatial data</h1>
    
    <div class="hidden name"><code>fields.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>fields</code> is a collection of functions for curve and function
 fitting with an emphasis on spatial data and spatial statistics. It was developed over 20+ years to provide easy to use but sophisticated tools for analyzing
 spatial data, particularly that encountered in the environmental sciences. For the impatient users, jump to the examples below to see how easy this is use. 
 Please send bugs and questions to Doug Nychka, nychka@mines.edu. Positive
 comments are also welcome!</p>
<p>The
 major methods implemented include cubic and thin plate splines, 
 universal
 Kriging and Kriging for large data sets. A more modern framework  for Kriging is 
 spatial process estimation with covariance parameters determined by maximum likelihood and the uncertainty derived from assumptions of a Gaussian process. 
 Throughout we try to include reasonable defaults in functions that reflect
 our experience with analyzing spatial data. For example, the Matern covariance function is the default choice for the main spatial method.</p> 
<p>A key feature of this package is any
 covariance function implemented in R code can be used for spatial prediction through the spatial functions.  
 Another important feature is that fields will take advantage of compactly
 supported covariance functions in a seamless way through 
the spam package. 
See <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library( help=fields)</a></code> for a listing of all the
fields contents. We also  recommend the thoughtful vignette created by Ashton Weins, Mitchell Krock, and Emma Lilly (<code>fieldsVignette.pdf</code>) in the 
<a href="https://github.com/dnychka/fieldsRPackage" class="external-link">fields github repository</a>.</p>
<p><code>fields</code> strives to have readable and tutorial code. Take a look at the 
source code for  <code>mKrig</code> to see how things work 
"under the hood". E.g. how a linear algebra computation is
overloaded to handle sparse matrices and how an output  object is built up sequentially throughout a computation.</p>
<p>The <code>fields</code> source code is liberally commented. Unfortunately on loading
this package,  R will
strip comments from the source for efficiency.   You can go to 
 <a href="https://cran.r-project.org/package=fields" class="external-link">CRAN fields page</a> to download
 the latest  "tarball" ( aka Package Source) and unzip to get code with comments.
 We also keep the most recent version of this package  at the 
<a href="https://github.com/dnychka/fieldsRPackage" class="external-link">fields github repository</a>.
and for commented source go to the 
the subdirectory <code>fields/src</code>. This may be a more recent version than what is posted to CRAN.</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    

<p><strong>Major methods</strong></p><ul><li><p><code><a href="spatialProcess.html">spatialProcess</a></code> An easy to use method that fits a spatial process model
( e.g. Kriging) but also estimates the key spatial parameters:  nugget variance, sill variance and range by maximum likelihood. Default covariance model is a Matern covariance function. This function and related functions called by this are the core methods in fields and have much flexibility.</p>
<p><code><a href="spatialProcess.html">spatialProcess</a></code> allows one to supply a covariance
function that is
written in native R code.  See (<code><a href="exp.cov.html">stationary.cov</a></code>) that
includes
several families of covariances  including the
Matern and several distance metrics including great circle distance
. 
<code><a href="sim.Krig.html">sim.spatialProcess</a></code> and <code><a href="sim.Krig.html">simLocal.spatialProcess</a></code> provide  "one liners"" for conditional simulation of the fitted surface.</p></li>
<li><p><code><a href="Tps.html">Tps</a></code> Thin Plate spline
regression including GCV and REML estimates for the smoothing parameter. For moderate size data sets as a first look we use <code>Tps</code> all the time. See also <code><a href="Tps.html">fastTps</a></code> for an 
approximate method to handle very large numbers of spatial locations</p></li>
<li><p><code><a href="sreg.html">sreg</a></code> , <code><a href="splint.html">splint</a></code>   Fast 1-D cubic smoothing 
splines and interpolating  splines, a workhorse  algorithm for more EDA and more complicated methods.</p></li>
<li><p><code><a href="mKrig.html">mKrig</a></code> (micro Krig) 
    Efficient Universal Kriging and Gaussian process function,
    that can take advantage of sparse covariance</p>    
<p>functions and is the core algorithm called by optimization
functions and for spatial predictio.</p></li>
<li><p><code><a href="QTps.html">QTps</a></code> A easy to use extension of thin plate splines for quantile and robust surface fitting.</p></li>
<li><p><code><a href="mKrigMLE.html">mKrigMLEGrid</a></code> and <code><a href="mKrigMLE.html">mKrigMLEJoint</a></code> for maximum likelihood estimates of covariance parameters. These functions also 
handle replicate fields, assumed to be independent realizations, at the same locations and can also take any covariate function function written in R following the <code>fields</code> format</p></li>
</ul><p><!-- % end itemize --></p>

<p><strong>Other noteworthy functions</strong></p><ul><li><p><code><a href="vgram.html">vgram</a></code> and <code><a href="vgram.matrix.html">vgram.matrix</a></code> find variograms for spatial data (and
with temporal replications.</p></li>
<li><p><code><a href="cover.design.html">cover.design</a></code> Generates space-filling designs where the distance 
function is expresed in R code.</p></li>
<li><p>Many
convenient functions for working with image data and rationally (well,
maybe reasonably) creating and  placing a color scale on  plots: 
<code><a href="as.image.html">as.image</a></code>, <code><a href="imagePlot.html">imagePlot</a></code>, <code>bubblePlot</code>, <code>
<a href="drape.plot.html">drape.plot</a></code>, <code><a href="quilt.plot.html">quilt.plot</a></code>
<code><a href="add.image.html">add.image</a></code>, <code><a href="image2lz.html">crop.image</a></code>, <code><a href="image2lz.html">half.image</a></code>,
<code><a href="image2lz.html">average.image</a></code>, 
<code><a href="tim.colors.html">designer.colors</a></code>, <code><a href="tim.colors.html">color.scale</a></code>,
<code><a href="image2lz.html">in.poly</a></code>  
See also  <code><a href="grid.list.html">grid.list</a></code> for how fields works with grids and
<code><a href="US.html">US</a></code>
and <code><a href="world.html">world</a></code> for adding a map quickly.</p></li>
</ul><p><strong> Generic functions that support the methods</strong></p>
<p><code>plot</code> - diagnostic plots of fit <br><code>summary</code>- statistical summary of fit <br><code>print</code>- shorter version of summary <br><code><a href="fields-internal.html">surface</a></code>- graphical display of fitted surface <br><code>predict</code>- evaluation fit at arbitrary points <br><code><a href="predictSE.Krig.html">predictSE</a></code>- prediction standard errors at arbitrary points. <br><code><a href="sim.rf.html">sim.rf</a></code>- Simulate a random fields on a 2-d grid.</p>
    </div>
    <div id="getting-started">
    <h2>Getting Started</h2>
    

<p>Try some of the examples from help files for 
<code><a href="spatialProcess.html">spatialProcess</a></code> or <code><a href="Tps.html">Tps</a></code>.</p>
    </div>
    <div id="some-fields-datasets">
    <h2><strong>Some fields datasets</strong></h2>
    
<ul><li><p><code><a href="CO2.html">CO2</a></code> Global satelite CO2 concentrations (simulated field)</p></li>
<li><p><code><a href="CO.html">COmonthlyMet</a></code> Monthly mean temperatures and precip for Colorado</p></li>
<li><p><code><a href="glacier.html">glacier</a></code> An elevation dataset of a glacier also used by the applied math community to test interpolation methods.</p></li>
<li><p><code><a href="lennon.html">lennon</a></code> Image of John Lennon</p></li>
<li><p><code><a href="NorthAmericanRainfall.html">NorthAmericanRainfall</a></code> 50+ year average and trend for summer rainfall at 
1700+ stations.</p></li>
<li><p><code><a href="ozone2.html">ozone2</a></code>  Daily max 8 hour ozone concentrations for the US midwest 
for summer 1987.</p></li>
<li><p><code><a href="RMprecip.html">PRISMelevation</a></code> Digital elevations for the 
   continental US at approximately 4km resolution</p></li>
<li><p><code><a href="rat.diet.html">rat.diet</a></code> Small paired study on rat food
intake over time.</p></li>
<li><p><code><a href="RCMexample.html">RCMexample</a></code> Regional climate model output</p></li>
<li><p><code><a href="RMprecip.html">RMelevation</a></code> Digital elevations for the Rocky
Mountain Empire</p></li>
<li><p><code><a href="WorldBank.html">WorldBankCO2</a></code> Demographic and carbon emission data 
 for 75 countries and for 1999.</p></li>
</ul></div>
    <div id="disclaimer-">
    <h2><strong>DISCLAIMER:</strong></h2>
    <p>The
authors can not guarantee the correctness of any function or program in
this package.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># some air quality data, daily surface ozone measurements for </span></span></span>
<span class="r-in"><span><span class="co"># the Midwest:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ozone2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span><span class="op">&lt;-</span><span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span> <span class="co"># June 18, 1987 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># quick plot of spatial data with map</span></span></span>
<span class="r-in"><span><span class="fu"><a href="quilt.plot.html">bubblePlot</a></span><span class="op">(</span> <span class="va">s</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="US.html">US</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># add US map</span></span></span>
<span class="r-plt img"><img src="fields-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fitting a thin plate spline surface (always a good place to </span></span></span>
<span class="r-in"><span><span class="co"># start). Here the  default smoothing (aka lambda) found by cross-validation</span></span></span>
<span class="r-in"><span>  <span class="va">fit0</span><span class="op">&lt;-</span> <span class="fu"><a href="Tps.html">Tps</a></span><span class="op">(</span><span class="va">s</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># fits a GCV thin plate smoothing spline surface to ozone measurements.</span></span></span>
<span class="r-in"><span><span class="co"># Hey, it does not get any easier than this!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span> <span class="co">#diagnostic summary of the fit </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CALL:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tps(x = s, Y = y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of Observations:                147      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of unique points:               147      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of parameters in the null space 3        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters for fixed spatial drift     3        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Effective degrees of freedom:          74.6     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residual degrees of freedom:           72.4     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MLE tau                                8.307    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  GCV tau                                9.276    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MLE sigma                              958000   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Scale passed for covariance (sigma)    &lt;NA&gt;     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Scale passed for nugget (tau^2)        &lt;NA&gt;     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Smoothing parameter lambda             7.204e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Summary:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       min     1st Q    median     3rd Q       max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -30.38000  -3.07900   0.04153   3.35100  20.65000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariance Model: Rad.cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Names of non-default covariance arguments: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DETAILS ON SMOOTHING PARAMETER:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method used:   GCV    Cost:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lambda       trA       GCV   GCV.one GCV.model    tauHat </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.204e-05 7.461e+01 1.747e+02 1.747e+02        NA 9.276e+00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of all estimates found for lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               lambda   trA   GCV tauHat -lnLike Prof converge</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV        7.204e-05 74.61 174.7  9.276        609.3        6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.model         NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.one    7.204e-05 74.61 174.7  9.276           NA        6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE              NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pure error        NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML       5.653e-04 41.20 188.3 11.643        600.9        5</span>
<span class="r-in"><span>  <span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 2 by 2 matrix </span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span> <span class="co"># four diagnostic plots of fit and residuals.</span></span></span>
<span class="r-plt img"><img src="fields-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># quick plot of predicted surface</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 1 by 1 matrix </span>
<span class="r-in"><span>  <span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span> <span class="co"># contour/image plot of the fitted surface</span></span></span>
<span class="r-in"><span><span class="co"># see also predictSurface for more control over the evaluation grid</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="US.html">US</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"magenta"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># US map overlaid</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Daily max 8 hour ozone in PPB,  June 18th, 1987"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fields-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####</span></span></span>
<span class="r-in"><span>  <span class="va">fit2</span><span class="op">&lt;-</span> <span class="fu"><a href="spatialProcess.html">spatialProcess</a></span><span class="op">(</span> <span class="va">s</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># a "Kriging" model. The covariance defaults to a Matern </span></span></span>
<span class="r-in"><span><span class="co"># with smoothness 1.0.</span></span></span>
<span class="r-in"><span><span class="co"># the nugget, sill and range parameters are found by maximum likelihood</span></span></span>
<span class="r-in"><span><span class="co"># summary, plot, and surface also work for \code{fit2} !</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span> <span class="co"># contour/image plot of the fitted surface</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="US.html">US</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"magenta"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># US map overlaid</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Daily max 8 hour ozone in PPB,  June 18th, 1987"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fields-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># And 20 approximate conditional draws of the spatial field on a grid</span></span></span>
<span class="r-in"><span><span class="co"># with uncertainty in the 120PPB contour </span></span></span>
<span class="r-in"><span>   <span class="va">look</span><span class="op">&lt;-</span> <span class="fu"><a href="sim.Krig.html">simLocal.spatialProcess</a></span><span class="op">(</span><span class="va">fit2</span>, M<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span> <span class="va">look</span><span class="op">$</span><span class="va">x</span>, <span class="va">look</span><span class="op">$</span><span class="va">y</span>, <span class="va">look</span><span class="op">$</span><span class="va">z</span><span class="op">[</span>,,<span class="va">k</span><span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span>, level<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  col<span class="op">=</span><span class="st">"white"</span>,  drawlabels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span>  </span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

