<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Computes Space-Filling "Coverage" designs using Swapping Algorithm — cover.design • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Computes Space-Filling " coverage designs using swapping algorithm cover.design><meta property="og:description" content="Finds the set of points on a discrete grid (Candidate Set) which
minimize a geometric space-filling criterion. The strength of this method
is that the candidate set can satisfy whatever constraints are important
for the problem."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Computes Space-Filling "Coverage" designs using Swapping Algorithm</h1>
    
    <div class="hidden name"><code>cover.design.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Finds the set of points on a discrete grid (Candidate Set) which
minimize a geometric space-filling criterion. The strength of this method
is that the candidate set can satisfy whatever constraints are important
for the problem.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cover.design</span><span class="op">(</span><span class="va">R</span>, <span class="va">nd</span>, nruns <span class="op">=</span> <span class="fl">1</span>, nn <span class="op">=</span> <span class="cn">TRUE</span>, num.nn <span class="op">=</span> <span class="fl">100</span>, fixed <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    scale.type <span class="op">=</span> <span class="st">"unscaled"</span>, <span class="va">R.center</span>, <span class="va">R.scale</span>, P <span class="op">=</span> <span class="op">-</span><span class="fl">20</span>, Q <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    start <span class="op">=</span> <span class="cn">NULL</span>, DIST <span class="op">=</span> <span class="cn">NULL</span>, return.grid <span class="op">=</span> <span class="cn">TRUE</span>, return.transform <span class="op">=</span> </span>
<span><span class="cn">TRUE</span>, max.loop<span class="op">=</span><span class="fl">20</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>R</dt>
<dd><p>A matrix of candidate points to be considered in the design.
Each row is a separate point.</p></dd>

<dt>nd</dt>
<dd><p>Number of points to add to the design. If points exist and are to 
remain in the design (see "fixed" option), nd is the number of points 
to add. If no points are fixed, nd is the design size.</p></dd>

<dt>nruns</dt>
<dd><p>The number of random starts to be optimized. Uses random starts unless 
"start" is specified. If nruns is great than 1, the final results are  
the minimum.</p></dd>

<dt>nn</dt>
<dd><p>Logical value specifying whether or not to consider only nearest 
neighbors in the swapping algorithm. When nn=FALSE, then the swapping 
algorithm will consider all points in the candidate space. When nn=TRUE, 
then the swapping algorithm will consider only the num.nn closest 
points for possible swapping. The default is to use nearest neighbors 
only (nn=TRUE).</p></dd>

<dt>num.nn</dt>
<dd><p>Number of nearest-neighbors to search over. The default number is 100. 
If nn=F then this argument will be ignore.</p></dd>

<dt>fixed</dt>
<dd><p>A matrix or vector specifying points to be forced into the 
experimental design. If fixed is a matrix, it gives coordinates of the 
fixed points in the design. In this case fixed must be a subset of 
R. If fixed is a vector, then fixed gives the row numbers from the 
candidate matrix R that identify the fixed points. The number of 
points to be generated, nd, is in addition to the number of points
specified by fixed.</p></dd>

<dt>scale.type</dt>
<dd><p>A character string that tells how to scale the candidate matrix, R, 
before calculating distances. The default is "unscaled", no
transformation is done.
Another option is "range" in which case
variables are scaled to a [0,1] range before applying any distance
functions. Use "unscaled"  when all of the columns of R 
are commensurate; for example, when R gives x and y in spatial 
coordinates. When the columns of R are not in the same units, then it is
generally thought that an appropriate choice of scaling will provide a 
better design. This would be the case, for example, for a typical 
process optimization. Other choices for scale.type are 
"unit.sd", which scales 
all columns of R to have 0 mean and unit standard deviation, and 
"user", which allows a user specified scaling (see R.center and R.scale
arguments).</p></dd>

<dt>R.center</dt>
<dd><p>A vector giving the centering values if
scale.type=<code>user</code>.</p></dd>

<dt>R.scale</dt>
<dd><p>A vector giving the scale values if scale.type=<code>user</code>.</p></dd>

<dt>P</dt>
<dd><p>The "p" exponent of the coverage criterion (see below). It
affects how the distance from a point x to a set of design points D is 
calculated.  P=1 gives average distance. P=-1 gives harmonic mean distance. 
P=-Inf would give minimum distance (not available as a value). As P gets 
large and negative, points will tend to be more spread out.</p></dd>

<dt>Q</dt>
<dd><p>The "q" exponent of the coverage criterion (see below).It
affects how distances from all points not in the design to points in the 
design are averaged. When Q=1, simple averaging of the distances is employed. 
Q=Inf (not available as a value) in combination with P=-Inf would give a 
classical minimax design.</p></dd>

<dt>start</dt>
<dd><p>A matrix or vector giving the initial design from which to start 
optimization. If start is a matrix, it gives the coordinates of the 
design points. In this case start must be a subset of the candidate set , R matrix.
If start is a
vector, then start gives the row numbers of the initial design based on the rows of the
candidate matrix rows. The
default is to use a random starting design.</p></dd>

<dt>DIST</dt>
<dd><p>This argument is only for cover.design.S. 
A distance metric in the form of an S function. Default is Euclidean
distance (FIELDS rdist function)
See details
and example below for the correct form.</p></dd>

<dt>return.grid</dt>
<dd><p>Logical value that tells whether or not to return the candidate matrix 
as an attribute of the computed design. The default is return.grid=T. 
If false this just reduces the returned object size. 
The candidate matrix is used by plot.spatial.design if it is available.</p></dd>

<dt>return.transform</dt>
<dd><p>Logical value that tells whether or not to return the transformation  
attributes 
of candidate set. The default is return.transform=T.</p></dd>

<dt>max.loop</dt>
<dd><p>Maximum number of outer loops in algorithm. This is the maximum number of 
passes through the design testing for swaps.</p></dd>

<dt>verbose</dt>
<dd><p>If TRUE prints out debugging information.</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a design object of class <code>spatialDesign</code>.
Subscripting this object has the same effect as subscripting the first
component (the design).  The returned list has the following
components:</p>
<dl><dt>design</dt>
<dd><p>The best design in the form of a matrix.</p></dd>

<dt>best.id</dt>
<dd><p>Row numbers of the final design from the original candidate matrix, R.</p></dd>

<dt>fixed</dt>
<dd><p>Row numbers of the fixed points from the original candidate matrix, R.</p></dd>

<dt>opt.crit</dt>
<dd><p>Value of the optimality criterion for the final design.</p></dd>

<dt>start.design</dt>
<dd><p>Row numbers of the starting design from the original candidate matrix, R.</p></dd>

<dt>start.crit</dt>
<dd><p>Value of the optimality criterion for the starting design.</p></dd>

<dt>history</dt>
<dd><p>The swapping history and corresponding values of the optimality 
criterion for the best design.</p></dd>

<dt>other.designs</dt>
<dd><p>The designs other than the best design generated when nruns is
greater than 1.</p></dd>

<dt>other.crit</dt>
<dd><p>The optimality criteria for the other designs when nrun is greate
than 1.</p></dd>

<dt>DIST</dt>
<dd><p>The distance function used in calculating the design criterion.</p></dd>

<dt>nn</dt>
<dd><p>Logical value for nearest-neighbor search or not.</p></dd>

<dt>num.nn</dt>
<dd><p>The number of nearest neighbor set.</p></dd>

<dt>grid</dt>
<dd><p>The matrix R is returned if the argument return.grid=T.</p></dd>

<dt>transform</dt>
<dd><p>The type of transformation used in scaling the data and the values 
of the centering and scaling constants if the argument return.transform=T.</p></dd>

<dt>call</dt>
<dd><p>The calling sequence.</p></dd>

<dt>P</dt>
<dd><p>The parameter value for calculating criterion.</p></dd>

<dt>Q</dt>
<dd><p>The parameter value for calculating criterion.</p></dd>

<dt>nhist</dt>
<dd><p>The number of swaps performed.</p></dd>

<dt>nloop</dt>
<dd><p>The number of outer loops required to reach convergence if nloop is less 
the max.loop.</p></dd>

<dt>minimax.crit</dt>
<dd><p>The minimax design criterion using DIST.</p></dd>

<dt>max.loop</dt>
<dd><p>The maximum number of outer loops.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>OTHER DISTANCE FUNCTIONS:
You can supply an R/S-function to be used as the
distance metric. The expected calling sequence for this distance function
is
function( X1,X2){....} where X1 and X2 are matrices with coordinates as
the rows. The returned value of this function should be the pairwise
distance  matrix. If nrow( X1)=m and nrow( X2)=n then the function should
return an m by n matrix of all distances between these two sets of points.
See the example for Manhattan distance below.</p>
<p>The candidate set and DIST function can be flexible and the last
example
below using sample correlation matrices is an example.</p>
<p>COVERAGE CRITERION:
For nd design points  in the set D and nc candidate points ci in the
set C, 
the coverage criteria is defined as:</p>
<p>M(D,C) =  [sum(ci in C) [sum(di in D) (dist(di,ci)**P]**(Q/P)]**(1/Q)</p>
        
<p>Where P, less than  0, and Q, greater than 0, are parameters.
The algorithm used in
"cover.design" to find the set of nd points in C that minimize this 
criterion is an iterative swapping algorithm which will be described 
briefly. The resulting design is referred to as a "coverage design" 
from among the class of space-filling designs. If fixed points are
specified they are simply fixed in the design set and are not allowed to be
swapped out.</p>
<p>ALGORITHM:
 An initial set of nd points is chosen randomly  
if no starting 
configuration is provided. The nc x nd distance matrix between the 
points in C and the points in D is computed, and raised to the power P. 
The "row sums" of this matrix are computed.  Denote these as rs.i and 
the vector of row sums as rs.  Using rs, M(D,C) is computed as:</p>
<p>[sum i (rs.i)**(Q/P)]**(1/Q)</p>
<p>Note that if point d.i is "swapped" for point c.j, one must 
only recompute 1 column of the original distance matrix, and 1 row. 
The row elements not in the ith column will be the same for all j and 
so only need computing when the first swapping occurs for each d.i . 
Denote the sum of these off-i elements as "newrow(i)".  The index is 
i here since this is the same for all rows (j=1,...nc). 
Thus, for each swap, the row sums vector is updated as</p>
<p>rs(new) = rs(old) - column(i,old) + column(i,new)</p>
<p>And the jth element of rs(new) is replaced by:</p>
<p>rs(new)[j] = column(i,new)[k] + newrow(i)</p>
<p>Finally, M(D,C) is computed for this swap of the ith design point 
for the jth candidate point using [2].  The point in C that when 
swapped produces the minimum value of M(D,C) replaces d.i. 
This is done for all nd points in the design, and is iterated until 
M(D,C) does not change. 
When the nearest neighbor option is selected, then the points 
considered for swapping are limited to the num.nn nearest neighbors 
of the current design point.</p>
<p>STABILITY</p>
<p>The algorithm described above is guaranteed to converge.  However, upon
convergence, the solution is sensitive to the initial configuration of
points.  Thus, it is recommended that multiple optimizations be done (i.e.
set nruns greater than 1 ).  Also, the quality of the solution depends on
the density of the points on the region.  At the same time, for large
regions , optimization can be computationally prohibitive unless the
nearest neighbor option is employed.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Johnson, M.E., Moore, L.M., and Ylvisaker, D. (1990).  Minimax and 
maximin distance designs. Journal of Statistical Planning and 
Inference 26, 131-148. 
SAS/QC Software. Volume 2: Usage and Reference. Version 6. First 
Edition (1995). "Proc Optex". SAS Institute Inc. SAS Campus Drive,</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>rdist, rdist.earth</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## </span></span></span>
<span class="r-in"><span><span class="co"># first generate candidate set</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># setting seed so that you get the same thing I do!</span></span></span>
<span class="r-in"><span><span class="va">test.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="fl">600</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test1.des</span><span class="op">&lt;-</span><span class="fu">cover.design</span><span class="op">(</span>R<span class="op">=</span><span class="va">test.df</span>,nd<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="va">test1.des</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cover.design(R = test.df, nd = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of design points: 10   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of fixed points:  0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Optimality Criterion:    0.406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> History:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  step swap.out swap.in new.crit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0        0       0   0.7055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      188      75   0.6510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      190     161   0.5859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      137     194   0.5356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      139      67   0.5137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5       43     146   0.5116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6      115      42   0.5109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7      158     123   0.5007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     8      189      84   0.4975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     9       55      38   0.4731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    10      193     138   0.4675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    11       75     120   0.4510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    12      161      29   0.4288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    13      194      97   0.4217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14      146      45   0.4151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    15       42      36   0.4145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    16      123     187   0.4078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    17       38      46   0.4060</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">test1.des</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cover.design-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">candidates</span><span class="op">&lt;-</span> <span class="fu"><a href="grid.list.html">make.surface.grid</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">5</span>,,<span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,,<span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">&lt;-</span> <span class="fu">cover.design</span><span class="op">(</span> <span class="va">candidates</span>, <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># find 10 more points keeping this original design fixed</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out3</span><span class="op">&lt;-</span><span class="fu">cover.design</span><span class="op">(</span> <span class="va">candidates</span>, <span class="fl">10</span>,fixed<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">best.id</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># see what happened</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">candidates</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, pch<span class="op">=</span><span class="st">"."</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">out</span><span class="op">$</span><span class="va">design</span>, pch<span class="op">=</span><span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">out3</span><span class="op">$</span><span class="va">design</span>, pch<span class="op">=</span><span class="st">"o"</span><span class="op">)</span>    </span></span>
<span class="r-plt img"><img src="cover.design-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># here is a strange graph illustrating the swapping history for the</span></span></span>
<span class="r-in"><span><span class="co"># the first design. Arrows show the swap done  </span></span></span>
<span class="r-in"><span><span class="co"># at each pass through the design.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">h</span><span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">history</span></span></span>
<span class="r-in"><span><span class="va">cd</span><span class="op">&lt;-</span> <span class="va">candidates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">cd</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, pch<span class="op">=</span><span class="st">"."</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">out</span><span class="op">$</span><span class="va">design</span>, pch<span class="op">=</span><span class="st">"O"</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">out</span><span class="op">$</span><span class="va">start.design</span>, pch<span class="op">=</span><span class="st">"x"</span>, col<span class="op">=</span><span class="fl">5</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="va">cd</span><span class="op">[</span><span class="va">h</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span><span class="va">cd</span><span class="op">[</span><span class="va">h</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span><span class="va">cd</span><span class="op">[</span><span class="va">h</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span><span class="va">cd</span><span class="op">[</span><span class="va">h</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,<span class="fl">2</span><span class="op">]</span>,length<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span> <span class="va">cd</span><span class="op">[</span><span class="va">h</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span><span class="va">cd</span><span class="op">[</span><span class="va">h</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">h</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, cex<span class="op">=</span><span class="fl">1.0</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="cover.design-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>                               </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># try this out using "Manhattan distance"</span></span></span>
<span class="r-in"><span><span class="co">#  ( distance following a grid of city streets)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dist.man</span><span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">d</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span> <span class="va">x1</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="va">temp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span> <span class="va">x1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">x2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="st">'-'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="kw">for</span> <span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">d</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>               <span class="va">temp</span><span class="op">&lt;-</span> <span class="va">temp</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span> <span class="va">x1</span><span class="op">[</span>,<span class="va">k</span><span class="op">]</span>, <span class="va">x2</span><span class="op">[</span>,<span class="va">k</span><span class="op">]</span>,<span class="st">'-'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="op">}</span></span></span>
<span class="r-in"><span>            <span class="va">temp</span> <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use the design from the Euclidean distance as the starting</span></span></span>
<span class="r-in"><span><span class="co">#configuration.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">cover.design</span><span class="op">(</span> <span class="va">candidates</span>, <span class="fl">15</span>, DIST<span class="op">=</span><span class="va">dist.man</span>, start<span class="op">=</span> <span class="va">out3</span><span class="op">$</span><span class="va">best.id</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">out2</span></span></span>
<span class="r-in"><span><span class="co"># this takes a while ...</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">out2</span><span class="op">$</span><span class="va">design</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">out3</span><span class="op">$</span><span class="va">design</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cover.design-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># find a design on the sphere</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">candidates</span><span class="op">&lt;-</span> <span class="fu"><a href="grid.list.html">make.surface.grid</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">180</span>,<span class="fl">180</span>,,<span class="fl">20</span><span class="op">)</span>, y<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">85</span>,</span></span>
<span class="r-in"><span><span class="fl">85</span>,,<span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out4</span><span class="op">&lt;-</span><span class="fu">cover.design</span><span class="op">(</span> <span class="va">candidates</span>, <span class="fl">15</span>, DIST<span class="op">=</span><span class="va">rdist.earth</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># this takes a while </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">candidates</span>, pch<span class="op">=</span><span class="st">"+"</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">out4</span><span class="op">$</span><span class="va">design</span>, pch<span class="op">=</span><span class="st">"o"</span>, cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cover.design-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># covering based on correlation for 153 ozone stations</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cor.mat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span>, use<span class="op">=</span><span class="st">"pairwise"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cor.dist</span><span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">-</span><span class="va">cor.mat</span><span class="op">[</span> <span class="va">x1</span>,<span class="va">x2</span><span class="op">]</span>, ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># find 25 points out of the 153</span></span></span>
<span class="r-in"><span><span class="co"># here the "locations" are just the index but the distance is </span></span></span>
<span class="r-in"><span><span class="co"># determined by the correlation function. </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">out5</span><span class="op">&lt;-</span><span class="fu">cover.design</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">153</span><span class="op">)</span>,<span class="fl">25</span>, DIST<span class="op">=</span> <span class="va">cor.dist</span>, scale.type<span class="op">=</span><span class="st">"unscaled"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span>, pch<span class="op">=</span><span class="st">"."</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>  <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span><span class="op">[</span><span class="va">out5</span><span class="op">$</span><span class="va">best.id</span>,<span class="op">]</span>,pch<span class="op">=</span><span class="st">"O"</span>, col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cover.design-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># this seems a bit strange probably due some funny correlation values</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reset panel</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 1 by 1 matrix </span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

