<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Draws an image plot with a legend strip for the color scale based on either
a regular grid or a grid of quadrilaterals. — image.plot • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Draws an image plot with a legend strip for the color scale based on either
a regular grid or a grid of quadrilaterals. — image.plot"><meta property="og:description" content="This function combines the R image function with some automatic 
placement of a legend. This is done by splitting the plotting region  
into two parts. Putting the image in one and the legend in the other. After the
legend is added the plot region is reset to the image plot.
This function also allows for plotting quadrilateral cells in the image format that
often arise from regular grids transformed with a map projection or a scaling and rotation of coordinates. See the example where this function can create a similar graphic 
to the ggplot package.
image.plot functionality has been frozen, see the more recent function
imagePlot which is backwardly compatible with this function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/fastTps.html">fastTps</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Draws an image plot with a legend strip for the color scale based on either
a regular grid or a grid of quadrilaterals.</h1>
    
    <div class="hidden name"><code>image.plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function combines the R image function with some automatic 
placement of a legend. This is done by splitting the plotting region  
into two parts. Putting the image in one and the legend in the other. After the
legend is added the plot region is reset to the image plot.
This function also allows for plotting quadrilateral cells in the image format that
often arise from regular grids transformed with a map projection or a scaling and rotation of coordinates. See the example where this function can create a similar graphic 
to the ggplot package.
<code>image.plot</code> functionality has been frozen, see the more recent function
<code><a href="imagePlot.html">imagePlot</a></code> which is backwardly compatible with this function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">...</span>,</span>
<span>                 add <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                 breaks<span class="op">=</span> <span class="cn">NULL</span>, nlevel <span class="op">=</span> <span class="fl">64</span>, col <span class="op">=</span> <span class="cn">NULL</span>,  </span>
<span>    horizontal <span class="op">=</span> <span class="cn">FALSE</span>, legend.shrink <span class="op">=</span> <span class="fl">0.9</span>, legend.width <span class="op">=</span> <span class="fl">1.2</span>, </span>
<span>    legend.mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">horizontal</span>, <span class="fl">3.1</span>, <span class="fl">5.1</span><span class="op">)</span>, legend.lab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    legend.line<span class="op">=</span> <span class="fl">2</span>,                    </span>
<span>    graphics.reset <span class="op">=</span> <span class="cn">FALSE</span>, bigplot <span class="op">=</span> <span class="cn">NULL</span>, smallplot <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    legend.only <span class="op">=</span> <span class="cn">FALSE</span>,  lab.breaks <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    axis.args <span class="op">=</span> <span class="cn">NULL</span>, legend.args <span class="op">=</span> <span class="cn">NULL</span>, legend.cex<span class="op">=</span><span class="fl">1.0</span>,</span>
<span>    midpoint <span class="op">=</span> <span class="cn">FALSE</span>, border <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>    lwd <span class="op">=</span> <span class="fl">1</span>,verbose <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>...</dt>
<dd><p>The usual arguments to the <code>image</code> function as x,y,or z or as a
list with x,y,z as components. One can also include a <code>breaks</code> 
argument for an unequal spaced color scale with color scale boundaries
at the breaks (see example below).  If a "quadrilateral grid",
arguments must be explicitly x,y and z with x, and y being matrices of
dimensions equal to, or one more than, z giving the grid
locations. The basic concept is that the coordinates of x and y still
define a grid but the image cells are quadrilaterals rather than being
restricted to rectangles. NOTE: graphical argruments passed here will only have impact
on the image plot. To change the graphical defaults for the legend use
 the individual legend arguments and/or  <code>legend.arg</code> listed 
 below.</p></dd>


<dt>add</dt>
<dd><p>If true add image and a legend strip to the existing plot.</p></dd>


<dt>bigplot</dt>
<dd><p>Plot coordinates for image plot. If not passed
these will
be determined within the function.</p></dd>


<dt>border</dt>
<dd><p>This only works if x and y are matrices -- if NA the quadralaterals will 
have a border color that is 
the same as the interior color. Otherwise this specifies the color to use.</p></dd>


<dt>breaks</dt>
<dd><p>Break points in sorted order to indicate the intervals for assigning
	the colors. Note that if there are nlevel colors there should be  (nlevel+1)
 breakpoints. If <code>breaks</code> is not specified (nlevel+1) equally spaced breaks are created where the first and last bin have their midpoints at the minimum and maximum values in <code>z</code> or at <code>zlim</code>.</p></dd>


<dt>col</dt>
<dd><p>Color table to use for image (See help file on image for details.).
Default is a pleasing range of 64 divisions suggested by Tim Hoar and is similar to 
the MATLAB (TM) jet color scheme. Note that if <code>breaks</code> is specified there must be one less color specified than the number of breaks.</p></dd>


<dt>graphics.reset</dt>
<dd><p>If FALSE (default) the plotting region ( plt in par) will not be reset 
and one can add more information onto the image plot. (e.g. using functions
such as points or lines.)  If TRUE will reset plot parameters to the
values before entering the function.</p></dd>


<dt>horizontal</dt>
<dd><p>If false (default) legend will be a vertical strip on the right side. If
true the legend strip will be along the bottom.</p></dd>


<dt>lab.breaks</dt>
<dd><p>If breaks are supplied these are text string labels
to put at each break value. This is intended to label axis on a
transformed scale such as logs.</p></dd>


<dt>axis.args</dt>
<dd><p>Additional arguments for the axis function used to 
create the legend axis. (See example below adding a log scaling.)</p></dd>


<dt>legend.only</dt>
<dd><p>If TRUE just add the
legend to a the plot in the plot region defined by the coordinates in
smallplot. In the absence of other information the range for the legend 
is determined from the <code>zlim</code> argument.</p></dd>


<dt>legend.args</dt>
<dd><p>Arguments for a complete specification of the 
legend label, e.g. if you need to the rotate text or other details.  This is in the form of list and is just passed to the 
mtext function and you will need to give both the side and line arguments for positioning.  This usually will not be needed. 
(See example below.)</p></dd>


<dt>legend.cex</dt>
<dd><p>Character expansion to change size of the legend label.</p></dd>


<dt>legend.line</dt>
<dd><p>Distance in units of character height (as in <code>mtext</code>)
 of the legend label from the 
color bar. Make this larger if the label collides with the color axis labels.</p></dd>


<dt>legend.mar</dt>
<dd><p>Width in characters of legend margin that has the axis. Default is 5.1 
for a vertical legend and 3.1 for a horizontal legend.</p></dd>


<dt>legend.lab</dt>
<dd><p>Label for the axis of the color legend. Default is no
label as this is usual evident from the plot title.</p></dd>


<dt>legend.shrink</dt>
<dd><p>Amount to shrink the size of legend relative to the full height or
 width
of the plot.</p></dd>


<dt>legend.width</dt>
<dd><p>Width in characters of the legend strip. Default is 1.2, a little
bigger 
that the width of a character.</p></dd>


<dt>lwd</dt>
<dd><p>Line width of bordering lines around pixels.
 This might need to be set less than 1.0 
to avoid visible rounding of the pixel corners.</p></dd>


<dt>midpoint</dt>
<dd><p>This option for the case of unequally spaced grids with x and y being 
matrices of grid point locations. 
 If FALSE (default) the quadralaterals  will be extended
to surround the  z locations as midpoints. If TRUE z values will be
averaged
to yield a midpoint value and the original grid points be used to define
the
quadralaterals. (See help on poly.image for details). In most cases
midpoint should be FALSE to preserve exact values for z and 
let the grid polygons be modified.</p></dd>


<dt>nlevel</dt>
<dd><p>Number of color levels used in legend strip</p></dd>


<dt>smallplot</dt>
<dd><p>Plot coordinates for legend strip.  If not passed these will be
determined within
the function. Be sure to leave room for the axis labels. For example, if
the legend is on the
right side  <code>smallplot= c(.85,.9,0,1) </code> will leave (.1 in plot
coordinates) for the
axis labels to the right of the color strip. This argument is useful 
for drawing a 
plot with the legend that is the same size as the plots without legends.</p></dd>


<dt>verbose</dt>
<dd><p>If TRUE prints intermediate information about
setting up plots (for debugging).</p></dd>

</dl></div>
    <div id="side-effects">
    <h2>Side Effects</h2>
    <p>After exiting, the
plotting region may be changed to make it possible to add more features to
the plot. To be explicit, <code>par()\$plt</code> may be changed to reflect a 
smaller plotting region that has accommodated room for the legend subplot.</p>
<p>If <code>xlim</code> and <code>ylim</code> are specified the pixels may overplot the axis lines. 
Just use the <code>box</code> function to redraw them.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    
	
<p>This is a function using the basic R graphics. The coding was done to make it easier for users to see how this function works and to modify.</p>
<p><strong>How this function works:</strong>
The strategy for <code>image.plot</code> is simple, divide the plotting region
into two smaller regions <code>bigplot</code> and <code>smallplot</code>. The image
goes in one and the legend in the other. This way there is always room for
the legend. Some adjustments are made to this rule by not shrinking the
<code>bigplot</code> if there is already room for the legend strip and also
sticking the legend strip close to the image plot. One can specify the
plot regions explicitly by <code>bigplot</code> and  <code>smallplot</code> if the
default choices do not work.(Note that these in figure coordinates.
) There may be problems with small plotting
regions in fitting both of these elements into the plot region and one may 
have to change the default character sizes or margins to make things fit.
Sometimes this function will not reset the type of margins correctly and the
"null" call <code>par(mar = par("mar"))</code> may help to fix this issue.</p>
<p><strong>The text is too small!</strong> 
This always seems to happen as one is rushing to finish a talk  and the figures have tiny default axis labels. Try just calling the function <code>fields.style</code> before plotting. List out this function to see what is changed, however, all text is increased by 20% in size.</p>
<p><strong>Why ``image.plot" and not ``image"?</strong> The R Base function <code>image</code> is very 
useful but it is awkward to place a legend quickly. However, that said if you are
drawing several image plots and want a common legend use the <code>image</code> function 
and just just use <code>image.plot</code> to add the legend. See the example in the 
help file. Note that you can use <code>image</code> to draw a bunch of images and then follow with <code>image.plot</code> and <code>legend.only=TRUE</code> to add a common legend. (See examples below.)</p>
<p><strong>Almost cloropleths too:</strong>  It  should be noted that this image function is slightly
different than a cloropleth map because
the legend is assuming that a continous scale has been discretized into a series of colors.
To make the image.plot function as a  cloropleth graphic one would of course use the
 <code>breaks</code> option
and for clarity perhaps code the different regions as different integer values. 
In addition, for publication quality one would want to use the <code>legend.args</code> to
add more descriptive labels at the midpoints in the color strip.</p>
<p><strong>Relationship of x, y and z:</strong>
 If the z component is a matrix then the user should be aware that
this function locates the matrix element z[i,j] at the grid locations
(x[i], y[j]) this is very different than simply listing out the
matrix in the usual row column tabular form. See the example below
for details on the difference in formatting. What does one do
if you do not really have the "z" values on a regular grid? See the
functions <code>quilt.plot.Rd</code> and <code>as.image</code> to discretise
irregular observations to a grid. If the values makes sense as points on 
a smooth surface see <code>Tps</code> and <code>fastTps</code> for surface interpolation.</p>
<p><strong>Adding separate color to indicate the grid box boundaries.</strong> Sometimes you want to show to the grid box borders to emphasize this is not a smooth surface. To our knowledge there is no easy way to do this as an option in <code>image</code>. But if your image is formatted in the "poly image" style where x and y are also matrices you can use the polyimage  (see the <code>border</code> argument above) option to draw in boundaries.</p>

<p><strong>Grids with unequally spacing -- quadrialteral pixels:</strong>
If x and y are matrices that are a smooth transformation of a regular grid  then
z[i,j] can be interperted as representing the average value in a quadrilateral that is centered at x[i,j] and
y[i,j] (<code>midpoint</code> TRUE). The details of how this cell is found
are buried in <code>poly.image</code> but it it essentially found using midpoints between the centers. If <code>midpoint</code> is FALSE then x
and y are interpreted as the corners of the quadrilateral cells. But
what about z? The four values of z are now averaged to represent a
value at the midpoint of the cell and this is what is used for
plotting. Quadrilateral grids were added to help with plotting 
the gridded output of geophysical models where the regular grid is
defined according to one map projection but the image plotting is required
in another projection. Typically the regular grid becomes distorted in 
a smooth way when this happens. See the regional climate example for
a illustration of this application. One can add border colors in this case
easily because these choices are just passed onto the polygon function.</p>
<p><strong>Adding the pixel grid for rectangular images:</strong>
For adding the grid of pixel borders to a rectangular image try this example 
after calling <code>image.plot</code>.</p>
<div class="sourceCode"><pre><code><span> </span>
<span> <span class="va">dx</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>  </span>
<span> <span class="va">dy</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>  </span>
<span> <span class="va">xtemp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span> <span class="va">x</span><span class="op">)</span><span class="op">-</span> <span class="va">dx</span><span class="op">/</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span> <span class="va">dx</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>         length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span><span class="fl">1</span><span class="op">)</span> </span>
<span> <span class="va">ytemp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span> <span class="va">y</span><span class="op">)</span><span class="op">-</span> <span class="va">dy</span><span class="op">/</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">+</span> <span class="va">dy</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>         length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span> <span class="fu"><a href="../reference/xline.html">xline</a></span><span class="op">(</span> <span class="va">xtemp</span>, col<span class="op">=</span><span class="st">"grey"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span> <span class="fu"><a href="../reference/yline.html">yline</a></span><span class="op">(</span> <span class="va">ytemp</span>, col<span class="op">=</span><span class="st">"grey"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></code></pre></div>

<p>Here <code>x</code> and <code>y</code> here are the x and y grid values from the image list.</p>
<p><strong>Fine tuning color scales:</strong> This function gives some flexibility in
tuning the color scale to fit the rendering of z values. This can
either be specially designed color scale with specific colors ( see
help on <code>designer.colors</code>), positioning the colors at specific
points on the [0,1] scale, or mapping distinct colors to intervals of
z. The examples below show how to do each of these. In addition, by
supplying <code>lab.break</code> strings or axis parameters one can
annotate the legend axis in an informative matter.</p>
<p><strong>Adding just the legend strip:</strong>
Note that to add just the legend strip all the numerical information one
needs is the <code>zlim</code> argument and the color table! See examples for tricks in positioning.</p>
<p><strong>About color tables:</strong>
We like <code>tim.colors</code> 
as a default color scale and so if this what you use this can be omitted.
Unfortunately this is not the default for the <code>image</code> function. Another
important color scale is <code><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link"> viridis() </a></code> from the viridis package.
It seems that by
and large everyone seems to react postively to viridis -- guess that is the
point!</p>
<p>The
topographic color scale (<code>topo.colors</code>) is
also a close second showing our geophysical bias.
Users may find <code>larry.colors</code> useful for coding distinct regions
in the style of a cloropleith map.   See also
<code>terrain.colors</code> for a subset of the topo ones and <code>designer.colors</code> to "roll
your own" color table. One nice option in this last function is to fix
color transitions at
particular quantiles of the data rather than at equally spaced
intervals. For color choices see how the <code>nlevels</code> argument figures
into the legend and main plot number of colors. Also see the <code>colors</code>
function
for a listing of all the colors that come with the R base environment.</p>
<p><strong>The details of placing the legend and 
dividing up the plotting real estate:</strong>
It is surprising how hard it is to automatically add the
legend! All "plotting coordinates" mentioned here are in device
coordinates. The plot region is assumed to be [0,1]X[0,1] and plotting
regions are defined as rectangles within this square. We found these
easier to work with than user coordinates.</p>
<p><code>legend.width</code> and <code>legend.mar</code> are in units of character
spaces. These units are helpful in thinking about axis labels that
will be put into these areas. To add more or less space between the
legend and the image plot alter the mar parameters. The default mar
settings (5.1,5.1,5.1,2.1) leaves 2.1 spaces for vertical legends and
5.1 spaces for horizontal legends.</p>
<p>There are always problems with
default solutions to placing information on graphs but the choices made
here may be useful for most cases. The most annoying thing is that after
using image.plot and adding information the next plot that is made may
have the slightly smaller plotting region set by the image plotting.
The user should set <code>reset.graphics=TRUE</code> to avoid the plotting
size 
from changing. The disadvantage, however, of resetting the graphics 
is that one can no longer add additional graphics elements to the 
image 
plot. Note that filled.contour always resets the graphics but provides 
another mechanism to pass through plotting commands. Apparently 
<code>filled.contour</code>, while very pretty, does not work for multiple plots.</p>
<p><strong>About setup and add legend functions</strong> These came about to create a
scatterplot in Base R Graphics where the points are colored with a color scale
and the scale can be plotted as part of the figure
See <code> <a href="quilt.plot.html">bubblePlot</a> </code> for a version of this kind of figure.  The
function <code>setupLegend</code> should be used first to create enough space
to add a color scale later. After plotting then <code>addLegend</code> will add the
color scale. Note that if the color scale has been created by the <code>color.scale</code> function the last call to this function will use the color scale and limits created in <code>color.scale</code>.</p>
<p>In summary here is an example of using these functions with the colors in mind:</p>
<div class="sourceCode"><pre><code><span></span>
<span>  <span class="va">info</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/imagePlot.html">setupLegend</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">colTab</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">201</span><span class="op">:</span><span class="fl">210</span>, col<span class="op">=</span><span class="va">colTab</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/imagePlot.html">addLegend</a></span><span class="op">(</span><span class="va">info</span>, col<span class="op">=</span><span class="va">colTab</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

<p>Here is one where four colors are mapped to specific values (ala image).</p>
<div class="sourceCode"><pre><code><span></span>
<span>  <span class="va">info</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/imagePlot.html">setupLegend</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">colTab</span><span class="op">=</span> <span class="fu"><a href="../reference/tim.colors.html">color.scale</a></span><span class="op">(</span><span class="fl">201</span><span class="op">:</span><span class="fl">210</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">201</span><span class="op">:</span><span class="fl">210</span>, col<span class="op">=</span><span class="va">colTab</span>, pch<span class="op">=</span><span class="fl">16</span> <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/imagePlot.html">addLegend</a></span><span class="op">(</span><span class="va">info</span>, col<span class="op">=</span><span class="va">colTab</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">201</span>,<span class="fl">210</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>

<p>More complete graphics languages, such as that in  ggplot,  do not need such
functions because the
entire graphics segment is parsed to create the complete figure. In this way
room for a color scale can be created automatically. The functions proposed here
are a simple work around to create these figures using base R graphics.</p>
<p><strong>Other packages</strong>
<code>levelplot</code> that is part of the lattice package has a very 
similar function to image.plot and a formula syntax in the call.
The <code>geom_raster</code> for setting up a graphics object within <code>ggplot</code> is another alternative forr image plots with legends.
See the last example to compare the steps in creating an image plot using <code>image.plot</code> that is close to the ggplot version. Mostly this involves resetting base graphics parameters using the <code>par</code> function.</p>
<p><strong>Multiple images:</strong> 
By keeping the <code>zlim</code> argument the same across images one can generate the
same color scale. (See the <code>image</code> help file.)  One useful technique for a
panel of images is to just draw the images with good old <code>image</code> 
and then use image.plot to add a legend to the last plot. (See example 
below for messing with the outer margins to make this work.) 
Usually a square plot (<code>pty="s"</code>) done in a rectangular plot
region will
have room for the legend stuck to the right side without any other 
adjustments. See the examples below for more complicated arrangements
 of multiple image plots and a summary 
legend.  
The reader is also referred to the package <code>autoimage</code> as a set of
functions in base to help with drawing multiple images and also more
support for geographic coordinates.</p>


    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="imagePlot.html">imagePlot</a>,  <a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a>,<a href="poly.image.html">poly.image</a>, <a href="https://rdrr.io/r/graphics/filled.contour.html" class="external-link">filled.contour</a>,
<a href="quilt.plot.html">quilt.plot</a>, <a href="quilt.plot.html">bubblePlot</a>, <a href="plot.surface.html">plot.surface</a>,
<a href="add.image.html">add.image</a>, <a href="imagePlot.html">colorBar</a>, <a href="tim.colors.html">tim.colors</a>, <a href="tim.colors.html">designer.colors</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="va">x</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span></span>
<span class="r-in"><span>  <span class="va">y</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span></span></span>
<span class="r-in"><span>  <span class="va">z</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span>,<span class="st">"+"</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu">image.plot</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="image.plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or </span></span></span>
<span class="r-in"><span>  <span class="va">obj</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,z<span class="op">=</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">image.plot</span><span class="op">(</span><span class="va">obj</span>, legend.lab<span class="op">=</span><span class="st">"Sverdrups"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">################################################################ </span></span></span>
<span class="r-in"><span><span class="co"># the next sequence of examples explain how to quickly </span></span></span>
<span class="r-in"><span><span class="co"># adpat this basic plot to include morre features</span></span></span>
<span class="r-in"><span><span class="co"># In another direction see the very last example where </span></span></span>
<span class="r-in"><span><span class="co"># we use many of the setting in base R graphic to mimic a </span></span></span>
<span class="r-in"><span><span class="co"># (beautiful) ggplot version. </span></span></span>
<span class="r-in"><span><span class="co">###############################################################</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># add some points on diagonal using standard plot function</span></span></span>
<span class="r-in"><span><span class="co">#(with some clipping beyond 10 anticipated)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="fl">5</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">12</span>, pch<span class="op">=</span><span class="st">"X"</span>, cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># in general image.plot will reset the plot window so you</span></span></span>
<span class="r-in"><span><span class="co"># can add any feature that normally works in base R</span></span></span>
<span class="r-in"><span><span class="co"># e.g. lines, text, contour, boxplots, ....</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># adding breaks and distinct colors for intervals of z</span></span></span>
<span class="r-in"><span><span class="co"># with and without lab.breaks</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">brk</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">image.plot</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>, breaks<span class="op">=</span><span class="va">brk</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># annotate legend strip with the  break point values and add a label</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">image.plot</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>, breaks<span class="op">=</span><span class="va">brk</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       lab.breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brk</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># compare to </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">zp</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">.05</span>, <span class="fl">.1</span>,<span class="fl">.5</span>, <span class="fl">.9</span>,<span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">image.plot</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>, </span></span>
<span class="r-in"><span>     axis.args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> at<span class="op">=</span><span class="va">zp</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">zp</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="co"># a log scaling for the colors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">ticks</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">1</span>, <span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">8</span>,<span class="fl">16</span>,<span class="fl">32</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">image.plot</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, axis.args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ticks</span><span class="op">)</span>, labels<span class="op">=</span><span class="va">ticks</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see help file for designer.colors to generate a color scale that adapts to </span></span></span>
<span class="r-in"><span><span class="co"># quantiles of z. </span></span></span>
<span class="r-in"><span><span class="co"># Add some color scales together here is an example of  5 blues to white to 5 reds</span></span></span>
<span class="r-in"><span><span class="co"># with white being a specific size.</span></span></span>
<span class="r-in"><span> <span class="va">colorTable</span><span class="op">&lt;-</span> <span class="fu"><a href="tim.colors.html">designer.colors</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"blue"</span>,<span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># breaks with a gap of 10 to 17 assigned the white color</span></span></span>
<span class="r-in"><span> <span class="va">brks</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">1</span>, <span class="fl">10</span>,,<span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">17</span>, <span class="fl">25</span>,,<span class="fl">6</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span> <span class="fu">image.plot</span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>,breaks<span class="op">=</span><span class="va">brks</span>, col<span class="op">=</span><span class="va">colorTable</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#fat (5 characters wide) and short (50% of figure)  color bar on the bottom</span></span></span>
<span class="r-in"><span>   <span class="fu">image.plot</span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>,legend.width<span class="op">=</span><span class="fl">5</span>, legend.shrink<span class="op">=</span><span class="fl">.5</span>, horizontal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="image.plot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># adding a label with all kinds of additional arguments.</span></span></span>
<span class="r-in"><span><span class="co"># use side=4 for vertical legend and side= 1 for horizontal legend</span></span></span>
<span class="r-in"><span><span class="co"># to be parallel to axes. See help(mtext).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">image.plot</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>, </span></span>
<span class="r-in"><span>       legend.args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> text<span class="op">=</span><span class="st">"unknown units"</span>,</span></span>
<span class="r-in"><span>     col<span class="op">=</span><span class="st">"magenta"</span>, cex<span class="op">=</span><span class="fl">1.5</span>, side<span class="op">=</span><span class="fl">4</span>, line<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="co"># and finally add some grid lines</span></span></span>
<span class="r-in"><span> <span class="va">dx</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>  </span></span>
<span class="r-in"><span> <span class="va">dy</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>  </span></span>
<span class="r-in"><span> <span class="va">xtemp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span> <span class="va">x</span><span class="op">)</span><span class="op">-</span> <span class="va">dx</span><span class="op">/</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span> <span class="va">dx</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>         length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span><span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-in"><span> <span class="va">ytemp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span> <span class="va">y</span><span class="op">)</span><span class="op">-</span> <span class="va">dy</span><span class="op">/</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">+</span> <span class="va">dy</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>         length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="xline.html">xline</a></span><span class="op">(</span> <span class="va">xtemp</span>, col<span class="op">=</span><span class="st">"grey"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="yline.html">yline</a></span><span class="op">(</span> <span class="va">ytemp</span>, col<span class="op">=</span><span class="st">"grey"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################################################</span></span></span>
<span class="r-in"><span><span class="co">#### example using an irregular quadrilateral grid</span></span></span>
<span class="r-in"><span><span class="co">###############################################################</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span> <span class="va">RCMexample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">image.plot</span><span class="op">(</span> <span class="va">RCMexample</span><span class="op">$</span><span class="va">x</span>, <span class="va">RCMexample</span><span class="op">$</span><span class="va">y</span>, <span class="va">RCMexample</span><span class="op">$</span><span class="va">z</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">ind</span><span class="op">&lt;-</span> <span class="fl">50</span><span class="op">:</span><span class="fl">75</span> <span class="co"># make a smaller image to show bordering lines</span></span></span>
<span class="r-in"><span><span class="fu">image.plot</span><span class="op">(</span> <span class="va">RCMexample</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">ind</span>,<span class="va">ind</span><span class="op">]</span>, <span class="va">RCMexample</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">ind</span>,<span class="va">ind</span><span class="op">]</span>, <span class="va">RCMexample</span><span class="op">$</span><span class="va">z</span><span class="op">[</span><span class="va">ind</span>,<span class="va">ind</span>,<span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                                      border<span class="op">=</span><span class="st">"grey50"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################################################</span></span></span>
<span class="r-in"><span><span class="co">#### multiple images with a common legend</span></span></span>
<span class="r-in"><span><span class="co">###############################################################</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 1 by 1 matrix </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here is quick but quirky way to add a common legend to several plots.</span></span></span>
<span class="r-in"><span><span class="co"># The idea is leave some room in the margin and then at the end </span></span></span>
<span class="r-in"><span><span class="co"># overplot the legend in this margin</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># margin of 4 spaces width at right hand side</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span> <span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># 2X2 matrix of plots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 2 by 2 matrix </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now draw all your plots using usual image command</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span>  <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">data</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span>, <span class="fl">10</span>,<span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="va">data</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="tim.colors.html">tim.colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># and just for fun add a contour plot  </span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span> <span class="va">data</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="co"># reset margin to be much smaller.</span></span></span>
<span class="r-in"><span><span class="fu">image.plot</span><span class="op">(</span> legend.only<span class="op">=</span><span class="cn">TRUE</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="image.plot-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># image.plot tricked into  plotting in margin of old setting </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># reset plotting device</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 1 by 1 matrix </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Here is a more learned strategy to add a common legend to a panel of</span></span></span>
<span class="r-in"><span><span class="co"># plots  consult the split.screen help file for more explanations.</span></span></span>
<span class="r-in"><span><span class="co"># For this example we draw two</span></span></span>
<span class="r-in"><span><span class="co"># images top and bottom and add a single legend color bar on the right side </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># first divide screen into the figure region (left) and legend region (right)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/screen.html" class="external-link">split.screen</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.8</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now subdivide up the figure region into two parts</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/screen.html" class="external-link">split.screen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, screen<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">ind</span></span></span>
<span class="r-in"><span>   <span class="va">zr</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span> <span class="fl">2</span>,<span class="fl">35</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># first image</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/screen.html" class="external-link">screen</a></span><span class="op">(</span> <span class="va">ind</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>, col<span class="op">=</span><span class="fu"><a href="tim.colors.html">tim.colors</a></span><span class="op">(</span><span class="op">)</span>, zlim<span class="op">=</span><span class="va">zr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># second image</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/screen.html" class="external-link">screen</a></span><span class="op">(</span> <span class="va">ind</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span><span class="op">+</span><span class="fl">10</span>, col<span class="op">=</span><span class="fu"><a href="tim.colors.html">tim.colors</a></span><span class="op">(</span><span class="op">)</span>, zlim <span class="op">=</span><span class="va">zr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># move to skinny region on right and draw the legend strip </span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/screen.html" class="external-link">screen</a></span><span class="op">(</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu">image.plot</span><span class="op">(</span> zlim<span class="op">=</span><span class="va">zr</span>,legend.only<span class="op">=</span><span class="cn">TRUE</span>, smallplot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.2</span>, <span class="fl">.3</span>,<span class="fl">.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   col<span class="op">=</span><span class="fu"><a href="tim.colors.html">tim.colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/screen.html" class="external-link">close.screen</a></span><span class="op">(</span> all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># you can always add a legend arbitrarily to any plot;</span></span></span>
<span class="r-in"><span><span class="co"># note that here the plot is too big for the vertical strip but the</span></span></span>
<span class="r-in"><span><span class="co"># horizontal fits nicely.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">image.plot</span><span class="op">(</span> zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span><span class="op">)</span>, legend.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">image.plot</span><span class="op">(</span> zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span><span class="op">)</span>, legend.only<span class="op">=</span><span class="cn">TRUE</span>, horizontal <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combining the  usual image function and adding a legend</span></span></span>
<span class="r-in"><span><span class="co"># first change margin for some more room</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span> mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">topo.colors</a></span><span class="op">(</span><span class="fl">64</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">image.plot</span><span class="op">(</span> zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span><span class="op">)</span>, nlevel<span class="op">=</span><span class="fl">64</span>,legend.only<span class="op">=</span><span class="cn">TRUE</span>, horizontal<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">topo.colors</a></span><span class="op">(</span><span class="fl">64</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># adding a legend by  automatically making room. </span></span></span>
<span class="r-in"><span><span class="co"># and coloring points</span></span></span>
<span class="r-in"><span>  <span class="va">info</span><span class="op">&lt;-</span> <span class="fu"><a href="imagePlot.html">setupLegend</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">colTab</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fl">201</span><span class="op">:</span><span class="fl">210</span>, <span class="fl">201</span><span class="op">:</span><span class="fl">210</span>, col<span class="op">=</span><span class="va">colTab</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="imagePlot.html">addLegend</a></span><span class="op">(</span><span class="va">info</span>, col<span class="op">=</span><span class="va">colTab</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">201</span>,<span class="fl">210</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.plot-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#######################################################</span></span></span>
<span class="r-in"><span><span class="co">##### Comparison to ggplot</span></span></span>
<span class="r-in"><span><span class="co">#######################################################</span></span></span>
<span class="r-in"><span><span class="co"># the following example was created as way avoid doing more important</span></span></span>
<span class="r-in"><span><span class="co"># things </span></span></span>
<span class="r-in"><span><span class="co"># Note how close base graphics can get to reproducing the ggplot style.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">24</span></span></span>
<span class="r-in"><span><span class="va">z</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span> <span class="va">x</span>, <span class="va">y</span>, <span class="st">"+"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ggplot version </span></span></span>
<span class="r-in"><span>  <span class="va">mesh</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span> x<span class="op">=</span> <span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mesh</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> data<span class="op">=</span><span class="va">mesh</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>interpolate<span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span>  <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inflate range to give a margin around image</span></span></span>
<span class="r-in"><span>  <span class="va">xr</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.08</span>, <span class="fl">.08</span><span class="op">)</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">yr</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.08</span>, <span class="fl">.08</span><span class="op">)</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># changing these graphics parameters tends to push </span></span></span>
<span class="r-in"><span><span class="co"># text closer to the axes. </span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span> mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">.5</span>,<span class="fl">0</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">2.5</span>,<span class="fl">.5</span>,<span class="fl">1</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">.8</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu">image.plot</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>, </span></span>
<span class="r-in"><span>             col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">128</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>   legend.shrink <span class="op">=</span> <span class="fl">.27</span>,</span></span>
<span class="r-in"><span>            xlim <span class="op">=</span> <span class="va">xr</span>, </span></span>
<span class="r-in"><span>            ylim <span class="op">=</span> <span class="va">yr</span>,</span></span>
<span class="r-in"><span>    legend.width <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>      legend.mar <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>     legend.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> text <span class="op">=</span> <span class="st">"z"</span>,</span></span>
<span class="r-in"><span>                          cex <span class="op">=</span> <span class="fl">.8</span>,</span></span>
<span class="r-in"><span>                         side <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                         line <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

