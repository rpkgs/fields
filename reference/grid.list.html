<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Some simple functions for working with gridded data and 
the grid format (grid.list) used in fields. — grid list • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Some simple functions for working with gridded data and 
the grid format (grid.list) used in fields. — grid list"><meta property="og:description" content='
    
The object grid.list refers to a list that contains
information for evaluating a function on a 2-dimensional
grid of points. If a function has more than two
independent variables then one also needs to specify the
constant levels for the variables that are not being
varied.  This format is used in several places in fields
for functions that evaluate function estimates and plot
surfaces. These functions provide some default conversions
among information and the gird.list. The function 
discretize.image is a useful tool for "registering"
irregular 2-d points to a grid.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Some simple functions for working with gridded data and 
the grid format (grid.list) used in fields.</h1>
    
    <div class="hidden name"><code>grid.list.Rd</code></div>
    </div>

    <div class="ref-description">
    
    
<p>The object grid.list refers to a list that contains
information for evaluating a function on a 2-dimensional
grid of points. If a function has more than two
independent variables then one also needs to specify the
constant levels for the variables that are not being
varied.  This format is used in several places in fields
for functions that evaluate function estimates and plot
surfaces. These functions provide some default conversions
among information and the gird.list. The function 
<code>discretize.image</code> is a useful tool for "registering"
irregular 2-d points to a grid.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">makeMultiIndex</span><span class="op">(</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="fu">parse.grid.list</span><span class="op">(</span> <span class="va">grid.list</span>, order.variables<span class="op">=</span><span class="st">"xy"</span><span class="op">)</span></span>
<span><span class="fu">fields.x.to.grid</span><span class="op">(</span><span class="va">x</span>,nx<span class="op">=</span><span class="fl">80</span>, ny<span class="op">=</span><span class="fl">80</span>, xy<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">fields.convert.grid</span><span class="op">(</span> <span class="va">midpoint.grid</span> <span class="op">)</span></span>
<span><span class="fu">discretize.image</span><span class="op">(</span><span class="va">x</span>, m <span class="op">=</span> <span class="fl">64</span>, n <span class="op">=</span> <span class="fl">64</span>, grid <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                 expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1e-08</span>, <span class="fl">1</span> <span class="op">+</span> <span class="fl">1e-08</span><span class="op">)</span>,</span>
<span>                 boundary.grid <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">make.surface.grid</span><span class="op">(</span> <span class="va">grid.list</span><span class="op">)</span></span>
<span><span class="fu">unrollZGrid</span><span class="op">(</span> <span class="va">grid.list</span>, <span class="va">ZGrid</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>M</dt>
<dd><p>An vector of integers.</p></dd>

<dt>grid.list</dt>
<dd><p>No surprises here -- a grid list! These can be unequally 
spaced.</p></dd>

<dt>order.variables</dt>
<dd><p>If "xy" the x variable will be subsequently plotted
as the horizontal variable. If "yx" the x variable will be on the vertical 
axis.</p></dd>

<dt>x</dt>
<dd><p>A matrix of independent variables such as the locations of 
observations given to Krig.</p></dd>

<dt>nx</dt>
<dd><p>Number of grid points for x variable.</p></dd>

<dt>ny</dt>
<dd><p>Number of grid points for y variable.</p></dd>

<dt>m</dt>
<dd><p>Number of grid points for x variable.</p></dd>

<dt>n</dt>
<dd><p>Number of grid points for y variable.</p></dd>

<dt>na.rm</dt>
<dd><p>Remove missing values if TRUE</p></dd>

<dt>xy</dt>
<dd><p>The column positions that locate the x and y variables for the 
grid.</p></dd>
 
<dt>grid</dt>
<dd><p>A grid list!</p></dd>

<dt>expand</dt>
<dd><p>A scalar or two column vector that will expand the
grid beyond the range of the observations.</p></dd>


<dt>midpoint.grid</dt>
<dd><p>Grid midpoints to convert to grid boundaries.</p></dd>


<dt>boundary.grid</dt>
<dd><p>If TRUE interpret grid points as boundaries  of 
grid boxes. If FALSE interpret as the midpoints of the boxes.</p></dd>


<dt>ZGrid</dt>
<dd><p>An array  or list form of covariates to use for
	 prediction. This must match the
<code>grid.list</code> argument. e.g. ZGrid and grid.list describe the same
 grid. 
If ZGrid is an array then the first two indices are the x and y
 locations in the 
grid. The third index, if present, indexes the covariates. e.g. For
 evaluation on 
a 10X15 grid and with 2 covariates. <code> dim( ZGrid) == c(10,15, 2)</code>.
If ZGrid is a list then the components x and y shold match those of
 grid.list and
the z component follows the shape described above for the no list 
case.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>makeMultiIndex</code> creates an expanded set of indices to referencce a
regular grid. M are  L integers with product prodM
 Will create a  prodM by L matrix that is all combinations of (1:M[i]) for i =1,2, ...L
This is organized in the standard array ordering where the first
column varies the fastest for M = c( 3,2,4) the result will be a 24X3 matrix
with the entries:</p>
<div class="sourceCode"><pre><code>
                          1,1,1 
                          2,1,1
                          3,1,1
                          1,2,1
                          2,2,1
                          3,2,1
                      etc ...
		          ...
             and  ending with
                          2,2,4
                          3,2,4
 </code></pre></div>

<p><strong>All about grid lists:</strong></p>
<p>The form of a grid.list is</p>
<p><code>list( var.name1= what1  , var.name2=what2 , ... var.nameN=what3)</code></p>
<p>Here var.names are the names of the independent variables. 
The what options describe what should be done with this variable when  
generating the grid. These should either an increasing sequence of points
or a single vaules. Obviously there should be only be two variables with 
sequences to define a grid for a surface.</p>
<p>Most of time the gridding  sequences  are equally  
spaced and are easily generated using the <code>seq</code> function. Also throughout fields
the grid points are typically the midpoints of the grid rather the grid box
boundaries. However, these functions can handle unequally spaced grids and the
logical boundary.grid can indicate a grid being the box boundaries.</p>
<p>The variables in the list components are assumed  
to be in the same order as they appear in the data matrix.</p>
<p>A useful function that expands the grid from the grid.list description into 
a full set of locations is <code>make.surface.grid</code> and  is 
just a wrapper around the R base function <code>expand.grid</code>. A typical operation is to go from a grid.list to the set of grid locations. Evaluate a
fucntion at these lcoations and then reformat this as an image for plotting. 
Here is how to do this cleanly:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="va">grid.list</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">xg</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/grid.list.html">make.surface.grid</a></span><span class="op">(</span><span class="va">grid.list</span><span class="op">)</span></span>
<span><span class="co"># look at a surface dependin on xg locations</span></span>
<span><span class="va">z</span><span class="op">&lt;-</span> <span class="va">xg</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">xg</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">out</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">grid.list</span><span class="op">$</span><span class="va">x</span>, y<span class="op">=</span> <span class="va">grid.list</span><span class="op">$</span><span class="va">y</span>, z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="va">z</span>, nrow<span class="op">=</span><span class="fl">10</span>, ncol<span class="op">=</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># now for example</span></span>
<span><span class="fu"><a href="../reference/image.plot.html">image.plot</a></span><span class="op">(</span> <span class="va">out</span><span class="op">)</span></span></code></pre></div>

<p>The key here is that <code>xg</code> and <code>matrix</code> both  organize the grid in the 
same order.</p>
<p>Some fields internal functions that support interpreting grid list format are:</p>
<p><code>fields.x.to.grid</code>: 
 Takes an "x" matrix of locations or independent variables and creates a
reasonable grid list. This is used to evaluate predicted surfaces when a
grid list is not explicited given to predictSurface. The variables
(i.e. columns of x) that are not part of the grid are set to the median
values.  The x grid values are <code>nx</code> equally spaced points in the
range <code>x[, xy[1]]</code>. The y grid values are <code>ny</code> equally spaced
points in the range <code>x[, xy[2]]</code>.</p>

<p><code>parse.grid.list</code>:
 Takes a grid list and returns the information in a more expanded list
form that is easy to use. This is used, for example, by predictSurface
to figure out what to do!</p>

<p><code>fields.convert.grid</code>:
 Takes a vector of n values assumed to be midpoints of a grid and 
returns the n+1 boundaries. See how this is used in discretize.image 
with the cut function. This function will handle unequally spaced
grid values.</p>
<p><code>discretize.image</code>: Takes a vector of locations and a 2-d grid and
figures out to which boxes they belong. The output matrix ind has the
grid locations. If boundary.grid is FALSE then the grid list (grid) is
assumed to be grid midpoints. The grid boundaries are taken to be the
point half way between these midpoints. The first and last boundaries
points are determined by extrapolating so that the first and last box
has the midpoint in its center. (See the code in fields.convert.grid for
details.) If grid is NULL then midpoints are found from m and n and the
range of the x matrix.</p>
<p><code>unrollZGrid</code> Checks that the ZGrid object is compatible with th e grid.list and concatenates the grid arrays into vectors. This version of the covariates are used the usual predict function.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>as.surface, predictSurface, plot.surface, surface, 
expand.grid, as.image</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Given below are some examples of grid.list objects and the results  </span></span></span>
<span class="r-in"><span><span class="co">#when they are used with make.surface.grid. Note that  </span></span></span>
<span class="r-in"><span><span class="co">#make.surface.grid returns a matrix that retains the grid.list  </span></span></span>
<span class="r-in"><span><span class="co">#information as an attribute. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">grid.l</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu">make.surface.grid</span><span class="op">(</span><span class="va">grid.l</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    2    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    3    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    1    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    2    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    3    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"grid.list")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"grid.list")[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"grid.list")[[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 3 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="va">grid.l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu">make.surface.grid</span><span class="op">(</span><span class="va">grid.l</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1   10    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    2   10    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    3   10    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1   10    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    2   10    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    3   10    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1   10    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    2   10    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    3   10    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"grid.list")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"grid.list")[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"grid.list")[[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"grid.list")[[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#The next  example shows how the grid.list can be used to  </span></span></span>
<span class="r-in"><span><span class="co">#control surface plotting and evaluation of an estimated function. </span></span></span>
<span class="r-in"><span><span class="co"># first create a test function  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span> <span class="fl">124</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span> <span class="va">X</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>   </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit an  interpolating thin plate spline  </span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">&lt;-</span> <span class="fu"><a href="Tps.html">Tps</a></span><span class="op">(</span> <span class="va">X</span>,<span class="va">y</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Warning: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grid searches over lambda (nugget and sill variances) with  minima at the endpoints: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (GCV) Generalized Cross-Validation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    minimum at  right endpoint  lambda  =  0.0005215037 (eff. df= 28.49999 )</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">grid.l</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> X1<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">1</span>,,<span class="fl">20</span><span class="op">)</span>, X2<span class="op">=</span><span class="fl">.5</span>, X3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,,<span class="fl">25</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span> <span class="va">out</span>, grid.list<span class="op">=</span><span class="va">grid.l</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="grid.list-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#  surface plot based on a 20X25 grid in X1 an X3  </span></span></span>
<span class="r-in"><span><span class="co">#                       over the square [0,2] and [0,2]   </span></span></span>
<span class="r-in"><span><span class="co">#                       holding X2 equal to 1.0. </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test of discretize to make sure points on boundaries are counted right</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>, <span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">look</span><span class="op">&lt;-</span> <span class="fu">discretize.image</span><span class="op">(</span> <span class="va">x</span>, m<span class="op">=</span><span class="fl">2</span>,n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xc</span><span class="op">&lt;-</span> <span class="va">xc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">yc</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yc</span><span class="op">&lt;-</span> <span class="va">yc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">grid</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span> <span class="va">xc</span>, y<span class="op">=</span> <span class="va">yc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">look2</span><span class="op">&lt;-</span> <span class="fu">discretize.image</span><span class="op">(</span> <span class="va">x</span>, m<span class="op">=</span><span class="fl">2</span>,n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span> <span class="va">look</span><span class="op">$</span><span class="va">index</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       index2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> index1  1  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1 25 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2 25 22</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span> <span class="va">look2</span><span class="op">$</span><span class="va">index</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       index2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> index1  1  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1 25 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2 25 22</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># indicator image of discretized locations</span></span></span>
<span class="r-in"><span><span class="va">look</span><span class="op">&lt;-</span> <span class="fu">discretize.image</span><span class="op">(</span> <span class="va">RMprecip</span><span class="op">$</span><span class="va">x</span>, m<span class="op">=</span><span class="fl">15</span>, n<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="image.plot.html">image.plot</a></span><span class="op">(</span> <span class="va">look</span><span class="op">$</span><span class="va">grid</span><span class="op">$</span><span class="va">x</span>, <span class="va">look</span><span class="op">$</span><span class="va">grid</span><span class="op">$</span><span class="va">y</span>,<span class="va">look</span><span class="op">$</span><span class="va">hist</span> <span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="co"># actual locations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">RMprecip</span><span class="op">$</span><span class="va">x</span>,col<span class="op">=</span><span class="st">"magenta"</span>, pch<span class="op">=</span><span class="st">"."</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="grid.list-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

