<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Finds profile likelihood and GCV estimates of 
smoothing parameters for splines and Kriging. — KrigFindLambda • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Finds profile likelihood and GCV estimates of 
smoothing parameters for splines and Kriging. — KrigFindLambda"><meta property="og:description" content="This is a secondary function that will use the computed Krig object and
find various estimates of the smoothing parameter lambda. These are
several different flavors of cross-validation, a moment matching
strategy and the profile likelihood.  This function can also be used
independently with different data sets (the y's) if the covariates ( the
x's) are the same and thus reduce the computation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Finds profile likelihood and GCV estimates of 
smoothing parameters for splines and Kriging.</h1>
    
    <div class="hidden name"><code>KrigFindLambda.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is a secondary function that will use the computed Krig object and
find various estimates of the smoothing parameter lambda. These are
several different flavors of cross-validation, a moment matching
strategy and the profile likelihood.  This function can also be used
independently with different data sets (the y's) if the covariates ( the
x's) are the same and thus reduce the computation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">KrigFindLambda</span><span class="op">(</span></span>
<span><span class="va">out</span>, lambda.grid <span class="op">=</span> <span class="cn">NA</span>, cost <span class="op">=</span> <span class="fl">1</span>, nstep.cv <span class="op">=</span> <span class="fl">200</span>, rmse</span>
<span>                 <span class="op">=</span> <span class="cn">NA</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, tol <span class="op">=</span> <span class="fl">1e-05</span>, offset <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span></span>
<span>                 <span class="cn">NULL</span>, give.warnings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gcv.sreg</span> <span class="op">(</span></span>
<span><span class="va">out</span>, lambda.grid <span class="op">=</span> <span class="cn">NA</span>, cost <span class="op">=</span> <span class="fl">1</span>, nstep.cv <span class="op">=</span> <span class="fl">80</span>, rmse <span class="op">=</span></span>
<span>                 <span class="cn">NA</span>, offset <span class="op">=</span> <span class="fl">0</span>, trmin <span class="op">=</span> <span class="cn">NA</span>, trmax <span class="op">=</span> <span class="cn">NA</span>, verbose <span class="op">=</span></span>
<span>                 <span class="cn">FALSE</span>, tol <span class="op">=</span> <span class="fl">1e-05</span>, give.warnings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>out</dt>
<dd><p>A Krig or sreg object.</p></dd>

  <dt>lambda.grid</dt>
<dd><p>Grid of lambdas for coarse search. The default is 
equally spaced on effective degree of freedom scale.</p></dd>

  <dt>cost</dt>
<dd><p>Cost used in GCV denominator</p></dd>

  <dt>nstep.cv</dt>
<dd><p>Number of grid points in coarse search.</p></dd>

  <dt>rmse</dt>
<dd><p>Target root mean squared error to match with 
                  the estimate of tau**2</p></dd>

  <dt>verbose</dt>
<dd><p>If true prints intermediate results.</p></dd>

  <dt>tol</dt>
<dd><p>Tolerance in delcaring convergence of golden section search or bisection search.</p></dd>

  <dt>offset</dt>
<dd><p>Additional degrees of freedom to be added into the GCV denominator.</p></dd>

  <dt>y</dt>
<dd><p>A new data vector to be used in place of the one associated with the
Krig object (obj)</p></dd>

  <dt>give.warnings</dt>
<dd><p>If FALSE will suppress warnings about grid search being out of 
range for various estimates based on GCV and REML.</p></dd>

 
<dt>trmin</dt>
<dd><p>Minimum value of lambda for grid search specified in terms
of effective degrees of freedom.</p></dd>

<dt>trmax</dt>
<dd><p>Maximum value for grid search.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>This function finds several estimates of the smoothing parameter using
first a coarse grid search followed by a refinement using a minimization (
in the case of GCV or maximum likelihood) or bisection in the case of
mathcing the rmse. Details of the estimators can be found in the help file
for the Krig function.</p>
<p>The Krig object passed to this function has some matrix decompostions that
facilitate rapid computation of the GCV and ML functions and do not depend
on the independent variable. This makes it possible to compute the Krig
object once and to reuse the decompostions for multiple data sets. (But
keep in mind if the x values change then the object must be recalculated.)
The example below show show this can be used for a simulation study on the
variability for estimating the smoothing parameter.</p>


    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list giving a summary of estimates and diagonostic details with the 
following components:</p>
<dl><dt>gcv.grid </dt>
<dd><p>A matrix describing results of the 
coarse search rows are values of lambda and the columns are 
lambda= value of smoothing parameter, 
trA=effective degrees of freedom, 
GCV=Usual GCV criterion, 
GCV.one=GCV criterion leave-one-out, 
GCV.model= GCV based on average response in the case of replicates, 
tauHat= Implied estimate of tau ,
-Log Profile= negative log of profiel likelihood for the lambda.</p></dd>

  <dt>lambda.est</dt>
<dd><p>Summary table of all estimates
Rows index different types of estimates: 
GCV, GCV.model, GCV.one, RMSE, pure error, -Log Profile
and the columns are the estimated values  for lambda, trA, GCV, tauHat.</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Doug Nychka</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="Krig.html">Krig</a></code>,
<code><a href="Tps.html">Tps</a></code>,
<code><a href="predict.Krig.html">predict.Krig</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="fu"><a href="Tps.html">Tps</a></span><span class="op">(</span> <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span>, <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">obj</span> <span class="co"># default is to find lambda by GCV</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CALL:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tps(x = ChicagoO3$x, Y = ChicagoO3$y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of Observations:                20     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of unique points:               20     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of parameters in the null space 3      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters for fixed spatial drift     3      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Effective degrees of freedom:          4.5    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residual degrees of freedom:           15.5   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MLE tau                                3.779  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  GCV tau                                4.073  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MLE sigma                              347.7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Scale passed for covariance (sigma)    &lt;NA&gt;   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Scale passed for nugget (tau^2)        &lt;NA&gt;   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Smoothing parameter lambda             0.04107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Summary:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     min   1st Q  median   3rd Q     max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -6.8060 -1.4390 -0.5064  1.4440  7.7890 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariance Model: Rad.cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Names of non-default covariance arguments: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DETAILS ON SMOOTHING PARAMETER:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method used:   GCV    Cost:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lambda       trA       GCV   GCV.one GCV.model    tauHat </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.04107   4.50304  21.40938  21.40938        NA   4.07296 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of all estimates found for lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             lambda   trA   GCV tauHat -lnLike Prof converge</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV        0.04107 4.503 21.41  4.073        49.00        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.model       NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.one    0.04107 4.503 21.41  4.073           NA        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE            NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pure error      NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML       0.02972 4.886 21.49  4.030        48.98        4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">KrigFindLambda</span><span class="op">(</span> <span class="va">obj</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">out</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">out</span><span class="op">$</span><span class="va">lambda.est</span><span class="op">)</span> <span class="co"># results agree with Tps summary</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                lambda      trA      GCV   tauHat -lnLike Prof converge</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV        0.04107313 4.503038 21.40938 4.072962     49.00042        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.model          NA       NA       NA       NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.one    0.04107313 4.503038 21.40938 4.072962           NA        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE               NA       NA       NA       NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pure error         NA       NA       NA       NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML       0.02971891 4.886273 21.48837 4.029698     48.98323        4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="sreg.html">sreg</a></span><span class="op">(</span> <span class="va">rat.diet</span><span class="op">$</span><span class="va">t</span>, <span class="va">rat.diet</span><span class="op">$</span><span class="va">trt</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">out</span></span></span>
<span class="r-in"><span><span class="fu">gcv.sreg</span><span class="op">(</span> <span class="va">out</span>, tol<span class="op">=</span><span class="fl">1e-10</span><span class="op">)</span> <span class="co"># higher tolerance search for minimum </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gcv.grid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lambda       trA       GCV   GCV.one GCV.model    tauHat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  8.183514e-04 37.049991  8.075493  8.075493        NA 0.6354341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1.028159e-03 36.645399  8.050161  8.050161        NA 0.6971539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1.291758e-03 36.177994  8.017769  8.017769        NA 0.7616816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1.622937e-03 35.645737  7.976059  7.976059        NA 0.8282481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2.039024e-03 35.048882  7.922064  7.922064        NA 0.8958739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2.561787e-03 34.390175  7.852044  7.852044        NA 0.9633881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  3.218575e-03 33.674681  7.761566  7.761566        NA 1.0294736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  4.043749e-03 32.909227  7.645807  7.645807        NA 1.0927368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  5.080481e-03 32.101546  7.500139  7.500139        NA 1.1518031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 6.383009e-03 31.259303  7.320957  7.320957        NA 1.2054290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 8.019478e-03 30.389253  7.106600  7.106600        NA 1.2526192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1.007550e-02 29.496749  6.858138  6.858138        NA 1.2927272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1.265865e-02 28.585697  6.579728  6.579728        NA 1.3255215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 1.590406e-02 27.658936  6.278397  6.278397        NA 1.3511980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 1.998152e-02 26.718887  5.963220  5.963220        NA 1.3703358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2.510436e-02 25.768238  5.644109  5.644109        NA 1.3838029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 3.154059e-02 24.810474  5.330515  5.330515        NA 1.3926315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 3.962693e-02 23.850097  5.030364  5.030364        NA 1.3978879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 4.978644e-02 22.892527  4.749417  4.749417        NA 1.4005594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 6.255063e-02 21.943732  4.491090  4.491090        NA 1.4014757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 7.858729e-02 21.009719  4.256659  4.256659        NA 1.4012676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 9.873541e-02 20.096021  4.045690  4.045690        NA 1.4003629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 1.240491e-01 19.207263  3.856567  3.856567        NA 1.3990108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 1.558526e-01 18.346901  3.687000  3.687000        NA 1.3973233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 1.958100e-01 17.517133  3.534459  3.534459        NA 1.3953247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 2.460115e-01 16.718988  3.396497  3.396497        NA 1.3929989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 3.090837e-01 15.952539  3.270965  3.270965        NA 1.3903276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 3.883262e-01 15.217195  3.156109  3.156109        NA 1.3873155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 4.878848e-01 14.511992  3.050601  3.050601        NA 1.3840034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 6.129682e-01 13.835842  2.953499  2.953499        NA 1.3804710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 7.701203e-01 13.187710  2.864191  2.864191        NA 1.3768351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 9.675628e-01 12.566692  2.782335  2.782335        NA 1.3732454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 1.215625e+00 11.972029  2.707798  2.707798        NA 1.3698802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 1.527286e+00 11.403079  2.640610  2.640610        NA 1.3669421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 1.918850e+00 10.859261  2.580903  2.580903        NA 1.3646500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 2.410803e+00 10.340010  2.528864  2.528864        NA 1.3632278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 3.028882e+00  9.844737  2.484663  2.484663        NA 1.3628873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 3.805423e+00  9.372811  2.448394  2.448394        NA 1.3638090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 4.781053e+00  8.923550  2.420010  2.420010        NA 1.3661223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 6.006814e+00  8.496230  2.399287  2.399287        NA 1.3698897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 7.546834e+00  8.090092  2.385799  2.385799        NA 1.3750976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 9.481682e+00  7.704359  2.378923  2.378923        NA 1.3816557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 1.191259e+01  7.338243  2.377862  2.377862        NA 1.3894041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 1.496672e+01  6.990946  2.381688  2.381688        NA 1.3981267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 1.880387e+01  6.661671  2.389389  2.389389        NA 1.4075698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 2.362479e+01  6.349617  2.399931  2.399931        NA 1.4174613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 2.968168e+01  6.053988  2.412314  2.412314        NA 1.4275325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 3.729144e+01  5.774001  2.425636  2.425636        NA 1.4375387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 4.685218e+01  5.508892  2.439160  2.439160        NA 1.4472801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 5.886408e+01  5.257928  2.452380  2.452380        NA 1.4566240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 7.395559e+01  5.020415  2.465096  2.465096        NA 1.4655265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52 9.291624e+01  4.795705  2.477490  2.477490        NA 1.4740559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 1.167380e+02  4.583193  2.490207  2.490207        NA 1.4824182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54 1.466672e+02  4.382320  2.504464  2.504464        NA 1.4909878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55 1.842695e+02  4.192570  2.522173  2.522173        NA 1.5003448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56 2.315123e+02  4.013463  2.546106  2.546106        NA 1.5113200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57 2.908672e+02  3.844543  2.580099  2.580099        NA 1.5250435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58 3.654394e+02  3.685346  2.629251  2.629251        NA 1.5429833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59 4.591303e+02  3.535377  2.700100  2.700100        NA 1.5669507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60 5.768417e+02  3.394090  2.800645  2.800645        NA 1.5990342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61 7.247317e+02  3.260896  2.940108  2.940108        NA 1.6414254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62 9.105376e+02  3.135210  3.128290  3.128290        NA 1.6961152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63 1.143980e+03  3.016522  3.374422  3.374422        NA 1.7644891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64 1.437273e+03  2.904481  3.685565  3.685565        NA 1.8469127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65 1.805759e+03  2.798959  4.064815  4.064815        NA 1.9424445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66 2.268717e+03  2.700060  4.509777  4.509777        NA 2.0487936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67 2.850368e+03  2.608079  5.011838  5.011838        NA 2.1625627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68 3.581143e+03  2.523411  5.556621  5.556621        NA 2.2797131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69 4.499272e+03  2.446432  6.125644  6.125644        NA 2.3961195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70 5.652790e+03  2.377396  6.698779  6.698779        NA 2.5080728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71 7.102046e+03  2.316354  7.256855  7.256855        NA 2.6126316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72 8.922860e+03  2.263129  7.783785  7.783785        NA 2.7077851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73 1.121049e+04  2.217331  8.267813  8.267813        NA 2.7924451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74 1.408463e+04  2.178399  8.701848  8.701848        NA 2.8663206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75 1.769563e+04  2.145660  9.083044  9.083044        NA 2.9297309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76 2.223241e+04  2.118387  9.411967  9.411967        NA 2.9834094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77 2.793233e+04  2.095851  9.691596  9.691596        NA 3.0283282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78 3.509359e+04  2.077357  9.926394  9.926394        NA 3.0655601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79 4.409085e+04  2.062267 10.121545 10.121545        NA 3.0961801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80 5.539481e+04  2.050011 10.282391 10.282391        NA 3.1212022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              lambda     trA      GCV   tauHat converge</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV        11.10732 7.44848 2.377623 1.386913       16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.model        NA      NA       NA       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.one    11.10732 7.44848 2.377623 1.386913       16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE             NA      NA       NA       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pure error       NA      NA       NA       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $warningTable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Warning Refine indexMIN leftEndpoint rightEndpoint   lambda    effdf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV          FALSE   TRUE       43        FALSE         FALSE 11.91259 7.338243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.model    FALSE  FALSE       NA           NA            NA       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.one      FALSE   TRUE       43        FALSE         FALSE 11.91259 7.338243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE         FALSE  FALSE       NA           NA            NA       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pure error   FALSE  FALSE       NA           NA            NA       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># a simulation example</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">1</span>,,<span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span><span class="op">&lt;-</span>  <span class="va">x</span><span class="op">**</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span> <span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span><span class="op">&lt;-</span> <span class="va">f</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span> <span class="va">f</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># let's all use the same seed</span></span></span>
<span class="r-in"><span><span class="va">tau</span><span class="op">&lt;-</span> <span class="fl">.1</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span> <span class="va">f</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="fl">150</span><span class="op">)</span><span class="op">*</span><span class="va">tau</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="Tps.html">Tps</a></span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">obj</span> <span class="co"># create Krig object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hold</span><span class="op">&lt;-</span> <span class="va">hold2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="cn">NA</span>, ncol<span class="op">=</span><span class="fl">6</span>, nrow<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># look at GCV estimates of lambda</span></span></span>
<span class="r-in"><span><span class="co"># new data simulated</span></span></span>
<span class="r-in"><span>   <span class="va">y</span><span class="op">&lt;-</span> <span class="va">f</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span><span class="op">*</span><span class="va">tau</span> </span></span>
<span class="r-in"><span><span class="co"># save GCV estimates</span></span></span>
<span class="r-in"><span><span class="va">lambdaTable</span><span class="op">&lt;-</span> <span class="fu">KrigFindLambda</span><span class="op">(</span><span class="va">obj</span>,  y<span class="op">=</span><span class="va">y</span>, give.warnings<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">lambda.est</span></span></span>
<span class="r-in"><span><span class="va">hold</span><span class="op">[</span><span class="va">k</span>,<span class="op">]</span><span class="op">&lt;-</span>  <span class="va">lambdaTable</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">hold2</span><span class="op">[</span><span class="va">k</span>,<span class="op">]</span><span class="op">&lt;-</span>  <span class="va">lambdaTable</span><span class="op">[</span><span class="fl">6</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">hold</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">hold2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">hold</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>,<span class="va">hold2</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> xlab<span class="op">=</span><span class="st">"estimated eff. df"</span>, ylab<span class="op">=</span><span class="st">"tau hat"</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange3"</span>, <span class="st">"green2"</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="yline.html">yline</a></span><span class="op">(</span> <span class="va">tau</span>, col<span class="op">=</span><span class="st">"grey"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

