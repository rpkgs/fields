<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Wendland family of covariance functions and supporting 
numerical functions — Wendland • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Wendland family of covariance functions and supporting 
numerical functions — Wendland"><meta property="og:description" content="Computes the compactly supported, stationatry Wendland covariance
function as a function ofdistance. This family is useful for creating
sparse covariance matrices."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wendland family of covariance functions and supporting 
numerical functions</h1>
    
    <div class="hidden name"><code>Wendland.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the compactly supported, stationatry Wendland covariance
function as a function ofdistance. This family is useful for creating
sparse covariance matrices.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code>Wendland(d, aRange = 1, dimension, k,derivative=0, phi=NA, theta=NULL)

Wendland2.2(d, aRange=1, theta=NULL)
Wendland.beta(n,k)
wendland.eval(r, n, k, derivative = 0)
fields.pochup(q, k)
fields.pochdown(q, k)
fields.D(f,name,order = 1)

&lt;!-- %Wendland.father(x, aRange = 1, dimension = 1, k=3)  --&gt;
&lt;!-- %Wendland.mother(x, aRange = 1, dimension = 1, k=3)  --&gt;
&lt;!-- %wendland.basis(x1, x2, aRange = 1, V=NULL, --&gt;
&lt;!-- %    k = 3, C = NA, Dist.args = list(method = "euclidean"),  --&gt;
&lt;!-- %    spam.format = TRUE, verbose = FALSE, flavor=0) --&gt;</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>d</dt>
<dd><p>Distances between locations. Or for wendland.coef the dimension of
the locations.</p></dd>

<dt>aRange</dt>
<dd><p>Scale for distances. This is the same as the
range parameter.</p></dd>

<dt>theta</dt>
<dd><p>Same as aRange.</p></dd>

<dt>dimension</dt>
<dd><p>Dimension of the locations</p></dd>

<dt>n</dt>
<dd><p>Dimension for computing Wendland polynomial coefficients</p></dd>

<dt>k</dt>
<dd><p>Order of covariance function.</p></dd>

<dt>derivative</dt>
<dd><p>Indicates derivative of covariance function</p></dd>

<dt>phi</dt>
<dd><p>Depreciated argument will give stop if not an NA.
 (Formerly the scale factor to multiply the function. Equivalent to the
marginal variance or sill if viewed as a covariance function.)</p></dd>

<dt>r</dt>
<dd><p>Real value in [0,1] to evaluate Wendland function.</p></dd>

<dt>q</dt>
<dd><p>Order of Pochhammer symbol</p></dd>

<dt>f</dt>
<dd><p>Numerical expression to differentiate.</p></dd>

<dt>name</dt>
<dd><p>Variable with which to take derivative.</p></dd>

<dt>order</dt>
<dd><p>Order of derivative.</p></dd>


</dl><p><!-- %\item{x}{Argument for one dimensional basis function} --></p>


<p><!-- %\item{x1}{Two dimensional locations to evaluate the basis functions} --></p>


<p><!-- %\item{x2}{Two dimensional centers that define the basis} --></p>


<p><!-- %\item{C}{Vector or matrix of coefficients to multiply with basis functions} --></p>


<p><!-- %\item{Dist.args}{Arguments to distance function} --></p>


<p><!-- %\item{V}{See explantion in help for \code{Exp.cov}} --></p>


<p><!-- %\item{spam.format}{If TRUE return result in sparse format} --></p>


<p><!-- %\item{verbose}{If TRUE prints out intermediate steps for debugging.} --></p>


<p><!-- %\item{flavor}{Takes values 0:3. Controls type of tensor product: --></p>


<p><!-- %father*father=0, father*mother =1, mother*father = 2, mother*mother =3 } --></p>



    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This is the basic function applied to distances and called by the
<code>wendland.cov</code> function. It can also be used as the Covariance or 
Taper specifications in the more general 
stationary.cov and station.taper.cov functions.
The proofs and construction of the Wendland family of positive definite functions can be found in the work of Wendland(1995).
( H. Wendland. Piecewise polynomial , positive definite and compactly supported radial functions of minimal degree. AICM 4(1995), pp 389-396.)</p>
<p>The Wendland covariance function is a positive 
polynomial on [0,aRange] and zero beyond aRange. It is further normalized in these fields functions to be 1 at 0. The parameter <code>k</code> detemines the smoothness of the covariance at zero. The additional parameter <code>n</code> or <code>dimension</code> is needed because the property of 
positive definitness for radial functions depends on the dimension being considered.</p>
<p>The polynomial terms of the Wenland function.
 are computed recursively based on the values of <code>k</code>
and <code>dimension</code> in the function <code>wendland.eval</code>. The matrix of
coefficients found by <code>Wendland.beta</code> is used to weight each polynomial term and follows Wendland's original construction of these functions. The recursive definition of the Wendland coefficients depends on Pochhammer symbols akin to binomial coefficients:</p>
<p><code>fields.pochup(q, k)</code>
calculates the Pochhammer symbol for rising factorial q(q+1)(q+2)...(q+k-1)</p>
<p>and</p>
<p><code>fields.pochdown(q, k)</code>
calculates the Pochhammer symbol for falling factorial q(q-1)(q-2)...(q-k+1).</p>
<p>Derivatives are found symbolically using  a recursive modification of the base function <code>D</code> (<code>fields.D</code>) and then evaluated numerically based on the polynomial form.</p>

<p>A specific example of the Wendland family is <code>Wendland2.2</code> (k=2, dimension=2). This is included mainly for testing but the explicit formula may also be enlightening.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A vector of the covariances or its derivative.</p>


    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Doug Nychka, Ling Shen</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>wendland.cov, stationary.taper.cov</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dt</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">1.5</span>,, <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span> <span class="fu">Wendland</span><span class="op">(</span> <span class="va">dt</span>, k<span class="op">=</span><span class="fl">2</span>, dimension<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">dt</span>, <span class="va">y</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># should agree with </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y.test</span><span class="op">&lt;-</span> <span class="fu">Wendland2.2</span><span class="op">(</span> <span class="va">dt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">dt</span>, <span class="va">y.test</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Wendland-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># second derivative</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">dt</span>, <span class="fu">Wendland</span><span class="op">(</span> <span class="va">dt</span>, k<span class="op">=</span><span class="fl">4</span>, dimension<span class="op">=</span><span class="fl">2</span>, derivative<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Wendland-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a radial basis function using the Wendland  the  "knot" is at (.25,.25)</span></span></span>
<span class="r-in"><span><span class="va">gl</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,,<span class="fl">60</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,,<span class="fl">60</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bigD</span><span class="op">&lt;-</span> <span class="fu"><a href="rdist.html">rdist</a></span><span class="op">(</span> <span class="fu"><a href="grid.list.html">make.surface.grid</a></span><span class="op">(</span> <span class="va">gl</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.25</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RBF</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">Wendland</span><span class="op">(</span> <span class="va">bigD</span>, k<span class="op">=</span><span class="fl">2</span>, dimension<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">60</span>,<span class="fl">60</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># perspective with some useful settings for shading.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/persp.html" class="external-link">persp</a></span><span class="op">(</span> <span class="va">gl</span><span class="op">$</span><span class="va">x</span>, <span class="va">gl</span><span class="op">$</span><span class="va">y</span>, <span class="va">RBF</span>, theta <span class="op">=</span><span class="fl">30</span>, phi<span class="op">=</span><span class="fl">20</span>, shade<span class="op">=</span><span class="fl">.3</span>, border<span class="op">=</span><span class="cn">NA</span>, col<span class="op">=</span><span class="st">"grey90"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Wendland-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

