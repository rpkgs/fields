<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Covariance functions — Exponential, Matern, Radial Basis • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Covariance functions — Exponential, Matern, Radial Basis"><meta property="og:description" content="Functional form of covariance function assuming the argument is a
distance between locations.  As they are defined here, they are in 
fact correlation functions.  To set the marginal variance (sill) 
parameter, use the sigma argument in mKrig or Krig.  
To set the nugget variance, use te tau2 argument in 
mKrig or Krig."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Covariance functions</h1>
    
    <div class="hidden name"><code>Exponential.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functional form of covariance function assuming the argument is a
distance between locations.  As they are defined here, they are in 
fact correlation functions.  To set the marginal variance (sill) 
parameter, use the <code>sigma</code> argument in <code>mKrig</code> or <code>Krig</code>.  
To set the nugget variance, use te <code>tau2</code> argument in 
<code>mKrig</code> or <code>Krig</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Exponential</span><span class="op">(</span><span class="va">d</span>, range <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">range</span>, phi<span class="op">=</span><span class="fl">1.0</span>,theta <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">Matern</span><span class="op">(</span><span class="va">d</span> , range <span class="op">=</span> <span class="fl">1</span>,alpha<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">range</span>, smoothness <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>       nu<span class="op">=</span> <span class="va">smoothness</span>, phi<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span> </span>
<span><span class="fu">Matern.cor.to.range</span><span class="op">(</span><span class="va">d</span>, <span class="va">nu</span>, cor.target<span class="op">=</span><span class="fl">.5</span>, guess<span class="op">=</span><span class="cn">NULL</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">RadialBasis</span><span class="op">(</span><span class="va">d</span>,<span class="va">M</span>,<span class="va">dimension</span>, derivative <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>d</dt>
<dd><p>Vector of distances or for <code>Matern.cor.to.range</code> just a single distance.</p></dd>


  <dt>range</dt>
<dd><p>Range parameter default is one. Note 
       that the scale can also be specified  through the "aRange" 
           scaling argument  used in fields covariance functions)</p></dd>


  <dt>alpha</dt>
<dd><p>1/range</p></dd>

  <dt>theta</dt>
<dd><p>Same as alpha</p></dd>

  
  <dt>phi</dt>
<dd><p>This parameter option is added to be compatible with older
  versions of fields and refers to the marginal variance of the process.
  e.g. <code>phi* exp( -d/aRange)</code> is the exponential covariance for points
  separated by distance and range aRange. Throughout fields this parameter
  is equivalent to sigma and it recommended that sigma be used. If one is
  simulating random fields. See the help on <code><a href="sim.rf.html">sim.rf</a></code> for
  more details.</p></dd>
 

  <dt>smoothness</dt>
<dd><p>Smoothness parameter in Matern. Controls the number
of derivatives in the process. Default is 1/2 corresponding to an exponential 
covariance.</p></dd>


  <dt>nu</dt>
<dd><p>Same as smoothness</p></dd>

  <dt>M</dt>
<dd><p>Interpreted as a spline M is the order of the derivatives in the
    penalty.</p></dd>

  <dt>dimension</dt>
<dd><p>Dimension of function</p></dd>
 
   <dt>cor.target</dt>
<dd><p>Correlation used to match the range parameter. Default is .5.</p></dd>

   <dt>guess</dt>
<dd><p>An optional starting guess for solution. This should not be needed.</p></dd>

   <dt>derivative</dt>
<dd><p>If greater than zero finds the first derivative of this function.</p></dd>

   <dt>...</dt>
<dd><p>Additional arguments to pass to the bisection search function.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Exponential:</p>
<p>exp( -d/range)</p>
<p>Matern:</p>
<p>con*(d**nu) * besselK(d , nu )</p>
<p>Matern covariance function transcribed from Stein's book page 31
nu==smoothness, alpha ==  1/range</p>
<p>GeoR parameters map to kappa==smoothness and phi == range
check for negative distances</p>
<p><code>con</code> is a constant that normalizes the expression to be 1.0 when d=0.</p>
<p>Matern.cor.to.range: 
    This function is useful to find  Matern covariance parameters that are 
comparable for different smoothness parameters. Given a distance <code>d</code>, 
smoothness <code>nu</code>,  target correlation <code>cor.target</code> and
range <code>aRange</code>, this function determines numerically the value of 
aRange so that</p>
<p><code>Matern( d, range=aRange, nu=nu) == cor.target</code></p>
<p>See the example for how this might be used.</p>
<p>Radial basis functions:</p><div class="sourceCode"><pre><code>
   C.m,d  r**(2m-d)        d- odd

   C.m,d  r**(2m-d)ln(r)    d-even
</code></pre></div><p>where C.m.d is a constant based on spline theory and r is the radial distance
between points. See <code>radbas.constant</code> for the computation of the constant.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    


<p>For the covariance functions: a vector of covariances.</p>


<p>For Matern.cor.to.range: the value of the range parameter.</p>


    </div>
    <div id="references">
    <h2>References</h2>
    <p>Stein, M.L. (1999) Statistical Interpolation of Spatial Data: Some Theory for Kriging. Springer, New York.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Doug Nychka</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>stationary.cov, stationary.image.cov, Wendland,stationary.taper.cov
  rad.cov</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># a Matern correlation function </span></span></span>
<span class="r-in"><span> <span class="va">d</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="fl">10</span>,,<span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">y</span><span class="op">&lt;-</span> <span class="fu">Matern</span><span class="op">(</span> <span class="va">d</span>, range<span class="op">=</span><span class="fl">1.5</span>, smoothness<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="va">d</span>,<span class="va">y</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Exponential-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Several Materns of different smoothness with a similar correlation </span></span></span>
<span class="r-in"><span><span class="co"># range</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># find ranges for nu = .5, 1.0 and 2.0 </span></span></span>
<span class="r-in"><span><span class="co"># where the correlation drops to .1 at a distance of 10 units.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">r1</span><span class="op">&lt;-</span> <span class="fu">Matern.cor.to.range</span><span class="op">(</span> <span class="fl">10</span>, nu<span class="op">=</span><span class="fl">.5</span>, cor.target<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">r2</span><span class="op">&lt;-</span> <span class="fu">Matern.cor.to.range</span><span class="op">(</span> <span class="fl">10</span>, nu<span class="op">=</span><span class="fl">1.0</span>, cor.target<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">r3</span><span class="op">&lt;-</span> <span class="fu">Matern.cor.to.range</span><span class="op">(</span> <span class="fl">10</span>, nu<span class="op">=</span><span class="fl">2.0</span>, cor.target<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note that these equivalent ranges</span></span></span>
<span class="r-in"><span><span class="co"># with respect to this correlation length are quite different</span></span></span>
<span class="r-in"><span><span class="co"># due the different smoothness parameters. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">d</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">15</span>,,<span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>  <span class="fu">Matern</span><span class="op">(</span> <span class="va">d</span>, range<span class="op">=</span><span class="va">r1</span>, nu<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             <span class="fu">Matern</span><span class="op">(</span> <span class="va">d</span>, range<span class="op">=</span><span class="va">r2</span>, nu<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             <span class="fu">Matern</span><span class="op">(</span> <span class="va">d</span>, range<span class="op">=</span><span class="va">r3</span>, nu<span class="op">=</span><span class="fl">2.0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span> <span class="va">d</span>, <span class="va">y</span>, type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="xline.html">xline</a></span><span class="op">(</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="yline.html">yline</a></span><span class="op">(</span> <span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Exponential-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

