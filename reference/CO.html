<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Monthly surface meterology for Colorado 1895-1997 — Colorado Monthly Meteorological Data • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Monthly surface meterology for Colorado 1895-1997 — Colorado Monthly Meteorological Data"><meta property="og:description" content="

Source:
 These is a group of R data sets for monthly min/max temperatures and
precipitation over the period 1895-1997. It is a subset extracted from
the more extensive US data record.
Temperature is in degrees C and
precipitation is total monthly accumulation in millimeters. Note that
minimum (maximum) monthly tempertuare is the mean of the daily minimum
(maximum) temperatures.
Data domain: 
A rectagular lon/lat region [-109.5,-101]x [36.5,41.5] larger than the
boundary of Colorado comprises approximately 400 stations. Although
there are additional stations reported in this domain, stations that
only report preicipitation or only report temperatures have been
excluded. In addition stations that have mismatches between locations
and elevations from the two meta data files have also been excluded. The
net result is 367 stations that have colocated temperatures and
precipitation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Monthly surface meterology for Colorado 1895-1997</h1>
    
    <div class="hidden name"><code>CO.Rd</code></div>
    </div>

    <div class="ref-description">
    

<p>Source:
 These is a group of R data sets for monthly min/max temperatures and
precipitation over the period 1895-1997. It is a subset extracted from
the more extensive US data record.
Temperature is in degrees C and
precipitation is total monthly accumulation in millimeters. Note that
minimum (maximum) monthly tempertuare is the mean of the daily minimum
(maximum) temperatures.</p>
<p>Data domain:</p> 
<p>A rectagular lon/lat region [-109.5,-101]x [36.5,41.5] larger than the
boundary of Colorado comprises approximately 400 stations. Although
there are additional stations reported in this domain, stations that
only report preicipitation or only report temperatures have been
excluded. In addition stations that have mismatches between locations
and elevations from the two meta data files have also been excluded. The
net result is 367 stations that have colocated temperatures and
precipitation.</p>
    </div>


    <div id="format">
    <h2>Format</h2>
    <p>This group of data sets is organized with the following  objects:</p><dl><dt>CO.info</dt>
<dd><p>A data frame with columns: station id, elev, lon, lat, station name</p></dd>



<dt>CO.elev</dt>
<dd><p>elevation in meters</p></dd>


<dt>CO.elevGrid</dt>
<dd><p>An image object being elevation in meters on a 4 km grid covering Colorado.</p></dd>


<dt>CO.id</dt>
<dd><p>alphanumeric station id codes</p></dd>


<dt>CO.loc</dt>
<dd><p>locations in lon/lat</p></dd>


<dt>CO.Grid</dt>
<dd><p>Just the grid.list used in the CO.elevGrid.</p></dd>


<dt>CO.ppt CO.tmax CO.tmin</dt>
<dd><p>Monthly means as three dimensional arrays ( Year, Month, Station).
Temperature is in degrees C and precipitation in total monthly
accumulation in millimeters.</p></dd>


<dt>CO.ppt.MAM CO.tmax.MAM CO.tmin.MAM</dt>
<dd><p>Spring seasonal means 
(March, April,May) as two dimensional arrays
   (Year, Station).</p></dd>


 <dt>CO.MAM.ppt.climate CO.MAM.tmax.climate CO.MAM.tmin.climate</dt>
<dd><p>Spring seasonal means 
(March, April,May) means by station for the period 1960-1990. If less than 15 years are present over this period an NA is recorded. 
No detreding or other adjustments have been made for these mean estimates.</p></dd>


</dl></div>
    <div id="creation-of-data-subset">
    <h2>Creation of data subset</h2>
    <p>Here is the precise R script used to create this data subset from the 
larger US monthly data set. This parent, R binary file can be obtained
by contacting Doug Nychka (nychka@mines.edu).</p>
<p>These technical details are not needed for casual use of the data -- 
skip down to examples for some R code that summarizes these data.</p> 
<div class="sourceCode"><pre><code><span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="st">"RData.USmonthlyMet.bin"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#To find a subset that covers Colorado (with a bit extra):</span></span>
<span></span>
<span></span>
<span><span class="va">indt</span><span class="op">&lt;-</span> <span class="va">UStinfo</span><span class="op">$</span><span class="va">lon</span><span class="op">&lt;</span> <span class="op">-</span><span class="fl">101</span> <span class="op">&amp;</span>  <span class="va">UStinfo</span><span class="op">$</span><span class="va">lon</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">109.5</span></span>
<span><span class="va">indt</span><span class="op">&lt;-</span> <span class="va">indt</span> <span class="op">&amp;</span> <span class="va">UStinfo</span><span class="op">$</span><span class="va">lat</span><span class="op">&lt;</span><span class="fl">41.5</span> <span class="op">&amp;</span>  <span class="va">UStinfo</span><span class="op">$</span><span class="va">lat</span><span class="op">&gt;</span><span class="fl">36.5</span></span>
<span></span>
<span><span class="co"># check  US(); points( UStinfo[indt,3:4])</span></span>
<span></span>
<span><span class="co">#find common names restricting choices to the temperature names</span></span>
<span><span class="va">tn</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span>  <span class="va">UStinfo</span><span class="op">$</span><span class="va">station.id</span>, <span class="va">USpinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">)</span></span>
<span><span class="va">indt</span><span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tn</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">indt</span></span>
<span></span>
<span><span class="co"># compare  metadata locations and elevations. </span></span>
<span><span class="co"># initial matches to precip stations</span></span>
<span><span class="va">CO.id</span><span class="op">&lt;-</span> <span class="va">UStinfo</span><span class="op">[</span><span class="va">indt</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">CO.names</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">UStinfo</span><span class="op">[</span><span class="va">indt</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pn</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span>  <span class="va">CO.id</span>, <span class="va">USpinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loc1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">UStinfo</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">indt</span><span class="op">]</span>, <span class="va">UStinfo</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">indt</span><span class="op">]</span>, <span class="va">UStinfo</span><span class="op">$</span><span class="va">elev</span><span class="op">[</span><span class="va">indt</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">loc2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">USpinfo</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">pn</span><span class="op">]</span>, <span class="va">USpinfo</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">pn</span><span class="op">]</span>, <span class="va">USpinfo</span><span class="op">$</span><span class="va">elev</span><span class="op">[</span><span class="va">pn</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">loc1</span><span class="op">-</span> <span class="va">loc2</span><span class="op">)</span> <span class="op">-&gt;</span>  <span class="va">temp</span></span>
<span><span class="va">indbad</span><span class="op">&lt;-</span> <span class="va">temp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">.02</span> <span class="op">|</span> <span class="va">temp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&gt;</span> <span class="fl">.02</span> <span class="op">|</span>  <span class="va">temp</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># tolerance at 100 meters set mainly to include the CLIMAX station</span></span>
<span><span class="co"># a high altitude station. </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">CO.names</span><span class="op">[</span> <span class="va">indbad</span><span class="op">]</span>, <span class="va">loc1</span><span class="op">[</span><span class="va">indbad</span>,<span class="op">]</span>, <span class="va">loc2</span><span class="op">[</span><span class="va">indbad</span>,<span class="op">]</span>, <span class="va">temp</span><span class="op">[</span><span class="va">indbad</span>,<span class="op">]</span> <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#  CO.names.indbad.      X1    X2   X3    X1.1  X2.1 X3.1 X1.2 X2.2 X3.2</span></span>
<span><span class="co">#1     ALTENBERN    -108.38 39.50 1734 -108.53 39.58 2074 0.15 0.08  340</span></span>
<span><span class="co">#2     CAMPO 7 S    -102.57 37.02 1311 -102.68 37.08 1312 0.11 0.06    1</span></span>
<span><span class="co">#3     FLAGLER 2 NW -103.08 39.32 1519 -103.07 39.28 1525 0.01 0.04    6</span></span>
<span><span class="co">#4     GATEWAY 1 SE -108.98 38.68 1391 -108.93 38.70 1495 0.05 0.02  104</span></span>
<span><span class="co">#5     IDALIA       -102.27 39.77 1211 -102.28 39.70 1208 0.01 0.07    3</span></span>
<span><span class="co">#6     KARVAL       -103.53 38.73 1549 -103.52 38.80 1559 0.01 0.07   10</span></span>
<span><span class="co">#7     NEW RAYMER   -103.85 40.60 1458 -103.83 40.58 1510 0.02 0.02   52</span></span>
<span></span>
<span><span class="co"># modify the indt list to exclude these mismatches (there are 7 here)</span></span>
<span></span>
<span><span class="va">badones</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span>  <span class="va">CO.id</span><span class="op">[</span><span class="va">indbad</span><span class="op">]</span>, <span class="va">UStinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">)</span></span>
<span><span class="va">indt</span><span class="op">[</span> <span class="va">badones</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="co">###### now have working set of CO stations have both temp and precip </span></span>
<span><span class="co">##### and are reasonably close to each other. </span></span>
<span></span>
<span><span class="va">N</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="va">indt</span><span class="op">)</span></span>
<span><span class="co"># put data in time series order instead of table of year by month.</span></span>
<span><span class="va">CO.tmax</span><span class="op">&lt;-</span>  <span class="va">UStmax</span><span class="op">[</span>,,<span class="va">indt</span><span class="op">]</span></span>
<span><span class="va">CO.tmin</span><span class="op">&lt;-</span>  <span class="va">UStmin</span><span class="op">[</span>,,<span class="va">indt</span><span class="op">]</span></span>
<span></span>
<span><span class="va">CO.id</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">UStinfo</span><span class="op">[</span><span class="va">indt</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">CO.elev</span><span class="op">&lt;-</span> <span class="va">UStinfo</span><span class="op">[</span><span class="va">indt</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">CO.loc</span> <span class="op">&lt;-</span>  <span class="va">UStinfo</span><span class="op">[</span><span class="va">indt</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">CO.names</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">UStinfo</span><span class="op">[</span><span class="va">indt</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CO.years</span><span class="op">&lt;-</span> <span class="fl">1895</span><span class="op">:</span><span class="fl">1997</span></span>
<span></span>
<span><span class="co"># now find precip stations that match temp stations</span></span>
<span><span class="va">pn</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span>  <span class="va">CO.id</span>, <span class="va">USpinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">)</span></span>
<span><span class="co"># number of orphans</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span> <span class="va">pn</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pn</span><span class="op">&lt;-</span> <span class="va">pn</span><span class="op">[</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span> <span class="va">pn</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">CO.ppt</span><span class="op">&lt;-</span> <span class="va">USppt</span><span class="op">[</span>,,<span class="va">pn</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># checks --- all should zero</span></span>
<span></span>
<span><span class="va">ind</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span> <span class="va">CO.id</span><span class="op">[</span><span class="fl">45</span><span class="op">]</span>, <span class="va">USpinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">USppt</span><span class="op">[</span>,,<span class="va">ind</span><span class="op">]</span><span class="op">)</span>   <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">CO.ppt</span><span class="op">[</span>,,<span class="fl">45</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span> , na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ind</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span> <span class="va">CO.id</span><span class="op">[</span><span class="fl">45</span><span class="op">]</span>, <span class="va">UStinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">UStmax</span><span class="op">[</span>,,<span class="va">ind</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">CO.tmax</span><span class="op">[</span>,,<span class="fl">45</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">UStmin</span><span class="op">[</span>,,<span class="va">ind</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">CO.tmin</span><span class="op">[</span>,,<span class="fl">45</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># check order</span></span>
<span><span class="va">ind</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span> <span class="va">CO.id</span>, <span class="va">USpinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="va">CO.id</span> <span class="op">!=</span> <span class="va">USpinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ind</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span> <span class="va">CO.id</span>, <span class="va">UStinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="va">CO.id</span> <span class="op">!=</span> <span class="va">UStinfo</span><span class="op">$</span><span class="va">station.id</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># (3 4 5) (6 7 8) (9 10 11)  (12 1 2)</span></span>
<span><span class="va">N</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span> <span class="va">CO.tmax</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CO.tmax.MAM</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span> <span class="va">CO.tmax</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CO.tmin.MAM</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span> <span class="va">CO.tmin</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CO.ppt.MAM</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span> <span class="va">CO.ppt</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"sum"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now average over 1961-1990</span></span>
<span><span class="va">ind</span><span class="op">&lt;-</span>  <span class="va">CO.years</span><span class="op">&gt;=</span><span class="fl">1960</span> <span class="op">&amp;</span> <span class="va">CO.years</span> <span class="op">&lt;</span> <span class="fl">1990</span></span>
<span></span>
<span> <span class="va">temp</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/stats.html">stats</a></span><span class="op">(</span> <span class="va">CO.tmax.MAM</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span><span class="op">)</span></span>
<span> <span class="va">CO.tmax.MAM.climate</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span> <span class="va">temp</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">15</span>, <span class="va">temp</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">temp</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/stats.html">stats</a></span><span class="op">(</span> <span class="va">CO.tmin.MAM</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span><span class="op">)</span></span>
<span> <span class="va">CO.tmin.MAM.climate</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span> <span class="va">temp</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">15</span>, <span class="va">temp</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">CO.tmean.MAM.climate</span><span class="op">&lt;-</span> <span class="op">(</span><span class="va">CO.tmin.MAM.climate</span> <span class="op">+</span> <span class="va">CO.tmin.MAM.climate</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span> <span class="va">temp</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/stats.html">stats</a></span><span class="op">(</span> <span class="va">CO.ppt.MAM</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span><span class="op">)</span></span>
<span> <span class="va">CO.ppt.MAM.climate</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span> <span class="va">temp</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">15</span>, <span class="va">temp</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span> list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"CO.tmax"</span>, <span class="st">"CO.tmin"</span>, <span class="st">"CO.ppt"</span>,</span>
<span>              <span class="st">"CO.id"</span>, <span class="st">"CO.loc"</span>,<span class="st">"CO.years"</span>,</span>
<span>              <span class="st">"CO.names"</span>,<span class="st">"CO.elev"</span>, </span>
<span>              <span class="st">"CO.tmin.MAM"</span>, <span class="st">"CO.tmax.MAM"</span>, <span class="st">"CO.ppt.MAM"</span>,</span>
<span>              <span class="st">"CO.tmin.MAM.climate"</span>, <span class="st">"CO.tmax.MAM.climate"</span>, </span>
<span>              <span class="st">"CO.ppt.MAM.climate"</span>, <span class="st">"CO.tmean.MAM.climate"</span><span class="op">)</span>, </span>
<span>               file<span class="op">=</span><span class="st">"COmonthlyMet.rda"</span><span class="op">)</span></span></code></pre></div>


    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">COmonthlyMet</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Spatial plot of 1997 Spring average daily maximum temps</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="quilt.plot.html">quilt.plot</a></span><span class="op">(</span> <span class="va">CO.loc</span>,<span class="va">CO.tmax.MAM</span><span class="op">[</span><span class="fl">103</span>,<span class="op">]</span>  <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="US.html">US</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span> <span class="st">"Recorded MAM max temperatures (1997)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="CO-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># min and max temperatures against elevation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span> <span class="va">CO.elev</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">CO.tmax.MAM</span><span class="op">[</span><span class="fl">103</span>,<span class="op">]</span>, <span class="va">CO.tmin.MAM</span><span class="op">[</span><span class="fl">103</span>,<span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pch<span class="op">=</span><span class="st">"o"</span>, type<span class="op">=</span><span class="st">"p"</span>,</span></span>
<span class="r-in"><span>  col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Elevation (m)"</span>, ylab<span class="op">=</span><span class="st">"Temperature (C)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Recorded MAM max (red) and min (blue) temperatures 1997"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="CO-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Fitting a spatial model:</span></span></span>
<span class="r-in"><span><span class="va">obj</span><span class="op">&lt;-</span> <span class="fu"><a href="Tps.html">Tps</a></span><span class="op">(</span><span class="va">CO.loc</span>,<span class="va">CO.tmax.MAM.climate</span>,  Z<span class="op">=</span> <span class="va">CO.elev</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">&lt;-</span> <span class="fu"><a href="spatialProcess.html">spatialProcess</a></span><span class="op">(</span><span class="va">CO.loc</span>,<span class="va">CO.tmax.MAM.climate</span>, </span></span>
<span class="r-in"><span>          smoothness<span class="op">=</span><span class="fl">1.0</span>, Z<span class="op">=</span> <span class="va">CO.elev</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span> <span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>         </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

