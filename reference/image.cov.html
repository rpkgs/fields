<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Exponential, Matern and general covariance functions for 2-d 
gridded locations. — image.cov • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Exponential, Matern and general covariance functions for 2-d 
gridded locations. — image.cov"><meta property="og:description" content="Given two sets of locations defined on a 2-d grid efficiently multiplies a 
cross covariance with a vector. The intermediate compuations (the setup)
can also be used for fast simulation of the processes on a grid using the circulant
embedding technique."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/fastTps.html">fastTps</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Exponential, Matern and general covariance functions for 2-d 
gridded locations.</h1>
    
    <div class="hidden name"><code>image.cov.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given two sets of locations defined on a 2-d grid efficiently multiplies a 
cross covariance with a vector. The intermediate compuations (the setup)
can also be used for fast simulation of the processes on a grid using the circulant
embedding technique.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stationary.image.cov</span><span class="op">(</span><span class="va">ind1</span>, <span class="va">ind2</span>, <span class="va">Y</span>, cov.obj <span class="op">=</span> <span class="cn">NULL</span>, setup <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span><span class="va">grid</span>, M<span class="op">=</span><span class="cn">NULL</span>,N<span class="op">=</span><span class="cn">NULL</span>,cov.function<span class="op">=</span><span class="st">"stationary.cov"</span>, delta <span class="op">=</span> <span class="cn">NULL</span>, cov.args <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">Exp.image.cov</span><span class="op">(</span><span class="va">ind1</span>, <span class="va">ind2</span>, <span class="va">Y</span>, cov.obj <span class="op">=</span> <span class="cn">NULL</span>, setup <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">grid</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Rad.image.cov</span><span class="op">(</span><span class="va">ind1</span>, <span class="va">ind2</span>, <span class="va">Y</span>, cov.obj <span class="op">=</span> <span class="cn">NULL</span>, setup <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">grid</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">matern.image.cov</span><span class="op">(</span><span class="va">ind1</span>, <span class="va">ind2</span>, <span class="va">Y</span>, cov.obj <span class="op">=</span> <span class="cn">NULL</span>, setup <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">grid</span>,</span>
<span>M<span class="op">=</span><span class="cn">NULL</span>,N<span class="op">=</span><span class="cn">NULL</span>,aRange<span class="op">=</span> <span class="fl">1.0</span>, smoothness<span class="op">=</span><span class="fl">.5</span>, theta<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wendland.image.cov</span><span class="op">(</span><span class="va">ind1</span>, <span class="va">ind2</span>, <span class="va">Y</span>, cov.obj <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    setup <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">grid</span>, M <span class="op">=</span> <span class="cn">NULL</span>, N <span class="op">=</span> <span class="cn">NULL</span>, cov.args<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ind1</dt>
<dd><p>Matrix of indices for first set of locations this is a two column matrix
where each row is the row/column index of the image element. If missing
the default is to use all grid locations.</p></dd>

<dt>ind2</dt>
<dd><p>Matrix of indices for second set of locations. If missing this is taken to
be ind2. If ind1 is missing ind2 is coerced to be all grid locations.</p></dd>

<dt>Y</dt>
<dd><p>Vector to multiply by the cross covariance matrix. Y must be the same
locations as those referred to by ind2.</p></dd>

<dt>cov.args</dt>
<dd><p>Any additional arguments or parameters to the covariance function.</p></dd>

<dt>cov.obj</dt>
<dd><p>A list with the information needed to do the multiplication by
convolutions. This is usually found by using the returned list when
setup=T.</p></dd>

<dt>cov.function</dt>
<dd><p>Name of the (stationary) covariance function.</p></dd>

<dt>setup</dt>
<dd><p>If true do not do the multiplication but just return the covariance object
required by this function.</p></dd>

<dt>delta</dt>
<dd><p>A distance that indicates the range of the covariance when it has compact support.
For example this is the aRange parameter in the Wendland covariance.</p></dd>

<dt>grid</dt>
<dd><p>A grid list giving the X and Y grids for the image. (See example below.)
This is only required if setup is true.</p></dd>

<dt>M</dt>
<dd><p>Size of x-grid used to compute multiplication (see notes on image.smooth 
for details) by the FFT. If NULL, the default for M is the largest power 
of 2 
greater than or equal to 2*m where m is the length of the x component of the grid.</p>
<p>This  will give an exact 
result but  smaller values of M will yield an approximate, faster result.</p></dd>


<dt>N</dt>
<dd><p>Size of y-grid used to compute multiplication by the FFT.</p></dd>

<dt>aRange</dt>
<dd><p>Scale parameter for Matern.</p></dd>

<dt>theta</dt>
<dd><p>Same as aRange.</p></dd>

<dt>smoothness</dt>
<dd><p>Smoothness parameter for Matern (.5=Exponential)</p></dd>

<dt>...</dt>
<dd><p>Any arguments to pass to the covariance function in setting up the
covariance object. This is only required if setup is TRUE.
For <code>stationary.image.cov</code> one can include <code>V</code> a matrix reflecting
a rotation and scaling of 
coordinates. See stationary.cov for details.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A vector that is the multiplication of the cross covariance matrix with
the vector Y.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function was provided to do fast computations for large numbers of
spatial locations and supports the conjugate gradient solution in
krig.image. In doing so the observations can be irregular spaced
but their coordinates must be 2-dimensional and be restricted to grid
points.
(The function as.image will take irregular, continuous coordinates and
overlay a grid on them.)</p>
<p>Returned value: If ind1 and ind2 are matrices where nrow(ind1)=m and
nrow(ind2)=n then the cross covariance matrix, Sigma, is an mXn matrix
(i,j) element is the covariance between the grid locations indexed at
ind1[i,] and ind2[j,]. The returned result is Sigma multiplied by Y. Note that
one can
always recover the coordinates themselves by evaluating the grid list at
the indices.  E.g. If <code>x</code> and <code>y</code> are the grids for the X and Y
dimensions,  <code>cbind( x[ind1[,1]], y[ind1[,2]))</code> will give
the coordinates associated with ind1.
Clearly it is better just to work
with ind1!</p>  
<p>Functional Form: Following the same form as Exp.cov stationary.cov for 
irregular locations, the covariance is defined as phi( D.ij) where D.ij is
the Euclidean distance between x1[i,] and x2[j,] but having first been
scaled by aRange. Specifically,</p>
<p>D.ij = sqrt(  sum.k (( x1[i,k] - x2[j,k]) /aRange[k])**2 ).</p>
<p>See <code>Matern</code> for the version of phi for the Matern family.</p> 
<p>Note that if aRange is a scalar then this defines an isotropic covariance
function.</p>
<p>Implementation: This function does the multiplication on the full
grid efficiently by a 2-d FFT. The irregular pattern in Y is handled by
padding with zeroes and once that multiplication is done only the
appropriate subset is returned.</p>
<p>As an example assume that the grid is 100X100 let big.Sigma denote the big
covariance matrix among all grid points ( If the parent grid is 100x100
then big.Sigma is 10K by 10K !) Here are the computing steps:</p>
<p>temp&lt;- matrix( 0, 100,100)</p>
<p>temp[ ind2] &lt;- Y</p>
<p>temp2&lt;- big.Sigma%*% temp</p>
<p>temp2[ind1]</p>
<p>Notice how much we pad with zeroes or at the end throw away!
Here the matrix multiplication is effected through convolution/FFT tricks
to avoid creating and multiplying big.Sigma explicitly. It is often faster
to multiply the regular grid and throw away the parts we do not need then
to deal directly with the irregular set of locations.</p>
<p>Note: In this entire discussion Y is treated as vector. However if
one has complete data then Y can also be interpreted as a image matrix
conformed to correspond to spatial locations. See the last example for
this distinction.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>smooth.2d, as.image, krig.image, stationary.cov</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># multiply 2-d isotropic exponential with aRange=4 by a random vector </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">junk</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cov.obj</span><span class="op">&lt;-</span> <span class="fu">stationary.image.cov</span><span class="op">(</span> setup<span class="op">=</span><span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>             grid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>,aRange<span class="op">=</span><span class="fl">8</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">result</span><span class="op">&lt;-</span>  <span class="fu">stationary.image.cov</span><span class="op">(</span>Y<span class="op">=</span><span class="va">junk</span>,cov.obj<span class="op">=</span><span class="va">cov.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="va">result</span>, <span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="co"># NOTE that is also a smoother!</span></span></span>
<span class="r-plt img"><img src="image.cov-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to do it again, no setup is needed </span></span></span>
<span class="r-in"><span><span class="co">#  e.g. </span></span></span>
<span class="r-in"><span><span class="co">#  junk2&lt;- matrix(rnorm(100**2, 100,100))</span></span></span>
<span class="r-in"><span><span class="co">#  result2&lt;-  stationary.image.cov(Y=junk2, cov.obj=cov.obj)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a grid and set of indices based on discretizing the locations</span></span></span>
<span class="r-in"><span><span class="co"># in the precip dataset</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">out</span><span class="op">&lt;-</span><span class="fu"><a href="as.image.html">as.image</a></span><span class="op">(</span> <span class="va">RMprecip</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span> <span class="va">RMprecip</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">ind1</span><span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">ind</span></span></span>
<span class="r-in"><span> <span class="va">grid</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">x</span>, y<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># discretized x locations  to use for comparison</span></span></span>
<span class="r-in"><span>  <span class="va">xd</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">out</span><span class="op">$</span><span class="va">x</span><span class="op">[</span> <span class="va">out</span><span class="op">$</span><span class="va">ind</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span><span class="op">[</span> <span class="va">out</span><span class="op">$</span><span class="va">ind</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># setup to create cov.obj for exponential covariance with range= 1.25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">cov.obj</span><span class="op">&lt;-</span> <span class="fu">stationary.image.cov</span><span class="op">(</span> setup<span class="op">=</span><span class="cn">TRUE</span>, grid<span class="op">=</span><span class="va">grid</span>, aRange<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># multiply covariance matrix by an arbitrary vector</span></span></span>
<span class="r-in"><span> <span class="va">junk</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span> <span class="va">ind1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">result</span><span class="op">&lt;-</span> <span class="fu">stationary.image.cov</span><span class="op">(</span> <span class="va">ind1</span>, <span class="va">ind1</span>, Y<span class="op">=</span> <span class="va">junk</span>,cov.obj<span class="op">=</span><span class="va">cov.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The brute force way would be  </span></span></span>
<span class="r-in"><span><span class="co">#   result&lt;- stationary.cov( xd, xd, aRange=1.25, C=junk)</span></span></span>
<span class="r-in"><span><span class="co"># or </span></span></span>
<span class="r-in"><span><span class="co">#   result&lt;- stationary.cov( xd, xd, aRange=1.25) %*% junk</span></span></span>
<span class="r-in"><span><span class="co"># both of these take much longer </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># evaluate the covariance between all grid points and the center grid point</span></span></span>
<span class="r-in"><span> <span class="va">Y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">cov.obj</span><span class="op">$</span><span class="va">m</span>, <span class="va">cov.obj</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">Y</span><span class="op">[</span><span class="fl">32</span>,<span class="fl">32</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span> <span class="va">result</span><span class="op">&lt;-</span> <span class="fu">stationary.image.cov</span><span class="op">(</span> Y<span class="op">=</span> <span class="va">Y</span>,cov.obj<span class="op">=</span><span class="va">cov.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># covariance surface with respect to the grid point at (32,32)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># reshape "vector" as an image</span></span></span>
<span class="r-in"><span> <span class="va">temp</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="va">result</span>, <span class="va">cov.obj</span><span class="op">$</span><span class="va">m</span>,<span class="va">cov.obj</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="image.plot.html">image.plot</a></span><span class="op">(</span><span class="va">cov.obj</span><span class="op">$</span><span class="va">grid</span><span class="op">$</span><span class="va">x</span>,<span class="va">cov.obj</span><span class="op">$</span><span class="va">grid</span><span class="op">$</span><span class="va">y</span>, <span class="va">temp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.cov-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># or persp( cov.obj$grid$x,cov.obj$grid$y, temp) </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check out the Matern</span></span></span>
<span class="r-in"><span> <span class="va">grid</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">105</span>,<span class="op">-</span><span class="fl">99</span>,,<span class="fl">64</span><span class="op">)</span>, y<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">40</span>,<span class="fl">45</span>,,<span class="fl">64</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span> <span class="va">cov.obj</span><span class="op">&lt;-</span> <span class="fu">matern.image.cov</span><span class="op">(</span> </span></span>
<span class="r-in"><span>             setup<span class="op">=</span><span class="cn">TRUE</span>, grid<span class="op">=</span><span class="va">grid</span>, aRange<span class="op">=</span><span class="fl">.55</span>, smoothness<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">Y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">64</span>,<span class="fl">64</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">Y</span><span class="op">[</span><span class="fl">16</span>,<span class="fl">16</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">result</span><span class="op">&lt;-</span> <span class="fu">matern.image.cov</span><span class="op">(</span> Y<span class="op">=</span> <span class="va">Y</span>,cov.obj<span class="op">=</span><span class="va">cov.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">temp</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="va">result</span>, <span class="va">cov.obj</span><span class="op">$</span><span class="va">m</span>,<span class="va">cov.obj</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="image.plot.html">image.plot</a></span><span class="op">(</span> <span class="va">cov.obj</span><span class="op">$</span><span class="va">grid</span><span class="op">$</span><span class="va">x</span>,<span class="va">cov.obj</span><span class="op">$</span><span class="va">grid</span><span class="op">$</span><span class="va">y</span>, <span class="va">temp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.cov-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note we have centered at the location (grid$x[16],grid$y[16]) for this case</span></span></span>
<span class="r-in"><span><span class="co">#  using sim.rf to simulate an Matern field</span></span></span>
<span class="r-in"><span>  <span class="va">look</span><span class="op">&lt;-</span> <span class="fu"><a href="sim.rf.html">sim.rf</a></span><span class="op">(</span> <span class="va">cov.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="image.plot.html">image.plot</a></span><span class="op">(</span> <span class="va">grid</span><span class="op">$</span><span class="va">x</span>, <span class="va">grid</span><span class="op">$</span><span class="va">y</span>, <span class="va">look</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="image.cov-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

