<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Kriging surface estimate — Krig • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Kriging surface estimate — Krig"><meta property="og:description" content="Fits a surface to irregularly spaced data. The Kriging model assumes  
that the unknown  function is a realization  of a Gaussian 
random spatial processes. The assumed model is additive 
Y = P(x) +  Z(X) + e, where P is a low order polynomial and Z is a 
mean zero, 
Gaussian stochastic process with a  
covariance that is unknown up to a scale constant. The main advantages of
this function are the flexibility in specifying the covariance as an
R language function and also the supporting functions plot, predict,
predictSE, surface for
subsequent analysis. Krig also supports a correlation model where the mean
and marginal variances are supplied."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kriging surface estimate</h1>
    
    <div class="hidden name"><code>Krig.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a surface to irregularly spaced data. The Kriging model assumes  
that the unknown  function is a realization  of a Gaussian 
random spatial processes. The assumed model is additive 
Y = P(x) +  Z(X) + e, where P is a low order polynomial and Z is a 
mean zero, 
Gaussian stochastic process with a  
covariance that is unknown up to a scale constant. The main advantages of
this function are the flexibility in specifying the covariance as an
R language function and also the supporting functions plot, predict,
predictSE, surface for
subsequent analysis. Krig also supports a correlation model where the mean
and marginal variances are supplied.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Krig</span><span class="op">(</span><span class="va">x</span>, <span class="va">Y</span>, cov.function <span class="op">=</span> <span class="st">"stationary.cov"</span>, lambda <span class="op">=</span> <span class="cn">NA</span>, df</span>
<span>                 <span class="op">=</span> <span class="cn">NA</span>, GCV <span class="op">=</span> <span class="cn">FALSE</span>, Z <span class="op">=</span> <span class="cn">NULL</span>, cost <span class="op">=</span> <span class="fl">1</span>, weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 m <span class="op">=</span> <span class="fl">2</span>, nstep.cv <span class="op">=</span> <span class="fl">200</span>, scale.type <span class="op">=</span> <span class="st">"user"</span>, x.center <span class="op">=</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, x.scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, sigma <span class="op">=</span></span>
<span>                 <span class="cn">NA</span>, tau2 <span class="op">=</span> <span class="cn">NA</span>, method <span class="op">=</span> <span class="st">"REML"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 null.function <span class="op">=</span> <span class="st">"Krig.null.function"</span>, wght.function <span class="op">=</span></span>
<span>                 <span class="cn">NULL</span>, offset <span class="op">=</span> <span class="fl">0</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, cov.args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 chol.args <span class="op">=</span> <span class="cn">NULL</span>, null.args <span class="op">=</span> <span class="cn">NULL</span>, wght.args <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 W <span class="op">=</span> <span class="cn">NULL</span>, give.warnings <span class="op">=</span> <span class="cn">TRUE</span>, mean.obj <span class="op">=</span> <span class="cn">NA</span>, sd.obj</span>
<span>                 <span class="op">=</span> <span class="cn">NA</span>, <span class="va">...</span><span class="op">)</span></span>
<span>                 </span>
<span><span class="co"># S3 method for Krig</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Krig</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">resid.Krig</span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>chol.args</dt>
<dd><p>Arguments to be passed to the cholesky decomposition in Krig.engine.fixed. 
The default if NULL, assigned at the top level of this function, is 
list( pivot=FALSE). This argument is useful when working with 
the sparse matrix package.</p></dd>



<dt>cov.args</dt>
<dd><p>A list with the arguments to call the covariance function. (in addition to the locations)</p></dd>

<dt>cov.function</dt>
<dd><p>Covariance function for data in the form of an R function (see 
Exp.simple.cov as an example).  
Default assumes that correlation is an exponential function of distance.
See also <code>stationary.cov</code> for more general choice of covariance 
shapes. <code>exponential.cov</code> will be faster if only the exponential 
covariance form is needed.</p></dd>

<dt>cost</dt>
<dd><p>Cost value used in GCV criterion. Corresponds to a penalty for  
increased number of parameters. The default is 1.0 and corresponds to the
usual GCV function.</p></dd>

<dt>df</dt>
<dd><p>The effective number of parameters for the fitted surface. Conversely, 
N- df, where N is the total number of observations is the degrees of
freedom associated with the residuals. 
This is an alternative to specifying lambda and much more interpretable.
NOTE: GCV argument defaults to TRUE if this argument is used.</p></dd>


<dt>GCV</dt>
<dd><p>If TRUE matrix decompositions are done to allow estimating 
lambda by GCV or REML and specifying smoothness by the effective degrees of
freedom. So the GCV switch does more than just supply a GCV estimate. Also if
lambda or df are passed the estimate will be evaluated at those values, 
not at the GCV/REML estimates of lambda. 
If FALSE Kriging  estimate is found under a fixed lambda model.</p></dd>


<dt>give.warnings</dt>
<dd><p>If TRUE warnings are given in gcv grid search limits.
If FALSE warnings are not given. Best to leave this TRUE!
This argument is set ot FALSE if warn is less than zero in the
top level, R  options function. See options()$warn</p></dd>



<dt>lambda</dt>
<dd><p>Smoothing parameter that is the ratio of the error variance (tau**2) 
to the scale parameter of the  
covariance function (sigma). If omitted this is estimated by GCV ( see
method below).</p></dd>








<dt>method</dt>
<dd><p>Determines what "smoothing" parameter should be used. The default 
is to estimate standard GCV 
Other choices are: GCV.model, GCV.one, RMSE, pure error and REML. The 
differences are explained below.</p></dd>




<dt>mean.obj</dt>
<dd><p>Object to predict the mean of the spatial process. This used in when
fitting a correlation model with varying spatial means and varying
marginal variances. (See details.)</p></dd>




<dt>m</dt>
<dd><p>A polynomial function of degree (m-1) will be  
included in the model as the drift (or spatial trend) component. 
The "m" notation is from thin-plate splines where m is the 
derivative in the penalty function. With m=2 as the default a linear 
model in the locations  will be fit a fixed part of the model.</p></dd>


<dt>na.rm</dt>
<dd><p>If TRUE NAs will be removed from the <code>y</code> vector and the 
corresponding rows of <code>x</code> -- with a warning. 
If FALSE Krig will just stop with a message. Once NAs are removed all 
subsequent analysis in fields does not use those data.</p></dd>


<dt>nstep.cv</dt>
<dd><p>Number of grid points for the coarse grid search to
minimize the GCV RMLE and other related criteria for finding lambda,
the smoothing parameter.  Default is 200, fairly large to avoid some
cases of closely spaced local minima. Evaluations of the GCV and
related objective functions are cheap given the matrix decompositions
described below.</p></dd>


<dt>null.args</dt>
<dd><p>Extra arguments for the null space function
<code>null.function</code>.  If <code>fields.mkpoly</code> is passed as
<code>null.function</code> then this is set to a list with the value of
<code>m</code>. So the default is use a polynomial of degree m-1 for the
null space (fixed part) of the model.</p></dd>


<dt>null.function</dt>
<dd><p>An R function that creates the matrices for the null space model.  
The default is fields.mkpoly, an R function that creates a polynomial 
regression matrix with all terms up to degree m-1. (See Details)</p></dd>


<dt>offset</dt>
<dd><p>The offset to be used in the GCV criterion. Default is
0. This would be used when Krig is part of a backfitting algorithm and
the offset is other model degrees of freedom from other regression
components.</p></dd>


<dt>sigma</dt>
<dd><p>Scale factor for covariance.</p></dd>

<dt>scale.type</dt>
<dd><p>This is a character string among: "range", "unit.sd", "user", "unscaled".
The independent variables and knots are scaled to the specified scale.type. 
By default no scaling is done. This usuall makes sense for spatial locations.
Scale type of "range" scales the data to the interval (0,1) by forming 
(x-min(x))/range(x) for each x. Scale type of "unit.sd" 
Scale type of "user" allows specification of an x.center and x.scale by the 
user. The default for "user" is mean 0 and standard deviation 1. Scale 
type of "unscaled" does not scale the data.</p></dd>


<dt>sd.obj</dt>
<dd><p>Object to predict the marginal standard deviation of the spatial process.</p></dd>


<dt>tau2</dt>
<dd><p>Variance of the errors, often called the nugget variance. If weights are
specified then the error variance is tau2 divided by weights. 
Note that lambda is defined as the ratio  tau2/sigma.</p></dd>


<dt>verbose</dt>
<dd><p>If true will print out all kinds of intermediate stuff. Default is false,
of course as this is used mainly for debugging.</p></dd>


<dt>weights</dt>
<dd><p>Weights are proportional to the reciprocal variance of the measurement  
error. The default is equal weighting i.e. vector of unit weights.</p></dd>


<dt>wght.function</dt>
<dd><p>An R function that creates a weights matrix to the observations.  
This is only needed if the weight matirx has off diagonal elements. 
The default is NULL indicating that the weight matrix is a diagonal, based
on the weights argument. (See details)</p></dd>


<dt>W</dt>
<dd><p>The  observation weight matrix.</p></dd>


<dt>wght.args</dt>
<dd><p>Optional arguments to be passed to the weight function  (wght.function) 
used to create the observation weight matrix.</p></dd>
 

<dt>x</dt>
<dd><p>Matrix of independent variables. These could the locations for spatial
data or the indepedent variables in a regression.</p></dd>


<dt>x.center</dt>
<dd><p>Centering values to be subtracted from each column of the x matrix.</p></dd>


<dt>x.scale</dt>
<dd><p>Scale values that are divided into each column after centering.</p></dd>


<dt>Y</dt>
<dd><p>Vector of dependent variables. These are the values of the surface
(perhaps with measurement error) at the locations or the dependent
response in a regression.</p></dd>

<dt>Z</dt>
<dd><p>A vector of matrix of covariates to be include in the fixed part of the 
model. If NULL (default) no addtional covariates are included.</p></dd>


<dt>...</dt>
<dd><p>Optional arguments that appear are assumed to be additional arguments
to the covariance function. Or are included in methods functions (resid,
fitted, coef) as a
required argument.</p></dd>


<dt>object</dt>
<dd><p>A Krig object</p></dd>




</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A object of class Krig. This includes the predicted values in  
fitted.values and the residuals in residuals. The results of the grid 
search to minimize the generalized cross validation function are 
returned in gcv.grid.</p>


<p>The coef.Krig function only returns the coefficients, "d", associated with the 
fixed part of the model (also known as the null space or spatial drift).</p>
<dl><dt>call</dt>
<dd><p>Call to the function</p></dd>

<dt>y</dt>
<dd><p>Vector of dependent variables.</p></dd>

<dt>x</dt>
<dd><p>Matrix of independent variables.</p></dd>

<dt>weights</dt>
<dd><p>Vector of weights.</p></dd>

<dt>knots</dt>
<dd><p>Locations used to define the basis functions.</p></dd>

<dt>transform</dt>
<dd><p>List of components used in centering and scaling data.</p></dd>

<dt>np</dt>
<dd><p>Total number of parameters in the model.</p></dd>

<dt>nt</dt>
<dd><p>Number of parameters in the null space.</p></dd>

<dt>matrices</dt>
<dd><p>List of matrices from the decompositions (D, G, u, X, qr.T).</p></dd>

<dt>gcv.grid</dt>
<dd><p>Matrix of values from the GCV grid search. The first column 
is the grid of lambda values used in the search, the second column  
is the trace of the A matrix, the third column is the GCV values and 
the fourth column is the estimated value of tau conditional on the vlaue
of lambda.</p></dd>

<dt>lambda.est</dt>
<dd><p>A table of estimated smoothing parameters with corresponding degrees 
of freedom and estimates of tau found by different methods.</p></dd>

<dt>cost</dt>
<dd><p>Cost value used in GCV criterion.</p></dd>

<dt>m</dt>
<dd><p>Order of the polynomial space: highest degree polynomial is (m-1). 
This is a fixed part of the surface often referred to as the drift 
or spatial trend.</p></dd>

<dt>eff.df</dt>
<dd><p>Effective degrees of freedom of the model.</p></dd>

<dt>fitted.values</dt>
<dd><p>Predicted values from the fit.</p></dd>

<dt>residuals</dt>
<dd><p>Residuals from the fit.</p></dd>

<dt>lambda</dt>
<dd><p>Value of the smoothing parameter used in the fit. 
Lambda is defined as tau**2/sigma. See discussion in details.</p></dd>

<dt>yname</dt>
<dd><p>Name of the response.</p></dd>

<dt>cov.function</dt>
<dd><p>Covariance function of the model.</p></dd>

<dt>beta</dt>
<dd><p>Estimated coefficients in the ridge regression format</p></dd>

<dt>d</dt>
<dd><p>Estimated coefficients for the polynomial basis functions that span the 
null space</p></dd>

<dt>fitted.values.null</dt>
<dd><p>Fitted values for just the polynomial part of the estimate</p></dd>

<dt>trace</dt>
<dd><p>Effective number of parameters in model.</p></dd>

<dt>c</dt>
<dd><p>Estimated coefficients for the basis functions derived from the 
covariance.</p></dd>

<dt>coefficients</dt>
<dd><p>Same as the beta vector.</p></dd>

<dt>just.solve</dt>
<dd><p>Logical describing if the data has been interpolated using the basis  
functions.</p></dd>

<dt>tauHat</dt>
<dd><p>Estimated standard deviation of the measurement error (nugget effect).</p></dd>

<dt>tau2</dt>
<dd><p>Estimated variance of the measurement error (tauHat**2).</p></dd>

<dt>sigma</dt>
<dd><p>Scale factor for covariance.  COV(h(x),h(x<code>)) = sigma*cov.function(x,x</code>) 
If the covariance is actually a 
correlation function then sigma is also the "sill".</p></dd>

<dt>mean.var</dt>
<dd><p>Normalization of the covariance function used to find sigma.</p></dd>

<dt>best.model</dt>
<dd><p>Vector containing the value of lambda, the estimated variance of the  
measurement error and the scale factor for covariance used in the fit.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>This function produces a object of class Krig. With this object it is
easy to subsequently predict with this fitted surface, find standard
errors, alter the y data ( but not x), etc.</p>
<p>The Kriging model is: Y.k= f(x.k) = P(x.k) + Z(x.k) + e.k</p>
<p>where ".k" means subscripted by k, Y is the dependent variable observed 
at location x.k, P is a low order polynomial, Z is a mean zero, Gaussian 
field with covariance function K and e is assumed to be independent 
normal errors. The estimated surface is the best linear unbiased 
estimate (BLUE) of f(x)= P(x) + Z(x) given the observed data. For this 
estimate K, is taken to be sigma*cov.function and the errors have variance 
tau**2. In more conventional geostatistical terms sigma is the "sill" if 
the covariance function is actually a correlation function and tau**2 
is the nugget variance or measure error variance (the two are confounded 
in this model.)  If the weights are given then the variance of e.k is 
tau**2/ weights.k . In the case that the weights are specified as a 
matrix, W, using the wght.function option then the assumed covariance 
matrix for the errors is tau**2 Wi, where Wi is the inverse of W. It 
is straightforward to show that the estimate of f only depends on tau 
and sigma through the ratio lambda = tau**2/ sigma. This parameter, termed 
the smoothing parameter plays a central role in the statistical 
computations within <code>Krig</code>. See also the help for thin plate 
splines, (<code>Tps</code>) to get another perspective on the smoothing 
parameter.</p>
<p>This function also supports a modest extension of the Generalized 
Kriging model to include other covariates as fixed regression type 
components. In matrix form Y = Zb + F + E where Z is a matrix of 
covariates and b a fixed parameter vector, F the vector of function values at 
the observations and E a vector of errors. The The <code>Z</code> argument in 
the function is the way to specify this additional component.</p>
<p>If the parameters sigma and tau2 are omitted in the call, then they are
estimated in the following way. If lambda is given, then tau2 is
estimated from the residual sum of squares divided by the degrees of
freedom associated with the residuals.  Rho is found as the difference
between the sums of squares of the predicted values having subtracted off
the polynomial part and tau2. These estimates are the MLE's under Gaussian 
assumptions on the process and errors. 
 If lambda is also omitted is it estimated
from the data using a variety of approaches and then the values for tau
and sigma are found in the same way from the estimated lambda.</p>
<p>A useful extension of a stationary correlation to a nonstationary
covariance is what we term a correlation model. 
If mean and marginal standard deviation objects are included in the call.  
Then the observed data is standardized based on these functions.  The
spatial process is then estimated with respect to the standardized scale.
However for predictions and standard errors the mean and standard
deviation surfaces are used to produce results in the original scale of
the observations.</p>
<p>The GCV function has several alternative definitions when replicate
observations are present or if one uses a reduced set knots.  Here are the
choices based on the method argument:</p>
<p>GCV: leave-one-out GCV. But if
there are replicates it is leave one group out. (Wendy and Doug prefer
this one.)</p>
<p>GCV.one: Really leave-one-out GCV even if there are replicate
points.  This what the old tps function used in FUNFITS.</p> 
<p>rmse: Match the estimate of tau**2 to a external value ( called rmse)</p>
<p>pure error: Match the estimate of tau**2 to the estimate based on
replicated data (pure error estimate in ANOVA language).</p>
<p>GCV.model:
Only considers the residual sums of squares explained by the basis
functions.</p>
<p>REML: 
The process and errors are assumed to the Gaussian and the likelihood is 
concentrated (or profiled) with respect to lambda. The MLE of lambda is 
found from this criterion. Restricted means that the likelihood is formed from a linear transformation  of the observations that is orthogonal to the 
column space of P(x).</p>

<p>WARNING: The covariance functions often have a nonlinear parameter(s) that
often control the strength of the correlations as a function of separation,
usually referred to as the range parameter. This parameter must be
specified in the call to Krig and will not be estimated.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>See "Additive Models" by Hastie and Tibshirani, "Spatial Statistics" by    
Cressie and the FIELDS manual.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>summary.Krig, predict.Krig, predictSE.Krig, predictSurfaceSE,
predictSurface, plot.Krig,
surface.Krig</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a 2-d example </span></span></span>
<span class="r-in"><span><span class="co"># fitting a surface to ozone  </span></span></span>
<span class="r-in"><span><span class="co"># measurements. Exponential covariance, range parameter is 20 (in miles) </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">Krig</span><span class="op">(</span><span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span>, <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">y</span>, aRange<span class="op">=</span><span class="fl">20</span><span class="op">)</span>  </span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="va">fit</span><span class="op">)</span> <span class="co"># summary of fit </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CALL:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Krig(x = ChicagoO3$x, Y = ChicagoO3$y, aRange = 20)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of Observations:                20   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of unique points:               20   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of parameters in the null space 3    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameters for fixed spatial drift     3    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Effective degrees of freedom:          5.4  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residual degrees of freedom:           14.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MLE tau                                3.733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  GCV tau                                4.049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MLE sigma                              4.796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Scale passed for covariance (sigma)    &lt;NA&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Scale passed for nugget (tau^2)        &lt;NA&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Smoothing parameter lambda             2.906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Summary:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     min   1st Q  median   3rd Q     max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -6.4820 -1.6170 -0.5672  1.8010  7.4870 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariance Model: stationary.cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Covariance function is </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Names of non-default covariance arguments: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        aRange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DETAILS ON SMOOTHING PARAMETER:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Method used:   REML    Cost:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lambda       trA       GCV   GCV.one GCV.model    tauHat </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2.906     5.394    22.452    22.452        NA     4.049 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Summary of all estimates found for lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            lambda   trA   GCV tauHat -lnLike Prof converge</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV         4.120 4.799 22.39  4.125        49.26        4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.model      NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GCV.one     4.120 4.799 22.39  4.125           NA        4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE           NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pure error     NA    NA    NA     NA           NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML        2.906 5.394 22.45  4.049        49.24        2</span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span> <span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 2 by 2 matrix </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># four diagnostic plots of fit  </span></span></span>
<span class="r-plt img"><img src="Krig-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot window will lay out plots in a 1 by 1 matrix </span>
<span class="r-in"><span><span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span> <span class="va">fit</span>, type<span class="op">=</span><span class="st">"C"</span><span class="op">)</span> <span class="co"># look at the surface </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict at data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span> <span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 38.32080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 38.83593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 38.12672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 38.76760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 39.04168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 39.90186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 38.56459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 39.53299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 39.89821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 39.65490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 40.75214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 40.19162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 40.92551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 40.57972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 41.04454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 40.43037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 39.62459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 39.41161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 41.03544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 40.96869</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict using 7.5 effective degrees of freedom:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span> <span class="va">fit</span>, df<span class="op">=</span><span class="fl">7.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 37.49035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 38.19014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 37.08185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 38.27208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 38.57329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 40.11896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 37.86026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 39.26797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 40.17369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 39.51753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 41.19223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 40.22450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 41.24735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 40.62566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 41.53740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 41.16773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 39.48732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 39.64519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 41.95582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 41.98016</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict on a grid ( grid chosen here by defaults)</span></span></span>
<span class="r-in"><span> <span class="va">out</span><span class="op">&lt;-</span> <span class="fu"><a href="predictSurface.html">predictSurface</a></span><span class="op">(</span> <span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span> <span class="va">out</span>, type<span class="op">=</span><span class="st">"C"</span><span class="op">)</span> <span class="co"># option "C" our favorite</span></span></span>
<span class="r-plt img"><img src="Krig-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict at arbitrary points (10,-10) and (20, 15)</span></span></span>
<span class="r-in"><span> <span class="va">xnew</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">10</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">20</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="va">xnew</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 38.28184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 40.13606</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># standard errors of prediction based on covariance model.  </span></span></span>
<span class="r-in"><span> <span class="fu"><a href="predictSE.Krig.html">predictSE</a></span><span class="op">(</span> <span class="va">fit</span>, <span class="va">xnew</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.632105 3.054689</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># surface of standard errors on a default grid</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="predictSurface.html">predictSurfaceSE</a></span><span class="op">(</span> <span class="va">fit</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">out.p</span> <span class="co"># this takes some time!</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span> <span class="va">out.p</span>, type<span class="op">=</span><span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">fit</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Krig-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Using another stationary covariance. </span></span></span>
<span class="r-in"><span><span class="co"># smoothness is the shape parameter for the Matern. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">Krig</span><span class="op">(</span><span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span>, <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>Covariance<span class="op">=</span><span class="st">"Matern"</span>, aRange<span class="op">=</span><span class="fl">10</span>, smoothness<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Roll your own: creating very simple user defined Gaussian covariance </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test.cov</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>,<span class="va">aRange</span>,<span class="va">marginal</span><span class="op">=</span><span class="cn">FALSE</span>,<span class="va">C</span><span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="co"># return marginal variance</span></span></span>
<span class="r-in"><span>     <span class="kw">if</span><span class="op">(</span> <span class="va">marginal</span><span class="op">)</span> <span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span> <span class="va">x1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># find cross covariance matrix     </span></span></span>
<span class="r-in"><span>      <span class="va">temp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="rdist.html">rdist</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span><span class="op">/</span><span class="va">aRange</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="kw">if</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">C</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>          <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span> <span class="va">temp</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span>      <span class="kw">else</span><span class="op">{</span></span></span>
<span class="r-in"><span>          <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span> <span class="va">temp</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">C</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span>      <span class="op">}</span> </span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># use this and put in quadratic polynomial fixed function </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">fit.flame</span><span class="op">&lt;-</span> <span class="fu">Krig</span><span class="op">(</span><span class="va">flame</span><span class="op">$</span><span class="va">x</span>, <span class="va">flame</span><span class="op">$</span><span class="va">y</span>, cov.function<span class="op">=</span><span class="st">"test.cov"</span>, m<span class="op">=</span><span class="fl">3</span>, aRange<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># note how range parameter is passed to Krig.   </span></span></span>
<span class="r-in"><span><span class="co"># BTW:  GCV indicates an interpolating model (nugget variance is zero) </span></span></span>
<span class="r-in"><span><span class="co"># This is the content of the warning message.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># take a look ...</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span><span class="va">fit.flame</span>, type<span class="op">=</span><span class="st">"I"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># Thin plate spline fit to ozone data using the radial </span></span></span>
<span class="r-in"><span><span class="co"># basis function as a generalized covariance function </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># p=2 is the power in the radial basis function (with a log term added for </span></span></span>
<span class="r-in"><span><span class="co"># even dimensions)</span></span></span>
<span class="r-in"><span><span class="co"># If m is the degree of derivative in penalty then p=2m-d </span></span></span>
<span class="r-in"><span><span class="co"># where d is the dimension of x. p must be greater than 0. </span></span></span>
<span class="r-in"><span><span class="co">#  In the example below p = 2*2 - 2 = 2  </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">out</span><span class="op">&lt;-</span> <span class="fu">Krig</span><span class="op">(</span> <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span>, <span class="va">ChicagoO3</span><span class="op">$</span><span class="va">y</span>,cov.function<span class="op">=</span><span class="st">"Rad.cov"</span>, </span></span>
<span class="r-in"><span>                       m<span class="op">=</span><span class="fl">2</span>,p<span class="op">=</span><span class="fl">2</span>,scale.type<span class="op">=</span><span class="st">"range"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See also the Fields function Tps</span></span></span>
<span class="r-in"><span><span class="co"># out  should be identical to  Tps( ChicagoO3$x, ChicagoO3$y)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># explore some different values for the range and lambda using GCV</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ozone2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">aRange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">600</span>,,<span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">GCV</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="cn">NA</span>, <span class="fl">40</span>,<span class="fl">80</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the loop </span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">40</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># call to Krig with different ranges</span></span></span>
<span class="r-in"><span><span class="co"># also turn off warnings for GCV search </span></span></span>
<span class="r-in"><span><span class="co"># to avoid lots of messages. (not recommended in general!)</span></span></span>
<span class="r-in"><span>    <span class="va">obj</span><span class="op">&lt;-</span><span class="fu">Krig</span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span>,<span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>             cov.function<span class="op">=</span><span class="st">"stationary.cov"</span>, </span></span>
<span class="r-in"><span>             aRange<span class="op">=</span><span class="va">aRange</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>             Covariance<span class="op">=</span><span class="st">"Matern"</span>,smoothness<span class="op">=</span><span class="fl">1.0</span>, </span></span>
<span class="r-in"><span>             Distance<span class="op">=</span><span class="st">"rdist.earth"</span>, nstep.cv<span class="op">=</span><span class="fl">80</span>,</span></span>
<span class="r-in"><span>             give.warnings<span class="op">=</span><span class="cn">FALSE</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">GCV</span><span class="op">[</span><span class="va">k</span>,<span class="op">]</span><span class="op">&lt;-</span><span class="va">obj</span><span class="op">$</span><span class="va">gcv.grid</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># get lambda grid  from looping </span></span></span>
<span class="r-in"><span>   <span class="va">k</span><span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>   <span class="va">lam</span><span class="op">&lt;-</span>  <span class="fu">Krig</span><span class="op">(</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span>,<span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>             cov.function<span class="op">=</span><span class="st">"stationary.cov"</span>, </span></span>
<span class="r-in"><span>             aRange<span class="op">=</span><span class="va">aRange</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>             Covariance<span class="op">=</span><span class="st">"Matern"</span>,smoothness<span class="op">=</span><span class="fl">.5</span>, </span></span>
<span class="r-in"><span>             Distance<span class="op">=</span><span class="st">"rdist.earth"</span>, nstep.cv<span class="op">=</span><span class="fl">80</span>,</span></span>
<span class="r-in"><span>             give.warnings<span class="op">=</span><span class="cn">FALSE</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">gcv.grid</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">lam</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">GCV</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"l"</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

