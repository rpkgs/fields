<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Traditional or robust variogram methods for spatial data — vgram • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Traditional or robust variogram methods for spatial data — vgram"><meta property="og:description" content='vgram computes pairwise squared differences as a function of distance. 
Returns an S3 object of class "vgram" with either raw values or statistics from 
binning. crossCoVGram is the same as vgram but differences are 
taken across different variables rather than the same variable.
plot.vgram and boxplotVGram create lineplots and boxplots of 
vgram objects output by the vgram function.  boxplotVGram plots 
the base R boxplot function, and plots estimates of the mean over the boxplot.
The getVGMean function returns the bin centers and means of the vgram 
object based on the bin breaks provided by the user.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/fastTps.html">fastTps</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Traditional or robust variogram methods for spatial data</h1>
    
    <div class="hidden name"><code>vgram.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>vgram</code> computes pairwise squared differences as a function of distance. 
Returns an S3 object of class "vgram" with either raw values or statistics from 
binning. <code>crossCoVGram</code> is the same as <code>vgram</code> but differences are 
taken across different variables rather than the same variable.</p>
<p><code>plot.vgram</code> and <code>boxplotVGram</code> create lineplots and boxplots of 
vgram objects output by the <code>vgram</code> function.  <code>boxplotVGram</code> plots 
the base R boxplot function, and plots estimates of the mean over the boxplot.</p>
<p>The <code>getVGMean</code> function returns the bin centers and means of the <code>vgram</code> 
object based on the bin breaks provided by the user.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vgram</span><span class="op">(</span><span class="va">loc</span>, <span class="va">y</span>, id <span class="op">=</span> <span class="cn">NULL</span>, d <span class="op">=</span> <span class="cn">NULL</span>, lon.lat <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                    dmax <span class="op">=</span> <span class="cn">NULL</span>, N <span class="op">=</span> <span class="cn">NULL</span>, breaks <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variogram"</span>, <span class="st">"covariogram"</span>, <span class="st">"correlogram"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">crossCoVGram</span><span class="op">(</span><span class="va">loc1</span>, <span class="va">loc2</span>, <span class="va">y1</span>, <span class="va">y2</span>, id <span class="op">=</span> <span class="cn">NULL</span>, d <span class="op">=</span> <span class="cn">NULL</span>, lon.lat <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                        dmax <span class="op">=</span> <span class="cn">NULL</span>, N <span class="op">=</span> <span class="cn">NULL</span>, breaks <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                        type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cross-covariogram"</span>, <span class="st">"cross-correlogram"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">boxplotVGram</span><span class="op">(</span><span class="va">x</span>, N<span class="op">=</span><span class="fl">10</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">d</span>, <span class="va">N</span>, eps.correct <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, plot<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">plot.args</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for vgram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, N<span class="op">=</span><span class="fl">10</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">d</span>, <span class="va">N</span>, eps.correct <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getVGMean</span><span class="op">(</span><span class="va">x</span>, N <span class="op">=</span> <span class="fl">10</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">d</span>, <span class="va">N</span>, eps.correct <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>loc</dt>
<dd><p>Matrix where each row is the coordinates of an observed point
of the field</p></dd>

<dt>y</dt>
<dd><p>Value of the field at locations</p></dd>

<dt>loc1</dt>
<dd><p>Matrix where each row is the coordinates of an observed point
of field 1</p></dd>

<dt>loc2</dt>
<dd><p>Matrix where each row is the coordinates of an observed point
of field 2</p></dd>

<dt>y1</dt>
<dd><p>Value of field 1 at locations</p></dd>

<dt>y2</dt>
<dd><p>Value of field 2 at locations</p></dd>

<dt>id</dt>
<dd><p>A 2 column matrix that specifies which variogram differnces to find. 
If omitted all possible pairing are found. 
This can used if the data has an additional covariate that determines
proximity, for example a time window.</p></dd>

<dt>d</dt>
<dd><p>Distances among pairs indexed by id. If not included distances from from
directly from loc.</p></dd>

<dt>lon.lat </dt>
<dd><p>If true, locations are assumed to be longitudes and latitudes
and distances found are great circle distances (in miles see 
<a href="rdist.earth.html">rdist.earth</a>).  Default is FALSE.</p></dd>

<dt>dmax</dt>
<dd><p>Maximum distance to compute variogram.</p></dd>

<dt>N</dt>
<dd><p>Number of bins to use. The break points are found by the <code>pretty</code> function and so ther may not be exactly N bins. Specify the breaks explicity if you want excalty N bins.</p></dd>

<dt>breaks</dt>
<dd><p>Bin boundaries for binning variogram values. Need not be equally spaced
but must be ordered.</p></dd>

<dt>x</dt>
<dd><p>An object of class "vgram" (an object returned by <code>vgram</code>)</p></dd>

<dt>add</dt>
<dd><p>If <code>TRUE</code>, adds empirical variogram lineplot to current plot.  Otherwise 
creates new plot with empirical variogram lineplot.</p></dd>

<dt>plot</dt>
<dd><p>If <code>TRUE</code>, creates a plot, otherwise returns variogram statistics output by 
<code>bplot.xy</code>.</p></dd>

<dt>plot.args</dt>
<dd><p>Additional arguments to be passed to <code>plot.vgram</code>.</p></dd>

<dt>type</dt>
<dd><p>One of "variogram", "covariogram", "correlogram", "cross-covariogram", and 
"cross-correlogram".  <code>vgram</code> supports the first three of these and 
<code>crossCoVGram</code> supports the last two.</p></dd>

<dt>...</dt>
<dd><p>Additional argument passed to <code>plot</code> for <code>plot.vgram</code> or to 
<code>bplot.xy</code> for <code>boxplotVGram</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>vgram</code> and <code>crossCoVGram</code> return a "vgram" object containing the 
following values:</p>
<dl><dt>vgram</dt>
<dd><p>Variogram or covariogram values</p></dd>
 
<dt>d</dt>
<dd><p>Pairwise distances</p></dd>
 
<dt>call</dt>
<dd><p>Calling string</p></dd>
 
<dt>stats</dt>
<dd><p>Matrix of statistics for values in each bin. 
  Rows are the summaries returned by the stats function or describe.  
  If not either breaks or N arguments are not supplied then this
  component is not computed.</p></dd>
 
<dt>centers</dt>
<dd><p>Bin centers.</p></dd>


</dl><p>If <code>boxplotVGram</code> is called with <code>plot=FALSE</code>, it returns a 
list with the same components as returned by <code>bplot.xy</code></p>


    </div>
    <div id="references">
    <h2>References</h2>
    <p>See any standard reference on spatial statistics. For example 
Cressie, Spatial Statistics</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>John Paige, Doug Nychka</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="vgram.matrix.html">vgram.matrix</a>, <a href="bplot.xy.html">bplot.xy</a>, <a href="bplot.html">bplot</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># compute variogram for the midwest ozone field  day 16</span></span></span>
<span class="r-in"><span><span class="co"># (BTW this looks a bit strange!)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">good</span><span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span><span class="op">[</span><span class="va">good</span>,<span class="op">]</span> </span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="va">good</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">look</span><span class="op">&lt;-</span><span class="fu">vgram</span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span>, N<span class="op">=</span><span class="fl">15</span>, lon.lat<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># locations are in lon/lat so use right</span></span></span>
<span class="r-in"><span><span class="co">#distance</span></span></span>
<span class="r-in"><span><span class="co"># take a look:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">look</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vgram-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#lines(look$centers, look$stats["mean",], col=4)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">brk</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">250</span>,, <span class="op">(</span><span class="fl">25</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">)</span> <span class="co"># will give 25 bins.</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co">## or some boxplot bin summaries</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">boxplotVGram</span><span class="op">(</span><span class="va">look</span>, breaks<span class="op">=</span><span class="va">brk</span>, plot.args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"o"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">look</span>, add<span class="op">=</span><span class="cn">TRUE</span>, breaks<span class="op">=</span><span class="va">brk</span>, col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vgram-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># compute equivalent covariogram, but leave out the boxplots</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">look</span><span class="op">&lt;-</span><span class="fu">vgram</span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span>, N<span class="op">=</span><span class="fl">15</span>, lon.lat<span class="op">=</span><span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"covariogram"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">look</span>, breaks<span class="op">=</span><span class="va">brk</span>, col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vgram-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># compute equivalent cross-covariogram of the data with itself </span></span></span>
<span class="r-in"><span><span class="co">#(it should look almost exactly the same as the covariogram of </span></span></span>
<span class="r-in"><span><span class="co">#the original data, except with a few more points in the </span></span></span>
<span class="r-in"><span><span class="co">#smallest distance boxplot and points are double counted)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">look</span> <span class="op">=</span> <span class="fu">crossCoVGram</span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">y</span>, N<span class="op">=</span><span class="fl">15</span>, lon.lat<span class="op">=</span><span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"cross-covariogram"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">look</span>, breaks<span class="op">=</span><span class="va">brk</span>, col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="vgram-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

