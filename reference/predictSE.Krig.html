<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Standard errors of predictions for Krig spatial process estimate — predictSE • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Standard errors of predictions for Krig spatial process estimate — predictSE"><meta property="og:description" content='Finds the standard error ( or covariance) of prediction based on a linear
combination of
the observed data. The linear combination is usually the "Best Linear
Unbiased Estimate" (BLUE) found from the Kriging equations. 
This statistical computation is done under the assumption that the
covariance function is known.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
    <li>
      <a href="../articles/predictSurface.html">predictSurface</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Standard errors of predictions for Krig spatial process estimate</h1>
    
    <div class="hidden name"><code>predictSE.Krig.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Finds the standard error ( or covariance) of prediction based on a linear
combination of
the observed data. The linear combination is usually the "Best Linear
Unbiased Estimate" (BLUE) found from the Kriging equations. 
This statistical computation is done under the assumption that the
covariance function is known.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predictSE</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for Krig</span></span>
<span><span class="fu">predictSE</span><span class="op">(</span><span class="va">object</span>, x <span class="op">=</span> <span class="cn">NULL</span>, cov <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for mKrig</span></span>
<span><span class="fu">predictSE</span><span class="op">(</span><span class="va">object</span>, xnew <span class="op">=</span> <span class="cn">NULL</span>, Z <span class="op">=</span> <span class="cn">NULL</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, drop.Z</span>
<span>                 <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>drop.Z</dt>
<dd><p>If FALSE find standard error without including the additional spatial covariates
described by <code>Z</code>. If TRUE find full standard error with spatial covariates if they are part of the model.</p></dd>

<dt>object</dt>
<dd><p>A fitted object that can be used to find prediction standard errors. This is usually from fitting a spatial model to data. e.g. a Krig or mKrig object.</p></dd>

<dt>xnew</dt>
<dd><p>Points to compute the predict standard error or the prediction 
cross covariance matrix.</p></dd>

<dt>x</dt>
<dd><p>Same as <code>xnew</code> -- points to compute the predict standard error or the prediction 
cross covariance matrix.</p></dd>

<dt>cov</dt>
<dd><p>If TRUE the full covariance matrix for the predicted values is returned.
Make sure this will not be big if this option is used. ( e.g. 50X50 grid
will return a matrix that is 2500X2500!)  If FALSE just the marginal
standard deviations of the predicted values are returned. Default is
FALSE -- of course.</p></dd>


<dt>verbose</dt>
<dd><p>If TRUE will print out various information for debugging.</p></dd>


<dt>...</dt>
<dd><p>These additional arguments passed to the predictSE function.</p></dd>

<dt>Z</dt>
<dd><p>Additional matrix of spatial covariates used for prediction. These are used to 
determine the additional covariance contributed in teh fixed part of the model.</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A vector of standard errors for the predicted values of the Kriging fit.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The predictions are represented as a linear combination of the dependent 
variable, Y. Call this LY.  Based on this representation the conditional 
variance is the same as the expected value of (P(x) + Z(X) - LY)**2.
where 
P(x)+Z(x) is the value of the surface at x and LY is the linear 
combination that estimates this point. Finding this expected value is 
straight forward given the unbiasedness of LY for P(x) and the covariance 
for Z and Y.</p>
<p>In these calculations it is assumed that the covariance parameters are fixed.
This is an approximation since in most cases they have been estimated from the 
data. It should also be noted that if one assumes a Gaussian field and known 
parameters in the covariance, the usual Kriging estimate is the 
conditional mean of the field given the data. This function finds the 
conditional standard deviations (or full covariance matrix) of the 
fields given the data.</p>
<p>There are two useful extensions supported by this function.  Adding the 
variance to the estimate of the spatial mean if this is a correlation 
model. (See help file for Krig) and calculating the variances under 
covariance misspecification.  The function <code>predictSE.KrigA</code> uses 
the smoother matrix ( A(lambda) ) to find the standard errors or 
covariances directly from the linear combination of the spatial 
predictor. Currently this is also the calculation in 
<code>predictSE.Krig</code> although a shortcut is used 
<code>predictSE.mKrig</code> for mKrig objects.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Krig, predict.Krig, predictSurfaceSE</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># Note: in these examples predictSE will default to predictSE.Krig using </span></span></span>
<span class="r-in"><span><span class="co"># a Krig object  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fit</span><span class="op">&lt;-</span> <span class="fu"><a href="Krig.html">Krig</a></span><span class="op">(</span><span class="va">ChicagoO3</span><span class="op">$</span><span class="va">x</span>,<span class="va">ChicagoO3</span><span class="op">$</span><span class="va">y</span>,cov.function<span class="op">=</span><span class="st">"Exp.cov"</span>, aRange<span class="op">=</span><span class="fl">10</span><span class="op">)</span>    <span class="co"># Krig fit </span></span></span>
<span class="r-in"><span>  <span class="fu">predictSE.Krig</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>      <span class="co"># std errors of predictions at obs.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.605075 1.625888 1.582081 1.717259 1.553386 2.037997 1.588340 1.624983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 1.753248 1.970771 2.139202 1.804267 2.430791 2.011470 2.115035 2.388593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 1.871492 1.662702 2.323701 2.039209</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make a  grid of X's  </span></span></span>
<span class="r-in"><span>  <span class="va">xg</span><span class="op">&lt;-</span><span class="fu"><a href="grid.list.html">make.surface.grid</a></span><span class="op">(</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>East.West<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">27</span>,<span class="fl">34</span>,,<span class="fl">20</span><span class="op">)</span>,North.South<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>,<span class="fl">35</span>,,<span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>     </span></span>
<span class="r-in"><span>  <span class="va">out</span><span class="op">&lt;-</span> <span class="fu">predictSE</span><span class="op">(</span><span class="va">fit</span>,<span class="va">xg</span><span class="op">)</span>   <span class="co"># std errors of predictions </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#at the grid points out is a vector of length 400 </span></span></span>
<span class="r-in"><span><span class="co">#reshape the grid points into a 20X20 matrix etc.  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="va">out.p</span><span class="op">&lt;-</span><span class="fu"><a href="as.surface.html">as.surface</a></span><span class="op">(</span> <span class="va">xg</span>, <span class="va">out</span><span class="op">)</span> </span></span>
<span class="r-in"><span>   <span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span> <span class="va">out.p</span>, type<span class="op">=</span><span class="st">"C"</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="predictSE.Krig-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this is equivalent to  the single step function  </span></span></span>
<span class="r-in"><span><span class="co"># (but default is not to extrapolation beyond data</span></span></span>
<span class="r-in"><span><span class="co"># out&lt;- predictSurfaceSE( fit) </span></span></span>
<span class="r-in"><span><span class="co"># image.plot( out) </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

