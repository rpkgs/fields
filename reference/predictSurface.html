<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Evaluates a fitted function or the prediction error as a surface that is suitable for plotting with 
the image, persp, or contour functions. — predictSurface • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluates a fitted function or the prediction error as a surface that is suitable for plotting with 
the image, persp, or contour functions. — predictSurface"><meta property="og:description" content="Evaluates a a fitted model or the prediction error on a 2-D grid keeping any other variables constant.
The resulting object is suitable for use with functions for viewing 3-d
surfaces."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluates a fitted function or the prediction error as a surface that is suitable for plotting with 
the image, persp, or contour functions.</h1>
    
    <div class="hidden name"><code>predictSurface.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Evaluates a a fitted model or the prediction error on a 2-D grid keeping any other variables constant.
The resulting object is suitable for use with functions for viewing 3-d
surfaces.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for default</span></span>
<span><span class="fu">predictSurface</span><span class="op">(</span><span class="va">object</span>, grid.list <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     extrap <span class="op">=</span> <span class="cn">FALSE</span>, chull.mask <span class="op">=</span> <span class="cn">NA</span>, nx <span class="op">=</span> <span class="fl">80</span>, ny <span class="op">=</span> <span class="fl">80</span>,</span>
<span>                        xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,  verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for fastTps</span></span>
<span><span class="fu">predictSurface</span><span class="op">(</span><span class="va">object</span>, gridList <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>       extrap <span class="op">=</span> <span class="cn">FALSE</span>, chull.mask <span class="op">=</span> <span class="cn">NA</span>, nx <span class="op">=</span> <span class="fl">80</span>, ny <span class="op">=</span> <span class="fl">80</span>,</span>
<span>       xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,  verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span>       </span>
<span><span class="co"># S3 method for Krig</span></span>
<span><span class="fu">predictSurface</span><span class="op">(</span><span class="va">object</span>, grid.list <span class="op">=</span> <span class="cn">NULL</span>, extrap <span class="op">=</span> <span class="cn">FALSE</span>, chull.mask <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>nx <span class="op">=</span> <span class="fl">80</span>, ny <span class="op">=</span> <span class="fl">80</span>, xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, ZGrid <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    drop.Z <span class="op">=</span> <span class="cn">FALSE</span>, just.fixed<span class="op">=</span><span class="cn">FALSE</span>,  <span class="va">...</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># S3 method for mKrig</span></span>
<span><span class="fu">predictSurface</span><span class="op">(</span><span class="va">object</span>, gridList <span class="op">=</span> <span class="cn">NULL</span>, grid.list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 ynew <span class="op">=</span></span>
<span>                 <span class="cn">NULL</span>, extrap <span class="op">=</span> <span class="cn">FALSE</span>, chull.mask <span class="op">=</span> <span class="cn">NA</span>, nx <span class="op">=</span> <span class="fl">80</span>, ny <span class="op">=</span></span>
<span>                 <span class="fl">80</span>, xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, ZGrid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 drop.Z <span class="op">=</span> <span class="cn">FALSE</span>, just.fixed <span class="op">=</span> <span class="cn">FALSE</span>, fast <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 NNSize <span class="op">=</span> <span class="fl">4</span>, giveWarnings <span class="op">=</span> <span class="cn">FALSE</span>, derivative <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span></span>
<span>     </span>
<span><span class="fu">mKrigFastPredict</span><span class="op">(</span><span class="va">object</span>, <span class="va">gridList</span>, ynew <span class="op">=</span> <span class="cn">NULL</span>, derivative <span class="op">=</span> <span class="fl">0</span>, Z <span class="op">=</span></span>
<span>                 <span class="cn">NULL</span>, drop.Z <span class="op">=</span> <span class="cn">FALSE</span>, NNSize <span class="op">=</span> <span class="fl">5</span>, setupObject <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 giveWarnings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        </span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">predictSurfaceSE</span><span class="op">(</span><span class="va">object</span>, grid.list <span class="op">=</span> <span class="cn">NULL</span>, extrap <span class="op">=</span> <span class="cn">FALSE</span>, chull.mask <span class="op">=</span></span>
<span>                 <span class="cn">NA</span>, nx <span class="op">=</span> <span class="fl">80</span>, ny <span class="op">=</span> <span class="fl">80</span>, xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 ZGrid <span class="op">=</span> <span class="cn">NULL</span>, just.fixed <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for surface</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An object from fitting a function to data. In fields this is usually a
Krig, mKrig, or fastTps object.</p></dd>

<dt>gridList</dt>
<dd><p>A list with as many components as variables describing the surface. 
All components should have a single value except the two that give the 
grid points for evaluation. If the matrix or data frame has column names,  
these must appear in the grid list. See the grid.list help file for more
details. If this is omitted and the fit just depends on two variables the
grid will be made from the ranges of the observed variables. 
(See the function <code>fields.x.to.grid</code>.)</p></dd>

<dt>grid.list</dt>
<dd><p>Alternative to the  <code>gridList</code> argument.</p></dd>


<dt>giveWarnings</dt>
<dd><p>If TRUE will warn when more than one observation is in a grid box.</p></dd>


<dt>extrap</dt>
<dd><p>Extrapolation beyond the range of the data. If <code>FALSE</code> (the 
default) the predictions will be restricted to the convex hull of the observed 
data or the convex hull defined from the points from the argument chull.mask. 
This function may be slightly faster if this logical is set to 
<code>TRUE</code> to avoid checking the grid points for membership in the 
convex hull. For more complicated masking a low level creation of a bounding 
polygon and testing for membership with <code>in.poly</code> may be useful.</p></dd>


<dt>chull.mask</dt>
<dd><p>Whether to restrict the fitted surface to be on a convex hull, NA's
are assigned to values outside the
convex hull. chull.mask should be a sequence of points defining a convex
hull. Default is to form the convex hull from the observations if this
argument is missing (and extrap is false).</p></dd>

  

<dt>nx</dt>
<dd><p>Number of grid points in X axis.</p></dd>


<dt>ny</dt>
<dd><p>Number of grid points in Y axis.</p></dd>


<dt>xy</dt>
<dd><p>A two element vector giving the positions for the "X" and "Y"
variables for the surface. The positions refer to the columns of the x 
matrix used to define the multidimensional surface. This argument is 
provided in lieu of generating the grid list. If a 4 dimensional surface
is fit to data then <code> xy= c(2,4)</code> will evaluate a surface using the 
second and fourth variables with  variables 1 and 3 fixed at their median 
values. NOTE: this argument is ignored if a grid.list argument is 
passed.</p></dd>


<dt>drop.Z</dt>
<dd><p>If TRUE the fixed part of model depending on covariates is omitted.</p></dd>


<dt>just.fixed</dt>
<dd><p>If TRUE the nonparametric surface is omitted.</p></dd>


<dt>fast</dt>
<dd><p>If TRUE approximate predictions for stationary models are made using the FFT. For large grids( e.g. nx, ny &gt; 200) this can be substantially faster and still accurate to several decimal places.</p></dd>


<dt>NNSize</dt>
<dd><p>Order of nearest neighborhood used for fast prediction.  The default,<code>NSize = 5</code>, means an 11X11=121 set of grid points/covariance kernels are used to approximate the off-grid covariance kernel.</p></dd>


<dt>setupObject</dt>
<dd><p>The object created explicitly using
<code><a href="offGridWeights.html">mKrigFastPredictSetup</a></code>. Useful for predicting multple surfaces with the same observation locations.</p></dd>


<dt>derivative</dt>
<dd><p>Predict the  estimated derivatives of order <code>derivative</code>.</p></dd>


 <dt>ynew</dt>
<dd><p>New data to use to refit the spatial model. Locations must be the same but if so this is efficient because the matrix decompositions are reused.</p></dd>

  
 <dt>...</dt>
<dd><p>Any other arguments to pass to the predict function associated with the fit
object. 
Some of the usual arguments for several of the fields fitted objects include:</p><dl><dt>ynew</dt>
<dd><p>New values of y used to reestimate the surface.</p></dd>


<dt>Z</dt>
<dd><p>A matrix of covariates for the fixed part of model.</p></dd>


</dl></dd>


<dt>ZGrid</dt>
<dd><p>An array  or list form of covariates to use for
	 prediction. This must match the same dimensions from the 
<code>grid.list</code> / <code>gridList</code> argument.</p>
<p>If ZGrid is an array then the first two indices are the x and y
 locations in the 
grid. The third index, if present, indexes the covariates. e.g. For
 evaluation on 
a 10X15 grid and with 2 covariates. <code> dim( ZGrid) == c(10,15, 2)</code>.
If ZGrid is a list then the components x and y shold match those of grid list and
the z component follows the shape described above for the no list 
case.</p></dd>


<dt>Z</dt>
<dd><p>The covariates for the grid unrolled as a matrix. Columns index
the variables and rows index the grid locations. E.g. For
 evaluation on  a 10X15 grid and with 2 covariates. <code> dim( ZGrid) == c(10,15, 2)</code>.  and so <code>  dim( Z) = c(150, 2)</code> and  
 <code> Z[,1] &lt;- c( ZGrid[,,1])</code></p></dd>


 <dt>verbose</dt>
<dd><p>If TRUE prints out some imtermediate results for debugging.</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The usual list components for making image, contour, and perspective plots
(x,y,z) along with labels for the x and y variables. For
<code>predictSurface.derivative</code> the component <code>z</code> is a three
dimensional array with values( <code>nx</code>, <code>ny</code>, 2 )</p>
<p></p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>These function evaluate the spatial process or thin plate spline estimates on a regualr grid of points 
The  grid can be specified using the grid.list/ gridList  information or just the sizes.</p>
<p>For the standard Krig and mKrig versions the steps are to create a matrix of locations the represent the grid, 
 call the predict function for the object with these
points and also adding any extra arguments passed in the ... section,
and then reform the results as a surface object (as.surface). To
determine the what parts of the prediction grid are in the convex hull
of the data the function <code>in.poly</code> is used. The argument
inflation in this function is used to include a small margin around
the outside of the polygon so that point on convex hull are
included. This potentially confusing modification is to prevent
excluding grid points that fall exactly on the ranges of the
data. Also note that as written there is no computational savings for
evaluting only the convex subset compared to the full grid.</p>
<p>For the "fast" option a stationary covariance function and  resulting surface
estimate is approximated by the covariance kernel restricted to the grid
locations. In this way the approximate problem becomes a 2-d convolution.
The evaluation of the approximate prediction surface uses a fast Fourier
transform to compute the predicted values at the grid locations.</p>

<p>The nearest
neighbor argument <code>NNSize</code> controls the number of covariance kernels
only evalauted at grid location used
to approximate a  covariance function at an off-grid location. We have
found good results  with <code>NNSize=5</code>.</p>

<p><code>predictSurface.fastTps</code> is a specific version ( m=2, and k=2) of
Kriging with a compact covariance kernel (Wendland). 
that can be much more efficient because it takes advantage of a low
level FORTRAN call to evaluate the  covariance function. Use
<code>predictSurface</code> or <code>predict</code> for other choices of m and k.</p>

<p><code>predictSurface.Krig</code> is designed to also include covariates for the fixed in terms of grids.</p>
<p><code>predictSurface.mKrig</code> Similar in function to the Krig prediction function but it more efficient using the <code>mKrig</code> fit object.</p>
<p><code>mKrigFastpredict</code> Although this function might be called at the top is it easier to use through the wrapper,  <code>predictSurface.mKrig</code> and <code>fast=TRUE</code>.</p> 
<p>NOTE: <code>predict.surface</code> has been depreciated and just prints out
a warning when called.</p>
<p></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Tps, Krig, predict, grid.list, make.surface.grid, as.surface, surface, 
in.poly</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span> <span class="va">ozone2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">x</span><span class="op">&lt;-</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">lon.lat</span> </span></span>
<span class="r-in"><span>  <span class="va">y</span><span class="op">&lt;-</span> <span class="va">ozone2</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">obj</span><span class="op">&lt;-</span> <span class="fu"><a href="Tps.html">Tps</a></span><span class="op">(</span> <span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># or try the alternative model: </span></span></span>
<span class="r-in"><span>  <span class="co">#  obj&lt;- spatialProcess(x,y)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">fit</span><span class="op">&lt;-</span> <span class="fu">predictSurface</span><span class="op">(</span> <span class="va">obj</span>, nx<span class="op">=</span><span class="fl">40</span>, ny<span class="op">=</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span> <span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predictSurface-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predicting a 2d surface holding other variables fixed.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">&lt;-</span> <span class="fu"><a href="Tps.html">Tps</a></span><span class="op">(</span> <span class="va">BD</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">BD</span><span class="op">$</span><span class="va">lnya</span><span class="op">)</span>  <span class="co"># fit surface to data </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># evaluate fitted surface for  first two </span></span></span>
<span class="r-in"><span><span class="co"># variables holding other two fixed at median values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out.p</span><span class="op">&lt;-</span> <span class="fu">predictSurface</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span><span class="va">out.p</span>, type<span class="op">=</span><span class="st">"C"</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="predictSurface-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># plot surface for second and fourth variables </span></span></span>
<span class="r-in"><span><span class="co"># on specific grid. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">glist</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> KCL<span class="op">=</span><span class="fl">29.77</span>, MgCl2<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span>,,<span class="fl">25</span><span class="op">)</span>, KPO4<span class="op">=</span><span class="fl">32.13</span>, </span></span>
<span class="r-in"><span>                     dNTP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">250</span>,<span class="fl">1500</span>,,<span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out.p</span><span class="op">&lt;-</span> <span class="fu">predictSurface</span><span class="op">(</span><span class="va">fit</span>, <span class="va">glist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span><span class="va">out.p</span>, type<span class="op">=</span><span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predictSurface-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out.p</span><span class="op">&lt;-</span> <span class="fu">predictSurfaceSE</span><span class="op">(</span><span class="va">fit</span>, <span class="va">glist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fields-internal.html">surface</a></span><span class="op">(</span><span class="va">out.p</span>, type<span class="op">=</span><span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predictSurface-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## a test of the fast prediction algorithm for use with </span></span></span>
<span class="r-in"><span><span class="co"># mKrig/spatialProcess objects. </span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">NorthAmericanRainfall</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">NorthAmericanRainfall</span><span class="op">$</span><span class="va">longitude</span>,     </span></span>
<span class="r-in"><span>          <span class="va">NorthAmericanRainfall</span><span class="op">$</span><span class="va">latitude</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">NorthAmericanRainfall</span><span class="op">$</span><span class="va">precip</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mKrigObject</span><span class="op">&lt;-</span> <span class="fu"><a href="mKrig.html">mKrig</a></span><span class="op">(</span> <span class="va">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    lambda<span class="op">=</span><span class="fl">.024</span>,</span></span>
<span class="r-in"><span>                    cov.args<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>     aRange<span class="op">=</span> <span class="fl">5.87</span>,</span></span>
<span class="r-in"><span>                                    Covariance<span class="op">=</span><span class="st">"Matern"</span>,</span></span>
<span class="r-in"><span>                                    smoothness<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                        sigma2<span class="op">=</span><span class="fl">.157</span></span></span>
<span class="r-in"><span>                                 <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gridList</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">134</span>, <span class="op">-</span><span class="fl">51</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">23</span>,   <span class="fl">57</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>                          </span></span>
<span class="r-in"><span>                 </span></span>
<span class="r-in"><span><span class="co"># exact prediction </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> </span></span>
<span class="r-in"><span><span class="va">gHat</span><span class="op">&lt;-</span> <span class="fu">predictSurface</span><span class="op">(</span> <span class="va">mKrigObject</span>, <span class="va">gridList</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># aproximate </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> </span></span>
<span class="r-in"><span><span class="va">gHat1</span><span class="op">&lt;-</span> <span class="fu">predictSurface</span><span class="op">(</span> <span class="va">mKrigObject</span>, <span class="va">gridList</span>,</span></span>
<span class="r-in"><span>                                fast <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span>                                </span></span>
<span class="r-in"><span><span class="co"># don't worry about the warning ...</span></span></span>
<span class="r-in"><span><span class="co"># just indicates some observation locations are located </span></span></span>
<span class="r-in"><span><span class="co"># in the same grid box.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># approximation error omitting the NAs from outside the convex hull                        </span></span></span>
<span class="r-in"><span> <span class="fu"><a href="stats.html">stats</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gHat</span><span class="op">$</span><span class="va">z</span> <span class="op">-</span> <span class="va">gHat1</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="fu"><a href="image.plot.html">image.plot</a></span><span class="op">(</span><span class="va">gHat</span><span class="op">$</span><span class="va">x</span>, <span class="va">gHat</span><span class="op">$</span><span class="va">y</span>,  <span class="op">(</span><span class="va">gHat</span><span class="op">$</span><span class="va">z</span> <span class="op">-</span> <span class="va">gHat1</span><span class="op">$</span><span class="va">z</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span> <span class="va">x</span>,  pch<span class="op">=</span><span class="st">"."</span>, cex<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="world.html">world</a></span><span class="op">(</span> add<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

