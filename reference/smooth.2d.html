<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Kernel smoother for irregular 2-d data — smooth.2d • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Kernel smoother for irregular 2-d data — smooth.2d"><meta property="og:description" content="An approximate Nadaraya Watson kernel smoother is obtained by first
discretizing the locations to a grid and then using convolutions to find 
and to apply the kernel weights. The main advantage of this function
is a smoother that avoids explicit looping."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kernel smoother for irregular 2-d data</h1>
    
    <div class="hidden name"><code>smooth.2d.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An approximate Nadaraya Watson kernel smoother is obtained by first
discretizing the locations to a grid and then using convolutions to find 
and to apply the kernel weights. The main advantage of this function
is a smoother that avoids explicit looping.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smooth.2d</span><span class="op">(</span><span class="va">Y</span>, ind <span class="op">=</span> <span class="cn">NULL</span>, weight.obj <span class="op">=</span> <span class="cn">NULL</span>, setup <span class="op">=</span> <span class="cn">FALSE</span>, grid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, nrow <span class="op">=</span> <span class="fl">64</span>, ncol <span class="op">=</span> <span class="fl">64</span>, surface <span class="op">=</span> <span class="cn">TRUE</span>, cov.function <span class="op">=</span></span>
<span><span class="va">gauss.cov</span>, Mwidth <span class="op">=</span> <span class="cn">NULL</span>, Nwidth <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Y</dt>
<dd><p>A vector of 
data to be smoothed</p></dd>

<dt>ind</dt>
<dd><p>Row and column indices that correspond to 
the locations of the data on regular grid. This is most useful when
smoothing the same locations many times. (See also the x argument.)</p></dd>

<dt>weight.obj </dt>
<dd><p>An object that 
has the FFT of the convolution kernel and other information ( i.e. the
result from calling this with setup=TRUE).</p></dd>

<dt>setup</dt>
<dd><p>If true creates a list that includes the FFT of the 
convolution kernel. In this case the function will return this
list. Default is false.</p></dd>

<dt>grid</dt>
<dd><p>A list with components x and y 
being equally spaced values that define the grid. Default are integers
1:nrow, 1:ncol. If x is given the ranges will be used to define the grid.</p></dd>

<dt>x</dt>
<dd><p>Actual locations 
of the Y values. Not needed if ind is specified.</p></dd>

<dt>nrow</dt>
<dd><p>Number of 
points in the horizontal (x) axis of the grid. Not needed if grid is 
specified the default is 64</p></dd>

<dt>ncol</dt>
<dd><p>Number of points in the vertical (y)
axis of the grid. Not needed if grid list is specified the default is 64</p></dd>

<dt>surface</dt>
<dd><p>If true (the default) a surface object is returned suitable for use by 
image, persp or 
contour functions. If false then just the nrowXncol matrix of smoothed 
values is returned.</p></dd>

<dt>cov.function</dt>
<dd><p>S function describing the kernel function. To be consistent with the other
spatial function this is in the form of a covariance function. The only
assumption is that this be stationary. Default is the (isotropic) Gaussian.</p></dd>

<dt>Nwidth</dt>
<dd><p>The size of the padding  regions of zeroes when computing the 
(exact) convolution of the kernel with the data. The most conservative 
values are 2*nrow and 2*ncol, the default. If the kernel has support of  
say 2L+1 grid points then the padding region need only be of size L+1.</p></dd>

<dt>Mwidth</dt>
<dd><p>See Nwidth.</p></dd>

<dt>...</dt>
<dd><p>Parameters that are passed to the smoothing kernel. ( e.g. the scale
parameter aRange for the
exponential or gaussian)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Either a matrix of smoothed values or a surface object.  
The surface object also has a component 'ind' that gives the subscripts of the image 
matrix where the data is present.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The irregular locations are first discretized to a regular grid ( using
as.image)  
then a 2d- FFT is used to compute a 
Nadaraya-Watson type kernel estimator. Here we take advantage of two
features. The kernel estimator is a convolution and by padding the regular
by zeroes where data is not obsevred one can sum the kernel over irregular
sets of locations. 
A second convolutions to find the normalization of the kernel 
weights.</p>
<p>The kernel function is specified by an function that should evaluate with
the kernel for two matrices of locations. Assume that the kernel has the
form:  K( u-v) for two locations u and v. The function given as the
argument to cov.function should
have the call myfun( x1,x2) where x1 and x2 are matrices of 2-d locations
if nrow(x1)=m and nrow( x2)=n then this function should return a mXn
matrix where the (i,j) element is K( x1[i,]- x2[j,]).  Optional arguments
that are included in the ... arguments are passed to this function when it
is used. The default kernel is the Gaussian and the argument aRange is the
bandwidth. It is easy to write other other kernels, just use 
Exp.cov.simple as
a template.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Normal kernel smooth of the precip data with bandwidth of .5 ( degree) </span></span></span>
<span class="r-in"><span><span class="co">#  </span></span></span>
<span class="r-in"><span><span class="va">look</span><span class="op">&lt;-</span> <span class="fu">smooth.2d</span><span class="op">(</span> <span class="va">RMprecip</span><span class="op">$</span><span class="va">y</span>,  x<span class="op">=</span><span class="va">RMprecip</span><span class="op">$</span><span class="va">x</span>, aRange<span class="op">=</span><span class="fl">.25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># finer resolution used in computing the smooth </span></span></span>
<span class="r-in"><span><span class="va">look3</span><span class="op">&lt;-</span><span class="fu">smooth.2d</span><span class="op">(</span> <span class="va">RMprecip</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">RMprecip</span><span class="op">$</span><span class="va">x</span>, aRange<span class="op">=</span><span class="fl">.25</span>, nrow<span class="op">=</span><span class="fl">256</span>, </span></span>
<span class="r-in"><span>ncol<span class="op">=</span><span class="fl">256</span>,Nwidth<span class="op">=</span><span class="fl">32</span>,</span></span>
<span class="r-in"><span>Mwidth<span class="op">=</span><span class="fl">32</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="co"># if the width arguments were omitted the padding would create a  </span></span></span>
<span class="r-in"><span><span class="co"># 512X 512 matrix with the data filled in the upper 256X256 part. </span></span></span>
<span class="r-in"><span><span class="co"># with a bandwidth of .25 degrees the normal kernel is essentially zero  </span></span></span>
<span class="r-in"><span><span class="co"># beyond 32 grid points from its center ( about 6 standard deviations) </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># take a look:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#set.panel(2,1)</span></span></span>
<span class="r-in"><span><span class="co">#image( look3, zlim=c(-8,12))</span></span></span>
<span class="r-in"><span><span class="co">#points( RMprecip$x, pch=".")  </span></span></span>
<span class="r-in"><span><span class="co">#image( look, zlim =c(-8,12))</span></span></span>
<span class="r-in"><span><span class="co">#points( RMprecip$x, pch=".")  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># bandwidth changed to .25, exponential kernel   </span></span></span>
<span class="r-in"><span><span class="va">look2</span><span class="op">&lt;-</span> <span class="fu">smooth.2d</span><span class="op">(</span> <span class="va">RMprecip</span><span class="op">$</span><span class="va">y</span>, x<span class="op">=</span><span class="va">RMprecip</span><span class="op">$</span><span class="va">x</span>, cov.function<span class="op">=</span><span class="va">Exp.cov</span>,aRange<span class="op">=</span><span class="fl">.25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

