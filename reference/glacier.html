<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Franke's Glacier Elevation Data — glacier • fields</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Franke's Glacier Elevation Data — glacier"><meta property="og:description" content="A moderate size (about 8400 locations) spatial dataset that is well-known in the applied mathematics approximation literature for testing interpolation methods."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fields</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">14.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Tps.html">Tps usage illustration</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dnychka/fieldsRPackage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Franke's Glacier Elevation Data</h1>
    
    <div class="hidden name"><code>glacier.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A moderate size (about 8400 locations) spatial dataset that is well-known in the applied mathematics approximation literature for testing interpolation methods.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glacier</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="format">
    <h2>Format</h2>
    <p>The format of <code>glacier</code> is a list with two components:</p><dl><dt>loc:</dt>
<dd><p>8338x2 matrix of the  locations (meters??).</p></dd>
 
<dt>y:</dt>
<dd><p>A vector of elevations (meters ??).</p></dd>
 

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This  data set  appears in papers that develop interpolation methods for
scattered  data and serves as an interesting bridge to the examples 
in applied math that develop radial basis function surface fitting.
The data was originally used by R. Franke.</p>
<p>Unfortunately at this time we can not find any background on where
these data were collected or indeed even the location of this glacier.
However, it is an interesting data set in that it appears that
the elevations are reported along lnes of equal elevation, i.e. 
contours, perhaps from a digitization of a
topographic map or survey. It is important to estimate the
surface in a way that the artifacts from discretization are not
present. In the example below the compactly supported kernel
interpolation still has some artifacts.</p>
<p>The glacier data set is available at this website
<a href="https://oleg-davydov.de/scat_data.html" class="external-link">https://oleg-davydov.de/scat_data.html</a></p>
<p>The examples below are useful for comparing different
approximations
to a Gaussian spatial process estimate for the elevation surface.
Of
course in using a stationary covariance ( e.g. the Matern or
Wendland)
these are also radial basis smoothing or interpolation of the
data.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span> <span class="va">glacier</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># EDA for raw obs:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="quilt.plot.html">bubblePlot</a></span><span class="op">(</span> <span class="va">glacier</span><span class="op">$</span><span class="va">loc</span>, <span class="va">glacier</span><span class="op">$</span><span class="va">y</span>, highlight<span class="op">=</span><span class="cn">FALSE</span>, size<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="glacier-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># identifying contour levels. Note this is reported at regular levels</span></span></span>
<span class="r-in"><span><span class="co"># (Every 25m ???)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span> <span class="va">glacier</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1300 1325 1350 1375 1400 1425 1450 1475 1500 1525 1550 1575 1600 1625 1650 1675 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   60  117  150  157  176  195  220  245  272  297  325  350  386  425  434  481 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1700 1725 1750 1775 1800 1825 1850 1875 1900 1925 1950 1975 2000 2100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  531  582  545  496  402  324  266  191  182  145  139  123   99   23 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># find sigma and rho by maximum likelihood </span></span></span>
<span class="r-in"><span><span class="co"># for a fixed range</span></span></span>
<span class="r-in"><span><span class="co">#  the default is the Wendland covariance with k=2</span></span></span>
<span class="r-in"><span><span class="co"># See help(Wendland)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this takes about 5 minutes</span></span></span>
<span class="r-in"><span><span class="co"># macbook pro Quad-Core Intel Core i5 8 GB</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#options(spam.nearestdistnnz=c(5e7,1e3))</span></span></span>
<span class="r-in"><span><span class="co">#system.time( </span></span></span>
<span class="r-in"><span><span class="co"># obj0&lt;- fastTps(glacier$loc, glacier$y, </span></span></span>
<span class="r-in"><span><span class="co">#                       theta=2,</span></span></span>
<span class="r-in"><span><span class="co">#                      profileLambda=TRUE) </span></span></span>
<span class="r-in"><span><span class="co">#)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set.panel(2,2)</span></span></span>
<span class="r-in"><span><span class="co"># plot( obj0)</span></span></span>
<span class="r-in"><span><span class="co"># set.panel()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># just evaluate at MLE</span></span></span>
<span class="r-in"><span><span class="co"># reset default matrix size that the spam pacakge will use.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>spam.nearestdistnnz<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e7</span>,<span class="fl">1e3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> <span class="va">obj1</span><span class="op">&lt;-</span> </span></span>
<span class="r-in"><span>               <span class="fu"><a href="Tps.html">fastTps</a></span><span class="op">(</span><span class="va">glacier</span><span class="op">$</span><span class="va">loc</span>, <span class="va">glacier</span><span class="op">$</span><span class="va">y</span>, </span></span>
<span class="r-in"><span>                       theta<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                       lambda<span class="op">=</span> <span class="fl">7.58e-5</span></span></span>
<span class="r-in"><span>                        <span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="va">look1</span><span class="op">&lt;-</span> <span class="fu"><a href="predictSurface.html">predictSurface</a></span><span class="op">(</span> <span class="va">obj1</span>, nx<span class="op">=</span><span class="fl">150</span>, ny<span class="op">=</span><span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span> <span class="va">look1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">&lt;-</span> <span class="fu"><a href="sim.Krig.html">simLocal.spatialProcess</a></span><span class="op">(</span><span class="va">obj1</span>, M<span class="op">=</span><span class="fl">3</span>, nx<span class="op">=</span><span class="fl">150</span>, ny<span class="op">=</span><span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span> <span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span> <span class="va">look1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zlim</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span> <span class="va">out</span><span class="op">$</span><span class="va">z</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">x</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span>, <span class="va">out</span><span class="op">$</span><span class="va">z</span><span class="op">[</span>,,<span class="va">k</span><span class="op">]</span>, zlim<span class="op">=</span><span class="va">zlim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># near interpolation surface using Matern smoothness .5 </span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span> </span></span>
<span class="r-in"><span> <span class="va">obj2</span><span class="op">&lt;-</span> <span class="fu"><a href="spatialProcess.html">spatialProcess</a></span><span class="op">(</span><span class="va">glacier</span><span class="op">$</span><span class="va">loc</span>, <span class="va">glacier</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>                          aRange <span class="op">=</span> <span class="fl">1.5</span>, </span></span>
<span class="r-in"><span>                          lambda <span class="op">=</span> <span class="fl">1e-5</span>,</span></span>
<span class="r-in"><span>                          smoothness <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">&lt;-</span> <span class="fu"><a href="sim.Krig.html">simLocal.spatialProcess</a></span><span class="op">(</span><span class="va">obj2</span>, M<span class="op">=</span><span class="fl">3</span>, nx<span class="op">=</span><span class="fl">150</span>, ny<span class="op">=</span><span class="fl">150</span>,</span></span>
<span class="r-in"><span>fast<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="set.panel.html">set.panel</a></span><span class="op">(</span> <span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span> <span class="va">look1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zlim</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span> <span class="va">out</span><span class="op">$</span><span class="va">z</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">x</span>, <span class="va">out</span><span class="op">$</span><span class="va">y</span>, <span class="va">out</span><span class="op">$</span><span class="va">z</span><span class="op">[</span>,,<span class="va">k</span><span class="op">]</span>, zlim<span class="op">=</span><span class="va">zlim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="va">look2</span><span class="op">&lt;-</span> <span class="fu"><a href="predictSurface.html">predictSurface.mKrig</a></span><span class="op">(</span> <span class="va">obj2</span>, nx<span class="op">=</span><span class="fl">150</span>, ny<span class="op">=</span><span class="fl">150</span>,</span></span>
<span class="r-in"><span>                fast<span class="op">=</span><span class="cn">TRUE</span>, NNSize<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="va">look2B</span><span class="op">&lt;-</span> <span class="fu"><a href="predictSurface.html">predictSurface</a></span><span class="op">(</span> <span class="va">obj2</span>, nx<span class="op">=</span><span class="fl">150</span>, ny<span class="op">=</span><span class="fl">150</span>,</span></span>
<span class="r-in"><span>                fast<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">err</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">look2</span><span class="op">$</span><span class="va">z</span> <span class="op">-</span> <span class="va">look2B</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">/</span><span class="va">look2B</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="stats.html">stats</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">err</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># some error plots ( percent relative error)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span><span class="va">look2</span><span class="op">$</span><span class="va">x</span>, <span class="va">look2</span><span class="op">$</span><span class="va">y</span>, <span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="va">look2</span><span class="op">$</span><span class="va">z</span> <span class="op">-</span> <span class="va">look2B</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">/</span><span class="va">look2B</span><span class="op">$</span><span class="va">z</span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagePlot.html">imagePlot</a></span><span class="op">(</span><span class="va">look2</span><span class="op">$</span><span class="va">x</span>, <span class="va">look2</span><span class="op">$</span><span class="va">y</span>, <span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="va">look1</span><span class="op">$</span><span class="va">z</span> <span class="op">-</span> <span class="va">look2B</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">/</span><span class="va">look2B</span><span class="op">$</span><span class="va">z</span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain, Florian Gerber, Matthew Iverson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

